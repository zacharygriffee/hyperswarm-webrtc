var e=function e(n,r){if(!n){var i=new t(r);throw Error.captureStackTrace&&Error.captureStackTrace(i,e),i}};let t=class extends Error{};t.prototype.name="AssertionError";var n=function e(t,n){if(!t){var i=new r(n);throw Error.captureStackTrace&&Error.captureStackTrace(i,e),i}};let r=class extends Error{};r.prototype.name="AssertionError";var i={exports:{}};function s(e){return e.length}var o={byteLength:s,toString:function(e){const t=e.byteLength;let n="";for(let r=0;r<t;r++)n+=String.fromCharCode(e[r]);return n},write:function(e,t,n=0,r=s(t)){const i=Math.min(r,e.byteLength-n);for(let r=0;r<i;r++)e[n+r]=t.charCodeAt(r);return i}};const a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h=new Uint8Array(256);for(let e=0;e<64;e++)h[a.charCodeAt(e)]=e;function c(e){let t=e.length;return 61===e.charCodeAt(t-1)&&t--,t>1&&61===e.charCodeAt(t-1)&&t--,3*t>>>2}h[45]=62,h[95]=63;var u={byteLength:c,toString:function(e){const t=e.byteLength;let n="";for(let r=0;r<t;r+=3)n+=a[e[r]>>2]+a[(3&e[r])<<4|e[r+1]>>4]+a[(15&e[r+1])<<2|e[r+2]>>6]+a[63&e[r+2]];return t%3==2?n=n.substring(0,n.length-1)+"=":t%3==1&&(n=n.substring(0,n.length-2)+"=="),n},write:function(e,t,n=0,r=c(t)){const i=Math.min(r,e.byteLength-n);for(let n=0,r=0;r<i;n+=4){const i=h[t.charCodeAt(n)],s=h[t.charCodeAt(n+1)],o=h[t.charCodeAt(n+2)],a=h[t.charCodeAt(n+3)];e[r++]=i<<2|s>>4,e[r++]=(15&s)<<4|o>>2,e[r++]=(3&o)<<6|63&a}return i}};function l(e){return e.length>>>1}var d={byteLength:l,toString:function(e){const t=e.byteLength;e=new DataView(e.buffer,e.byteOffset,t);let n="",r=0;for(let i=t-t%4;r<i;r+=4)n+=e.getUint32(r).toString(16).padStart(8,"0");for(;r<t;r++)n+=e.getUint8(r).toString(16).padStart(2,"0");return n},write:function(e,t,n=0,r=l(t)){const i=Math.min(r,e.byteLength-n);for(let r=0;r<i;r++){const i=f(t.charCodeAt(2*r)),s=f(t.charCodeAt(2*r+1));if(void 0===i||void 0===s)return e.subarray(0,r);e[n+r]=i<<4|s}return i}};function f(e){return e>=48&&e<=57?e-48:e>=65&&e<=70?e-65+10:e>=97&&e<=102?e-97+10:void 0}function A(e){let t=0;for(let n=0,r=e.length;n<r;n++){const i=e.charCodeAt(n);if(i>=55296&&i<=56319&&n+1<r){const r=e.charCodeAt(n+1);if(r>=56320&&r<=57343){t+=4,n++;continue}}t+=i<=127?1:i<=2047?2:3}return t}let g,p;if("undefined"!=typeof TextDecoder){const e=new TextDecoder;g=function(t){return e.decode(t)}}else g=function(e){const t=e.byteLength;let n="",r=0;for(;r<t;){let i=e[r];if(i<=127){n+=String.fromCharCode(i),r++;continue}let s=0,o=0;if(i<=223?(s=1,o=31&i):i<=239?(s=2,o=15&i):i<=244&&(s=3,o=7&i),t-r-s>0){let t=0;for(;t<s;)i=e[r+t+1],o=o<<6|63&i,t+=1}else o=65533,s=t-r;n+=String.fromCodePoint(o),r+=s+1}return n};if("undefined"!=typeof TextEncoder){const e=new TextEncoder;p=function(t,n,r=0,i=A(n)){const s=Math.min(i,t.byteLength-r);return e.encodeInto(n,t.subarray(r,r+s)),s}}else p=function(e,t,n=0,r=A(t)){const i=Math.min(r,e.byteLength-n);e=e.subarray(n,n+i);let s=0,o=0;for(;s<t.length;){const n=t.codePointAt(s);if(n<=127){e[o++]=n,s++;continue}let r=0,i=0;for(n<=2047?(r=6,i=192):n<=65535?(r=12,i=224):n<=2097151&&(r=18,i=240),e[o++]=i|n>>r,r-=6;r>=0;)e[o++]=128|n>>r&63,r-=6;s+=n>=65536?2:1}return i};var y={byteLength:A,toString:g,write:p};function _(e){return 2*e.length}var b={byteLength:_,toString:function(e){const t=e.byteLength;let n="";for(let r=0;r<t-1;r+=2)n+=String.fromCharCode(e[r]+256*e[r+1]);return n},write:function(e,t,n=0,r=_(t)){const i=Math.min(r,e.byteLength-n);let s=i;for(let r=0;r<t.length&&!((s-=2)<0);++r){const i=t.charCodeAt(r),s=i>>8,o=i%256;e[n+2*r]=o,e[n+2*r+1]=s}return i}};!function(e,t){const n=o,r=u,i=d,s=y,a=b,h=255===new Uint8Array(Uint16Array.of(255).buffer)[0];function c(e){switch(e){case"ascii":return n;case"base64":return r;case"hex":return i;case"utf8":case"utf-8":case void 0:return s;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return a;default:throw new Error(`Unknown encoding: ${e}`)}}function l(e){return e instanceof Uint8Array}function f(e,t,n){return"string"==typeof e?function(e,t){const n=c(t),r=new Uint8Array(n.byteLength(e));return n.write(r,e,0,r.byteLength),r}(e,t):Array.isArray(e)?function(e){const t=new Uint8Array(e.length);return t.set(e),t}(e):ArrayBuffer.isView(e)?function(e){const t=new Uint8Array(e.byteLength);return t.set(e),t}(e):function(e,t,n){return new Uint8Array(e,t,n)}(e,t,n)}function A(e,t,n,r,i){if(0===e.byteLength)return-1;if("string"==typeof n?(r=n,n=0):void 0===n?n=i?0:e.length-1:n<0&&(n+=e.byteLength),n>=e.byteLength){if(i)return-1;n=e.byteLength-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t)t=f(t,r);else if("number"==typeof t)return t&=255,i?e.indexOf(t,n):e.lastIndexOf(t,n);if(0===t.byteLength)return-1;if(i){let r=-1;for(let i=n;i<e.byteLength;i++)if(e[i]===t[-1===r?0:i-r]){if(-1===r&&(r=i),i-r+1===t.byteLength)return r}else-1!==r&&(i-=i-r),r=-1}else{n+t.byteLength>e.byteLength&&(n=e.byteLength-t.byteLength);for(let r=n;r>=0;r--){let n=!0;for(let i=0;i<t.byteLength;i++)if(e[r+i]!==t[i]){n=!1;break}if(n)return r}}return-1}function g(e,t,n,r){return A(e,t,n,r,!0)}function p(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}e.exports=t={isBuffer:l,isEncoding:function(e){try{return c(e),!0}catch{return!1}},alloc:function(e,n,r){const i=new Uint8Array(e);return void 0!==n&&t.fill(i,n,0,i.byteLength,r),i},allocUnsafe:function(e){return new Uint8Array(e)},allocUnsafeSlow:function(e){return new Uint8Array(e)},byteLength:function(e,t){return c(t).byteLength(e)},compare:function(e,t){if(e===t)return 0;const n=Math.min(e.byteLength,t.byteLength);e=new DataView(e.buffer,e.byteOffset,e.byteLength),t=new DataView(t.buffer,t.byteOffset,t.byteLength);let r=0;for(let i=n-n%4;r<i&&e.getUint32(r,h)===t.getUint32(r,h);r+=4);for(;r<n;r++){const n=e.getUint8(r),i=t.getUint8(r);if(n<i)return-1;if(n>i)return 1}return e.byteLength>t.byteLength?1:e.byteLength<t.byteLength?-1:0},concat:function(e,t){void 0===t&&(t=e.reduce(((e,t)=>e+t.byteLength),0));const n=new Uint8Array(t);let r=0;for(const t of e){if(r+t.byteLength>n.byteLength){const e=t.subarray(0,n.byteLength-r);return n.set(e,r),n}n.set(t,r),r+=t.byteLength}return n},copy:function(e,t,n=0,r=0,i=e.byteLength){if(i>0&&i<r)return 0;if(i===r)return 0;if(0===e.byteLength||0===t.byteLength)return 0;if(n<0)throw new RangeError("targetStart is out of range");if(r<0||r>=e.byteLength)throw new RangeError("sourceStart is out of range");if(i<0)throw new RangeError("sourceEnd is out of range");n>=t.byteLength&&(n=t.byteLength),i>e.byteLength&&(i=e.byteLength),t.byteLength-n<i-r&&(i=t.length-n+r);const s=i-r;return e===t?t.copyWithin(n,r,i):t.set(e.subarray(r,i),n),s},equals:function(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;const n=e.byteLength;e=new DataView(e.buffer,e.byteOffset,e.byteLength),t=new DataView(t.buffer,t.byteOffset,t.byteLength);let r=0;for(let i=n-n%4;r<i;r+=4)if(e.getUint32(r,h)!==t.getUint32(r,h))return!1;for(;r<n;r++)if(e.getUint8(r)!==t.getUint8(r))return!1;return!0},fill:function(e,t,n,r,i){if("string"==typeof t?"string"==typeof n?(i=n,n=0,r=e.byteLength):"string"==typeof r&&(i=r,r=e.byteLength):"number"==typeof t?t&=255:"boolean"==typeof t&&(t=+t),n<0||e.byteLength<n||e.byteLength<r)throw new RangeError("Out of range index");if(void 0===n&&(n=0),void 0===r&&(r=e.byteLength),r<=n)return e;if(t||(t=0),"number"==typeof t)for(let i=n;i<r;++i)e[i]=t;else{const s=(t=l(t)?t:f(t,i)).byteLength;for(let i=0;i<r-n;++i)e[i+n]=t[i%s]}return e},from:f,includes:function(e,t,n,r){return-1!==g(e,t,n,r)},indexOf:g,lastIndexOf:function(e,t,n,r){return A(e,t,n,r,!1)},swap16:function(e){const t=e.byteLength;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let n=0;n<t;n+=2)p(e,n,n+1);return e},swap32:function(e){const t=e.byteLength;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let n=0;n<t;n+=4)p(e,n,n+3),p(e,n+1,n+2);return e},swap64:function(e){const t=e.byteLength;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let n=0;n<t;n+=8)p(e,n,n+7),p(e,n+1,n+6),p(e,n+2,n+5),p(e,n+3,n+4);return e},toBuffer:function(e){return e},toString:function(e,t,n=0,r=e.byteLength){const i=e.byteLength;return n>=i||r<=n?"":(n<0&&(n=0),r>i&&(r=i),(0!==n||r<i)&&(e=e.subarray(n,r)),c(t).toString(e))},write:function(e,t,n,r,i){return void 0===n?i="utf8":void 0===r&&"string"==typeof n?(i=n,n=void 0):void 0===i&&"string"==typeof r&&(i=r,r=void 0),c(i).write(e,t,n,r)},writeDoubleLE:function(e,t,n){return void 0===n&&(n=0),new DataView(e.buffer,e.byteOffset,e.byteLength).setFloat64(n,t,!0),n+8},writeFloatLE:function(e,t,n){return void 0===n&&(n=0),new DataView(e.buffer,e.byteOffset,e.byteLength).setFloat32(n,t,!0),n+4},writeUInt32LE:function(e,t,n){return void 0===n&&(n=0),new DataView(e.buffer,e.byteOffset,e.byteLength).setUint32(n,t,!0),n+4},writeInt32LE:function(e,t,n){return void 0===n&&(n=0),new DataView(e.buffer,e.byteOffset,e.byteLength).setInt32(n,t,!0),n+4},readDoubleLE:function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat64(t,!0)},readFloatLE:function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat32(t,!0)},readUInt32LE:function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getUint32(t,!0)},readInt32LE:function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getInt32(t,!0)}}}(i,i.exports);var I=i.exports,E={exports:{}};function m(e){return e.length}var w={byteLength:m,toString:function(e){const t=e.byteLength;let n="";for(let r=0;r<t;r++)n+=String.fromCharCode(e[r]);return n},write:function(e,t,n=0,r=m(t)){const i=Math.min(r,e.byteLength-n);for(let r=0;r<i;r++)e[n+r]=t.charCodeAt(r);return i}};const C="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",S=new Uint8Array(256);for(let e=0;e<64;e++)S[C.charCodeAt(e)]=e;function B(e){let t=e.length;return 61===e.charCodeAt(t-1)&&t--,t>1&&61===e.charCodeAt(t-1)&&t--,3*t>>>2}S[45]=62,S[95]=63;var Q={byteLength:B,toString:function(e){const t=e.byteLength;let n="";for(let r=0;r<t;r+=3)n+=C[e[r]>>2]+C[(3&e[r])<<4|e[r+1]>>4]+C[(15&e[r+1])<<2|e[r+2]>>6]+C[63&e[r+2]];return t%3==2?n=n.substring(0,n.length-1)+"=":t%3==1&&(n=n.substring(0,n.length-2)+"=="),n},write:function(e,t,n=0,r=B(t)){const i=Math.min(r,e.byteLength-n);for(let n=0,r=0;r<i;n+=4){const i=S[t.charCodeAt(n)],s=S[t.charCodeAt(n+1)],o=S[t.charCodeAt(n+2)],a=S[t.charCodeAt(n+3)];e[r++]=i<<2|s>>4,e[r++]=(15&s)<<4|o>>2,e[r++]=(3&o)<<6|63&a}return i}};function v(e){return e.length>>>1}var x={byteLength:v,toString:function(e){const t=e.byteLength;e=new DataView(e.buffer,e.byteOffset,t);let n="",r=0;for(let i=t-t%4;r<i;r+=4)n+=e.getUint32(r).toString(16).padStart(8,"0");for(;r<t;r++)n+=e.getUint8(r).toString(16).padStart(2,"0");return n},write:function(e,t,n=0,r=v(t)){const i=Math.min(r,e.byteLength-n);for(let r=0;r<i;r++){const i=L(t.charCodeAt(2*r)),s=L(t.charCodeAt(2*r+1));if(void 0===i||void 0===s)return e.subarray(0,r);e[n+r]=i<<4|s}return i}};function L(e){return e>=48&&e<=57?e-48:e>=65&&e<=70?e-65+10:e>=97&&e<=102?e-97+10:void 0}function k(e){let t=0;for(let n=0,r=e.length;n<r;n++){const i=e.charCodeAt(n);if(i>=55296&&i<=56319&&n+1<r){const r=e.charCodeAt(n+1);if(r>=56320&&r<=57343){t+=4,n++;continue}}t+=i<=127?1:i<=2047?2:3}return t}let D,U;if("undefined"!=typeof TextDecoder){const e=new TextDecoder;D=function(t){return e.decode(t)}}else D=function(e){const t=e.byteLength;let n="",r=0;for(;r<t;){let i=e[r];if(i<=127){n+=String.fromCharCode(i),r++;continue}let s=0,o=0;if(i<=223?(s=1,o=31&i):i<=239?(s=2,o=15&i):i<=244&&(s=3,o=7&i),t-r-s>0){let t=0;for(;t<s;)i=e[r+t+1],o=o<<6|63&i,t+=1}else o=65533,s=t-r;n+=String.fromCodePoint(o),r+=s+1}return n};if("undefined"!=typeof TextEncoder){const e=new TextEncoder;U=function(t,n,r=0,i=k(n)){const s=Math.min(i,t.byteLength-r);return e.encodeInto(n,t.subarray(r,r+s)),s}}else U=function(e,t,n=0,r=k(t)){const i=Math.min(r,e.byteLength-n);e=e.subarray(n,n+i);let s=0,o=0;for(;s<t.length;){const n=t.codePointAt(s);if(n<=127){e[o++]=n,s++;continue}let r=0,i=0;for(n<=2047?(r=6,i=192):n<=65535?(r=12,i=224):n<=2097151&&(r=18,i=240),e[o++]=i|n>>r,r-=6;r>=0;)e[o++]=128|n>>r&63,r-=6;s+=n>=65536?2:1}return i};var K={byteLength:k,toString:D,write:U};function M(e){return 2*e.length}var T={byteLength:M,toString:function(e){const t=e.byteLength;let n="";for(let r=0;r<t-1;r+=2)n+=String.fromCharCode(e[r]+256*e[r+1]);return n},write:function(e,t,n=0,r=M(t)){const i=Math.min(r,e.byteLength-n);let s=i;for(let r=0;r<t.length&&!((s-=2)<0);++r){const i=t.charCodeAt(r),s=i>>8,o=i%256;e[n+2*r]=o,e[n+2*r+1]=s}return i}};!function(e,t){const n=w,r=Q,i=x,s=K,o=T,a=255===new Uint8Array(Uint16Array.of(255).buffer)[0];function h(e){switch(e){case"ascii":return n;case"base64":return r;case"hex":return i;case"utf8":case"utf-8":case void 0:return s;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return o;default:throw new Error(`Unknown encoding: ${e}`)}}function c(e){return e instanceof Uint8Array}function u(e,t,n){return"string"==typeof e?function(e,t){const n=h(t),r=new Uint8Array(n.byteLength(e));return n.write(r,e,0,r.byteLength),r}(e,t):Array.isArray(e)?function(e){const t=new Uint8Array(e.length);return t.set(e),t}(e):ArrayBuffer.isView(e)?function(e){const t=new Uint8Array(e.byteLength);return t.set(e),t}(e):function(e,t,n){return new Uint8Array(e,t,n)}(e,t,n)}function l(e,t,n,r,i){if(0===e.byteLength)return-1;if("string"==typeof n?(r=n,n=0):void 0===n?n=i?0:e.length-1:n<0&&(n+=e.byteLength),n>=e.byteLength){if(i)return-1;n=e.byteLength-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t)t=u(t,r);else if("number"==typeof t)return t&=255,i?e.indexOf(t,n):e.lastIndexOf(t,n);if(0===t.byteLength)return-1;if(i){let r=-1;for(let i=n;i<e.byteLength;i++)if(e[i]===t[-1===r?0:i-r]){if(-1===r&&(r=i),i-r+1===t.byteLength)return r}else-1!==r&&(i-=i-r),r=-1}else{n+t.byteLength>e.byteLength&&(n=e.byteLength-t.byteLength);for(let r=n;r>=0;r--){let n=!0;for(let i=0;i<t.byteLength;i++)if(e[r+i]!==t[i]){n=!1;break}if(n)return r}}return-1}function d(e,t,n,r){return l(e,t,n,r,!0)}function f(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}e.exports=t={isBuffer:c,isEncoding:function(e){try{return h(e),!0}catch{return!1}},alloc:function(e,n,r){const i=new Uint8Array(e);return void 0!==n&&t.fill(i,n,0,i.byteLength,r),i},allocUnsafe:function(e){return new Uint8Array(e)},allocUnsafeSlow:function(e){return new Uint8Array(e)},byteLength:function(e,t){return h(t).byteLength(e)},compare:function(e,t){if(e===t)return 0;const n=Math.min(e.byteLength,t.byteLength);e=new DataView(e.buffer,e.byteOffset,e.byteLength),t=new DataView(t.buffer,t.byteOffset,t.byteLength);let r=0;for(let i=n-n%4;r<i&&e.getUint32(r,a)===t.getUint32(r,a);r+=4);for(;r<n;r++){const n=e.getUint8(r),i=t.getUint8(r);if(n<i)return-1;if(n>i)return 1}return e.byteLength>t.byteLength?1:e.byteLength<t.byteLength?-1:0},concat:function(e,t){void 0===t&&(t=e.reduce(((e,t)=>e+t.byteLength),0));const n=new Uint8Array(t);let r=0;for(const t of e){if(r+t.byteLength>n.byteLength){const e=t.subarray(0,n.byteLength-r);return n.set(e,r),n}n.set(t,r),r+=t.byteLength}return n},copy:function(e,t,n=0,r=0,i=e.byteLength){if(i>0&&i<r)return 0;if(i===r)return 0;if(0===e.byteLength||0===t.byteLength)return 0;if(n<0)throw new RangeError("targetStart is out of range");if(r<0||r>=e.byteLength)throw new RangeError("sourceStart is out of range");if(i<0)throw new RangeError("sourceEnd is out of range");n>=t.byteLength&&(n=t.byteLength),i>e.byteLength&&(i=e.byteLength),t.byteLength-n<i-r&&(i=t.length-n+r);const s=i-r;return e===t?t.copyWithin(n,r,i):t.set(e.subarray(r,i),n),s},equals:function(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;const n=e.byteLength;e=new DataView(e.buffer,e.byteOffset,e.byteLength),t=new DataView(t.buffer,t.byteOffset,t.byteLength);let r=0;for(let i=n-n%4;r<i;r+=4)if(e.getUint32(r,a)!==t.getUint32(r,a))return!1;for(;r<n;r++)if(e.getUint8(r)!==t.getUint8(r))return!1;return!0},fill:function(e,t,n,r,i){if("string"==typeof t?"string"==typeof n?(i=n,n=0,r=e.byteLength):"string"==typeof r&&(i=r,r=e.byteLength):"number"==typeof t?t&=255:"boolean"==typeof t&&(t=+t),n<0||e.byteLength<n||e.byteLength<r)throw new RangeError("Out of range index");if(void 0===n&&(n=0),void 0===r&&(r=e.byteLength),r<=n)return e;if(t||(t=0),"number"==typeof t)for(let i=n;i<r;++i)e[i]=t;else{const s=(t=c(t)?t:u(t,i)).byteLength;for(let i=0;i<r-n;++i)e[i+n]=t[i%s]}return e},from:u,includes:function(e,t,n,r){return-1!==d(e,t,n,r)},indexOf:d,lastIndexOf:function(e,t,n,r){return l(e,t,n,r,!1)},swap16:function(e){const t=e.byteLength;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let n=0;n<t;n+=2)f(e,n,n+1);return e},swap32:function(e){const t=e.byteLength;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let n=0;n<t;n+=4)f(e,n,n+3),f(e,n+1,n+2);return e},swap64:function(e){const t=e.byteLength;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let n=0;n<t;n+=8)f(e,n,n+7),f(e,n+1,n+6),f(e,n+2,n+5),f(e,n+3,n+4);return e},toBuffer:function(e){return e},toString:function(e,t,n=0,r=e.byteLength){const i=e.byteLength;return n>=i||r<=n?"":(n<0&&(n=0),r>i&&(r=i),(0!==n||r<i)&&(e=e.subarray(n,r)),h(t).toString(e))},write:function(e,t,n,r,i){return void 0===n?i="utf8":void 0===r&&"string"==typeof n?(i=n,n=void 0):void 0===i&&"string"==typeof r&&(i=r,r=void 0),h(i).write(e,t,n,r)},writeDoubleLE:function(e,t,n){return void 0===n&&(n=0),new DataView(e.buffer,e.byteOffset,e.byteLength).setFloat64(n,t,!0),n+8},writeFloatLE:function(e,t,n){return void 0===n&&(n=0),new DataView(e.buffer,e.byteOffset,e.byteLength).setFloat32(n,t,!0),n+4},writeUInt32LE:function(e,t,n){return void 0===n&&(n=0),new DataView(e.buffer,e.byteOffset,e.byteLength).setUint32(n,t,!0),n+4},writeInt32LE:function(e,t,n){return void 0===n&&(n=0),new DataView(e.buffer,e.byteOffset,e.byteLength).setInt32(n,t,!0),n+4},readDoubleLE:function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat64(t,!0)},readFloatLE:function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat32(t,!0)},readUInt32LE:function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getUint32(t,!0)},readInt32LE:function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getInt32(t,!0)}}}(E,E.exports);var Y,N,P=E.exports,O={exports:{}},F=(()=>{for(var e=new Uint8Array(128),t=0;t<64;t++)e[t<26?t+65:t<52?t+71:t<62?t-4:4*t-205]=t;return t=>{for(var n=t.length,r=new Uint8Array(3*(n-("="==t[n-1])-("="==t[n-2]))/4|0),i=0,s=0;i<n;){var o=e[t.charCodeAt(i++)],a=e[t.charCodeAt(i++)],h=e[t.charCodeAt(i++)],c=e[t.charCodeAt(i++)];r[s++]=o<<2|a>>4,r[s++]=a<<4|h>>2,r[s++]=h<<6|c}return r}})(),H=(Y={"wasm-binary:./sha512.wat"(e,t){t.exports=F("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")}},function(){return N||(0,Y[Object.keys(Y)[0]])((N={exports:{}}).exports,N),N.exports})(),R=new WebAssembly.Module(H);const G=e,V=P,q="undefined"!=typeof WebAssembly&&(J={imports:{debug:{log(...e){console.log(...e.map((e=>(e>>>0).toString(16).padStart(8,"0"))))},log_tee:e=>(console.log((e>>>0).toString(16).padStart(8,"0")),e)}}},new WebAssembly.Instance(R,J).exports);var J;let j=0;const W=[];O.exports=$;const z=O.exports.SHA512_BYTES=64,X=216,Z=128;function $(){if(!(this instanceof $))return new $;if(!q)throw new Error("WASM not loaded. Wait for Sha512.ready(cb)");W.length||(W.push(j),j+=X),this.finalized=!1,this.digestLength=z,this.pointer=W.pop(),this.pos=0,this.wasm=q,this._memory=new Uint8Array(q.memory.buffer),this._memory.fill(0,this.pointer,this.pointer+X),this.pointer+this.digestLength>this._memory.length&&this._realloc(this.pointer+X)}function ee(e){if(!(this instanceof ee))return new ee(e);this.pad=V.alloc(128),this.inner=$(),this.outer=$();const t=V.alloc(64);e.byteLength>128&&($().update(e).digest(t),e=t),this.pad.fill(54);for(let t=0;t<e.byteLength;t++)this.pad[t]^=e[t];this.inner.update(this.pad),this.pad.fill(92);for(let t=0;t<e.byteLength;t++)this.pad[t]^=e[t];this.outer.update(this.pad),this.pad.fill(0),t.fill(0)}function te(){}$.prototype._realloc=function(e){q.memory.grow(Math.max(0,Math.ceil(Math.abs(e-this._memory.length)/65536))),this._memory=new Uint8Array(q.memory.buffer)},$.prototype.update=function(e,t){G(!1===this.finalized,"Hash instance finalized"),j%8!=0&&(j+=8-j%8),G(j%8==0,"input should be aligned for int64");const[n,r]=function(e,t){var n=V.from(e,t);return[n,n.byteLength]}(e,t);return G(n instanceof Uint8Array,"input must be Uint8Array or Buffer"),j+e.length>this._memory.length&&this._realloc(j+e.length),this._memory.fill(0,j,j+(r+Z-1&-128)-Z),this._memory.set(n.subarray(0,Z-this.pos),this.pointer+80+this.pos),this._memory.set(n.subarray(Z-this.pos),j),this.pos=this.pos+r&127,q.sha512(this.pointer,j,r,0),this},$.prototype.digest=function(e,t=0){G(!1===this.finalized,"Hash instance finalized"),this.finalized=!0,W.push(this.pointer);const n=this.pointer+80+this.pos;this._memory.fill(0,n,this.pointer+80+Z),q.sha512(this.pointer,j,0,1);const r=this._memory.subarray(this.pointer,this.pointer+this.digestLength);if(!e)return r;if("string"==typeof e)return V.toString(r,e);G(e instanceof Uint8Array,"output must be Uint8Array or Buffer"),G(e.byteLength>=this.digestLength+t,"output must have at least 'SHA512_BYTES' bytes remaining");for(let n=0;n<this.digestLength;n++)e[n+t]=r[n];return e},$.WASM=q,$.WASM_SUPPORTED="undefined"!=typeof WebAssembly,$.ready=function(e){return e||(e=te),q?(e(),Promise.resolve()):e(new Error("WebAssembly not supported"))},$.prototype.ready=$.ready,ee.prototype.update=function(e,t){return this.inner.update(e,t),this},ee.prototype.digest=function(e,t=0){return this.outer.update(this.inner.digest()),this.outer.digest(e,t)},$.HMAC=ee;var ne=O.exports;O.exports.HMAC,O.exports.WASM,O.exports.WASM_SUPPORTED,O.exports.ready;var re={exports:{}};const ie=n,se=I;var oe=ce;const ae=128;var he=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function ce(){return this instanceof ce?(this.hh=new Int32Array(8),this.hl=new Int32Array(8),this.buffer=new Uint8Array(128),this.finalised=!1,this.bytesRead=0,this.pos=0,this.hh[0]=1779033703,this.hh[1]=3144134277,this.hh[2]=1013904242,this.hh[3]=2773480762,this.hh[4]=1359893119,this.hh[5]=2600822924,this.hh[6]=528734635,this.hh[7]=1541459225,this.hl[0]=4089235720,this.hl[1]=2227873595,this.hl[2]=4271175723,this.hl[3]=1595750129,this.hl[4]=2917565137,this.hl[5]=725511199,this.hl[6]=4215389547,this.hl[7]=327033209,this):new ce}function ue(e,t,n,r){e[t]=n>>24&255,e[t+1]=n>>16&255,e[t+2]=n>>8&255,e[t+3]=255&n,e[t+4]=r>>24&255,e[t+5]=r>>16&255,e[t+6]=r>>8&255,e[t+7]=255&r}function le(e,t,n,r){for(var i,s,o,a,h,c,u,l,d,f,A,g,p,y,_,b,I,E,m,w,C,S,B,Q,v,x,L=new Int32Array(16),k=new Int32Array(16),D=e[0],U=e[1],K=e[2],M=e[3],T=e[4],Y=e[5],N=e[6],P=e[7],O=t[0],F=t[1],H=t[2],R=t[3],G=t[4],V=t[5],q=t[6],J=t[7],j=0;r>=128;){for(m=0;m<16;m++)w=8*m+j,L[m]=n[w+0]<<24|n[w+1]<<16|n[w+2]<<8|n[w+3],k[m]=n[w+4]<<24|n[w+5]<<16|n[w+6]<<8|n[w+7];for(m=0;m<80;m++)if(i=D,s=U,o=K,a=M,h=T,c=Y,u=N,d=O,f=F,A=H,g=R,p=G,y=V,_=q,B=65535&(S=J),Q=S>>>16,v=65535&(C=P),x=C>>>16,B+=65535&(S=(G>>>14|T<<18)^(G>>>18|T<<14)^(T>>>9|G<<23)),Q+=S>>>16,v+=65535&(C=(T>>>14|G<<18)^(T>>>18|G<<14)^(G>>>9|T<<23)),x+=C>>>16,B+=65535&(S=G&V^~G&q),Q+=S>>>16,v+=65535&(C=T&Y^~T&N),x+=C>>>16,B+=65535&(S=he[2*m+1]),Q+=S>>>16,v+=65535&(C=he[2*m]),x+=C>>>16,C=L[m%16],Q+=(S=k[m%16])>>>16,v+=65535&C,x+=C>>>16,v+=(Q+=(B+=65535&S)>>>16)>>>16,B=65535&(S=E=65535&B|Q<<16),Q=S>>>16,v=65535&(C=I=65535&v|(x+=v>>>16)<<16),x=C>>>16,B+=65535&(S=(O>>>28|D<<4)^(D>>>2|O<<30)^(D>>>7|O<<25)),Q+=S>>>16,v+=65535&(C=(D>>>28|O<<4)^(O>>>2|D<<30)^(O>>>7|D<<25)),x+=C>>>16,Q+=(S=O&F^O&H^F&H)>>>16,v+=65535&(C=D&U^D&K^U&K),x+=C>>>16,l=65535&(v+=(Q+=(B+=65535&S)>>>16)>>>16)|(x+=v>>>16)<<16,b=65535&B|Q<<16,B=65535&(S=g),Q=S>>>16,v=65535&(C=a),x=C>>>16,Q+=(S=E)>>>16,v+=65535&(C=I),x+=C>>>16,U=i,K=s,M=o,T=a=65535&(v+=(Q+=(B+=65535&S)>>>16)>>>16)|(x+=v>>>16)<<16,Y=h,N=c,P=u,D=l,F=d,H=f,R=A,G=g=65535&B|Q<<16,V=p,q=y,J=_,O=b,m%16==15)for(w=0;w<16;w++)C=L[w],B=65535&(S=k[w]),Q=S>>>16,v=65535&C,x=C>>>16,C=L[(w+9)%16],B+=65535&(S=k[(w+9)%16]),Q+=S>>>16,v+=65535&C,x+=C>>>16,I=L[(w+1)%16],B+=65535&(S=((E=k[(w+1)%16])>>>1|I<<31)^(E>>>8|I<<24)^(E>>>7|I<<25)),Q+=S>>>16,v+=65535&(C=(I>>>1|E<<31)^(I>>>8|E<<24)^I>>>7),x+=C>>>16,I=L[(w+14)%16],Q+=(S=((E=k[(w+14)%16])>>>19|I<<13)^(I>>>29|E<<3)^(E>>>6|I<<26))>>>16,v+=65535&(C=(I>>>19|E<<13)^(E>>>29|I<<3)^I>>>6),x+=C>>>16,x+=(v+=(Q+=(B+=65535&S)>>>16)>>>16)>>>16,L[w]=65535&v|x<<16,k[w]=65535&B|Q<<16;B=65535&(S=O),Q=S>>>16,v=65535&(C=D),x=C>>>16,C=e[0],Q+=(S=t[0])>>>16,v+=65535&C,x+=C>>>16,x+=(v+=(Q+=(B+=65535&S)>>>16)>>>16)>>>16,e[0]=D=65535&v|x<<16,t[0]=O=65535&B|Q<<16,B=65535&(S=F),Q=S>>>16,v=65535&(C=U),x=C>>>16,C=e[1],Q+=(S=t[1])>>>16,v+=65535&C,x+=C>>>16,x+=(v+=(Q+=(B+=65535&S)>>>16)>>>16)>>>16,e[1]=U=65535&v|x<<16,t[1]=F=65535&B|Q<<16,B=65535&(S=H),Q=S>>>16,v=65535&(C=K),x=C>>>16,C=e[2],Q+=(S=t[2])>>>16,v+=65535&C,x+=C>>>16,x+=(v+=(Q+=(B+=65535&S)>>>16)>>>16)>>>16,e[2]=K=65535&v|x<<16,t[2]=H=65535&B|Q<<16,B=65535&(S=R),Q=S>>>16,v=65535&(C=M),x=C>>>16,C=e[3],Q+=(S=t[3])>>>16,v+=65535&C,x+=C>>>16,x+=(v+=(Q+=(B+=65535&S)>>>16)>>>16)>>>16,e[3]=M=65535&v|x<<16,t[3]=R=65535&B|Q<<16,B=65535&(S=G),Q=S>>>16,v=65535&(C=T),x=C>>>16,C=e[4],Q+=(S=t[4])>>>16,v+=65535&C,x+=C>>>16,x+=(v+=(Q+=(B+=65535&S)>>>16)>>>16)>>>16,e[4]=T=65535&v|x<<16,t[4]=G=65535&B|Q<<16,B=65535&(S=V),Q=S>>>16,v=65535&(C=Y),x=C>>>16,C=e[5],Q+=(S=t[5])>>>16,v+=65535&C,x+=C>>>16,x+=(v+=(Q+=(B+=65535&S)>>>16)>>>16)>>>16,e[5]=Y=65535&v|x<<16,t[5]=V=65535&B|Q<<16,B=65535&(S=q),Q=S>>>16,v=65535&(C=N),x=C>>>16,C=e[6],Q+=(S=t[6])>>>16,v+=65535&C,x+=C>>>16,x+=(v+=(Q+=(B+=65535&S)>>>16)>>>16)>>>16,e[6]=N=65535&v|x<<16,t[6]=q=65535&B|Q<<16,B=65535&(S=J),Q=S>>>16,v=65535&(C=P),x=C>>>16,C=e[7],Q+=(S=t[7])>>>16,v+=65535&C,x+=C>>>16,x+=(v+=(Q+=(B+=65535&S)>>>16)>>>16)>>>16,e[7]=P=65535&v|x<<16,t[7]=J=65535&B|Q<<16,j+=128,r-=128}}function de(e){if(!(this instanceof de))return new de(e);this.pad=se.alloc(128),this.inner=ce(),this.outer=ce();const t=se.alloc(64);e.byteLength>128&&(ce().update(e).digest(t),e=t),this.pad.fill(54);for(let t=0;t<e.byteLength;t++)this.pad[t]^=e[t];this.inner.update(this.pad),this.pad.fill(92);for(let t=0;t<e.byteLength;t++)this.pad[t]^=e[t];this.outer.update(this.pad),this.pad.fill(0),t.fill(0)}ce.prototype.update=function(e,t){ie(!1===this.finalised,"Hash instance finalised");var[n,r]=function(e,t){var n=se.from(e,t);return[n,n.byteLength]}(e,t);this.bytesRead+=r;const i=r+this.pos&-128;this.buffer.set(n.subarray(0,ae-this.pos),this.pos);const s=this.pos;return(r-=ae-this.pos)>=0&&(le(this.hh,this.hl,this.buffer,128),this.pos=0),r>127&&(le(this.hh,this.hl,n.subarray(ae-s,i-s),i-ae),r%=128),this.buffer.set(n.subarray(n.byteLength-r)),this.pos=127&this.bytesRead,this.buffer.fill(0,this.pos),this},ce.prototype.digest=function(e,t=0){if(ie(!1===this.finalised,"Hash instance finalised"),this.finalised=!0,this.buffer.fill(0,this.pos),this.buffer[this.pos]=128,this.pos>111&&(le(this.hh,this.hl,this.buffer,128),this.buffer.fill(0),this.pos=0),ue(this.buffer,120,this.bytesRead/536870912|0,this.bytesRead<<3),le(this.hh,this.hl,this.buffer,128),e instanceof Uint8Array&&e.byteLength>63){for(let n=0;n<8;n++)ue(e,8*n+t,this.hh[n],this.hl[n]);return e}const n=new Uint8Array(64);for(let e=0;e<8;e++)ue(n,8*e,this.hh[e],this.hl[e]);return"string"==typeof e?se.toString(n,e):n},de.prototype.update=function(e,t){return this.inner.update(e,t),this},de.prototype.digest=function(e,t=0){return this.outer.update(this.inner.digest()),this.outer.digest(e,t)},ce.HMAC=de;const fe=ne;var Ae=oe;re.exports=function(){return new Ae},re.exports.ready=function(e){fe.ready((function(){e()}))},re.exports.WASM_SUPPORTED=fe.SUPPORTED,re.exports.WASM_LOADED=!1,re.exports.SHA512_BYTES=64,fe.ready((function(e){e||(re.exports.WASM_LOADED=!0,re.exports=Ae=fe)}));var ge,pe,ye=re.exports,_e={exports:{}},be=(()=>{for(var e=new Uint8Array(128),t=0;t<64;t++)e[t<26?t+65:t<52?t+71:t<62?t-4:4*t-205]=t;return t=>{for(var n=t.length,r=new Uint8Array(3*(n-("="==t[n-1])-("="==t[n-2]))/4|0),i=0,s=0;i<n;){var o=e[t.charCodeAt(i++)],a=e[t.charCodeAt(i++)],h=e[t.charCodeAt(i++)],c=e[t.charCodeAt(i++)];r[s++]=o<<2|a>>4,r[s++]=a<<4|h>>2,r[s++]=h<<6|c}return r}})(),Ie=(ge={"wasm-binary:./blake2b.wat"(e,t){t.exports=be("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")}},function(){return pe||(0,ge[Object.keys(ge)[0]])((pe={exports:{}}).exports,pe),pe.exports})(),Ee=WebAssembly.compile(Ie),me=e,we=I,Ce=null,Se="undefined"!=typeof WebAssembly&&(async()=>(await WebAssembly.instantiate(await Ee,void 0)).exports)().then((e=>{Ce=e})),Be=64,Qe=[];_e.exports=Ke;var ve=_e.exports.BYTES_MIN=16,xe=_e.exports.BYTES_MAX=64;_e.exports.BYTES=32;var Le=_e.exports.KEYBYTES_MIN=16,ke=_e.exports.KEYBYTES_MAX=64;_e.exports.KEYBYTES=32;var De=_e.exports.SALTBYTES=16,Ue=_e.exports.PERSONALBYTES=16;function Ke(e,t,n,r,i){if(!(this instanceof Ke))return new Ke(e,t,n,r,i);if(!Ce)throw new Error("WASM not loaded. Wait for Blake2b.ready(cb)");e||(e=32),!0!==i&&(me(e>=ve,"digestLength must be at least "+ve+", was given "+e),me(e<=xe,"digestLength must be at most "+xe+", was given "+e),null!=t&&(me(t instanceof Uint8Array,"key must be Uint8Array or Buffer"),me(t.length>=Le,"key must be at least "+Le+", was given "+t.length),me(t.length<=ke,"key must be at least "+ke+", was given "+t.length)),null!=n&&(me(n instanceof Uint8Array,"salt must be Uint8Array or Buffer"),me(n.length===De,"salt must be exactly "+De+", was given "+n.length)),null!=r&&(me(r instanceof Uint8Array,"personal must be Uint8Array or Buffer"),me(r.length===Ue,"personal must be exactly "+Ue+", was given "+r.length))),Qe.length||(Qe.push(Be),Be+=216),this.digestLength=e,this.finalized=!1,this.pointer=Qe.pop(),this._memory=new Uint8Array(Ce.memory.buffer),this._memory.fill(0,0,64),this._memory[0]=this.digestLength,this._memory[1]=t?t.length:0,this._memory[2]=1,this._memory[3]=1,n&&this._memory.set(n,32),r&&this._memory.set(r,48),this.pointer+216>this._memory.length&&this._realloc(this.pointer+216),Ce.blake2b_init(this.pointer,this.digestLength),t&&(this.update(t),this._memory.fill(0,Be,Be+t.length),this._memory[this.pointer+200]=128)}function Me(){}Ke.prototype._realloc=function(e){Ce.memory.grow(Math.max(0,Math.ceil(Math.abs(e-this._memory.length)/65536))),this._memory=new Uint8Array(Ce.memory.buffer)},Ke.prototype.update=function(e){return me(!1===this.finalized,"Hash instance finalized"),me(e instanceof Uint8Array,"input must be Uint8Array or Buffer"),Be+e.length>this._memory.length&&this._realloc(Be+e.length),this._memory.set(e,Be),Ce.blake2b_update(this.pointer,Be,Be+e.length),this},Ke.prototype.digest=function(e){if(me(!1===this.finalized,"Hash instance finalized"),this.finalized=!0,Qe.push(this.pointer),Ce.blake2b_final(this.pointer),!e||"binary"===e)return this._memory.slice(this.pointer+128,this.pointer+128+this.digestLength);if("string"==typeof e)return we.toString(this._memory,e,this.pointer+128,this.pointer+128+this.digestLength);me(e instanceof Uint8Array&&e.length>=this.digestLength,"input must be Uint8Array or Buffer");for(var t=0;t<this.digestLength;t++)e[t]=this._memory[this.pointer+128+t];return e},Ke.prototype.final=Ke.prototype.digest,Ke.WASM=Ce,Ke.SUPPORTED="undefined"!=typeof WebAssembly,Ke.ready=function(e){return e||(e=Me),Se?Se.then((()=>e()),e):e(new Error("WebAssembly not supported"))},Ke.prototype.ready=Ke.ready,Ke.prototype.getPartialHash=function(){return this._memory.slice(this.pointer,this.pointer+216)},Ke.prototype.setPartialHash=function(e){this._memory.set(e,this.pointer)};var Te=_e.exports;_e.exports.SUPPORTED,_e.exports.WASM,_e.exports.ready;var Ye={exports:{}},Ne=e,Pe=Te;function Oe(e,t,n){var r=e[t]+e[n],i=e[t+1]+e[n+1];r>=4294967296&&i++,e[t]=r,e[t+1]=i}function Fe(e,t,n,r){var i=e[t]+n;n<0&&(i+=4294967296);var s=e[t+1]+r;i>=4294967296&&s++,e[t]=i,e[t+1]=s}function He(e,t){return e[t]^e[t+1]<<8^e[t+2]<<16^e[t+3]<<24}function Re(e,t,n,r,i,s){var o=Je[i],a=Je[i+1],h=Je[s],c=Je[s+1];Oe(qe,e,t),Fe(qe,e,o,a);var u=qe[r]^qe[e],l=qe[r+1]^qe[e+1];qe[r]=l,qe[r+1]=u,Oe(qe,n,r),u=qe[t]^qe[n],l=qe[t+1]^qe[n+1],qe[t]=u>>>24^l<<8,qe[t+1]=l>>>24^u<<8,Oe(qe,e,t),Fe(qe,e,h,c),u=qe[r]^qe[e],l=qe[r+1]^qe[e+1],qe[r]=u>>>16^l<<16,qe[r+1]=l>>>16^u<<16,Oe(qe,n,r),u=qe[t]^qe[n],l=qe[t+1]^qe[n+1],qe[t]=l>>>31^u<<1,qe[t+1]=u>>>31^l<<1}var Ge=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),Ve=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3].map((function(e){return 2*e}))),qe=new Uint32Array(32),Je=new Uint32Array(32);function je(e,t){var n=0;for(n=0;n<16;n++)qe[n]=e.h[n],qe[n+16]=Ge[n];for(qe[24]=qe[24]^e.t,qe[25]=qe[25]^e.t/4294967296,t&&(qe[28]=~qe[28],qe[29]=~qe[29]),n=0;n<32;n++)Je[n]=He(e.b,4*n);for(n=0;n<12;n++)Re(0,8,16,24,Ve[16*n+0],Ve[16*n+1]),Re(2,10,18,26,Ve[16*n+2],Ve[16*n+3]),Re(4,12,20,28,Ve[16*n+4],Ve[16*n+5]),Re(6,14,22,30,Ve[16*n+6],Ve[16*n+7]),Re(0,10,20,30,Ve[16*n+8],Ve[16*n+9]),Re(2,12,22,24,Ve[16*n+10],Ve[16*n+11]),Re(4,14,16,26,Ve[16*n+12],Ve[16*n+13]),Re(6,8,18,28,Ve[16*n+14],Ve[16*n+15]);for(n=0;n<16;n++)e.h[n]=e.h[n]^qe[n]^qe[n+16]}var We=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);function ze(e,t,n,r){We.fill(0),this.b=new Uint8Array(128),this.h=new Uint32Array(16),this.t=0,this.c=0,this.outlen=e,We[0]=e,t&&(We[1]=t.length),We[2]=1,We[3]=1,n&&We.set(n,32),r&&We.set(r,48);for(var i=0;i<16;i++)this.h[i]=Ge[i]^He(We,4*i);t&&(Xe(this,t),this.c=128)}function Xe(e,t){for(var n=0;n<t.length;n++)128===e.c&&(e.t+=e.c,je(e,!1),e.c=0),e.b[e.c++]=t[n]}function Ze(e){return e<16?"0"+e.toString(16):e.toString(16)}ze.prototype.update=function(e){return Ne(e instanceof Uint8Array,"input must be Uint8Array or Buffer"),Xe(this,e),this},ze.prototype.digest=function(e){var t=e&&"binary"!==e&&"hex"!==e?e:new Uint8Array(this.outlen);return Ne(t instanceof Uint8Array,'out must be "binary", "hex", Uint8Array, or Buffer'),Ne(t.length>=this.outlen,"out must have at least outlen bytes of space"),function(e,t){for(e.t+=e.c;e.c<128;)e.b[e.c++]=0;je(e,!0);for(var n=0;n<e.outlen;n++)t[n]=e.h[n>>2]>>8*(3&n)}(this,t),"hex"===e?function(e){for(var t="",n=0;n<e.length;n++)t+=Ze(e[n]);return t}(t):t},ze.prototype.final=ze.prototype.digest,ze.ready=function(e){Pe.ready((function(){e()}))};var $e=ze;Ye.exports=function(e,t,n,r,i){return!0!==i&&(Ne(e>=et,"outlen must be at least "+et+", was given "+e),Ne(e<=tt,"outlen must be at most "+tt+", was given "+e),null!=t&&(Ne(t instanceof Uint8Array,"key must be Uint8Array or Buffer"),Ne(t.length>=nt,"key must be at least "+nt+", was given "+t.length),Ne(t.length<=rt,"key must be at most "+rt+", was given "+t.length)),null!=n&&(Ne(n instanceof Uint8Array,"salt must be Uint8Array or Buffer"),Ne(n.length===it,"salt must be exactly "+it+", was given "+n.length)),null!=r&&(Ne(r instanceof Uint8Array,"personal must be Uint8Array or Buffer"),Ne(r.length===st,"personal must be exactly "+st+", was given "+r.length))),new $e(e,t,n,r)},Ye.exports.ready=function(e){Pe.ready((function(){e()}))},Ye.exports.WASM_SUPPORTED=Pe.SUPPORTED,Ye.exports.WASM_LOADED=!1;var et=Ye.exports.BYTES_MIN=16,tt=Ye.exports.BYTES_MAX=64;Ye.exports.BYTES=32;var nt=Ye.exports.KEYBYTES_MIN=16,rt=Ye.exports.KEYBYTES_MAX=64;Ye.exports.KEYBYTES=32;var it=Ye.exports.SALTBYTES=16,st=Ye.exports.PERSONALBYTES=16;Pe.ready((function(e){e||(Ye.exports.WASM_LOADED=!0,Ye.exports=Pe)}));var ot,at,ht=Ye.exports,ct=(()=>{for(var e=new Uint8Array(128),t=0;t<64;t++)e[t<26?t+65:t<52?t+71:t<62?t-4:4*t-205]=t;return t=>{for(var n=t.length,r=new Uint8Array(3*(n-("="==t[n-1])-("="==t[n-2]))/4|0),i=0,s=0;i<n;){var o=e[t.charCodeAt(i++)],a=e[t.charCodeAt(i++)],h=e[t.charCodeAt(i++)],c=e[t.charCodeAt(i++)];r[s++]=o<<2|a>>4,r[s++]=a<<4|h>>2,r[s++]=h<<6|c}return r}})(),ut=(ot={"wasm-binary:./xsalsa20.wat"(e,t){t.exports=ct("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")}},function(){return at||(0,ot[Object.keys(ot)[0]])((at={exports:{}}).exports,at),at.exports})(),lt=new WebAssembly.Module(ut),dt="undefined"!=typeof WebAssembly&&new WebAssembly.Instance(lt,undefined).exports,ft=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]),At=144,gt=At,pt=[],yt=_t;function _t(e,t){if(!(this instanceof _t))return new _t(e,t);if(!e||e.length<24)throw new Error("nonce must be at least 24 bytes");if(!t||t.length<32)throw new Error("key must be at least 32 bytes");this._xor=dt?new bt(e,t):new It(e,t)}function bt(e,t){pt.length||(pt.push(At),At+=64),this._pointer=pt.pop(),this._nonce=this._pointer+8,this._key=this._nonce+24,this._overflow=0,this._memory=new Uint8Array(dt.memory.buffer),this._memory.fill(0,this._pointer,this._pointer+8),this._memory.set(e,this._nonce),this._memory.set(t,this._key)}function It(e,t){this._s=new Uint8Array(32),this._z=new Uint8Array(16),this._overflow=0,mt(this._s,e,t,ft);for(var n=0;n<8;n++)this._z[n]=e[n+16]}function Et(e,t,n,r){for(var i,s=255&r[0]|(255&r[1])<<8|(255&r[2])<<16|(255&r[3])<<24,o=255&n[0]|(255&n[1])<<8|(255&n[2])<<16|(255&n[3])<<24,a=255&n[4]|(255&n[5])<<8|(255&n[6])<<16|(255&n[7])<<24,h=255&n[8]|(255&n[9])<<8|(255&n[10])<<16|(255&n[11])<<24,c=255&n[12]|(255&n[13])<<8|(255&n[14])<<16|(255&n[15])<<24,u=255&r[4]|(255&r[5])<<8|(255&r[6])<<16|(255&r[7])<<24,l=255&t[0]|(255&t[1])<<8|(255&t[2])<<16|(255&t[3])<<24,d=255&t[4]|(255&t[5])<<8|(255&t[6])<<16|(255&t[7])<<24,f=255&t[8]|(255&t[9])<<8|(255&t[10])<<16|(255&t[11])<<24,A=255&t[12]|(255&t[13])<<8|(255&t[14])<<16|(255&t[15])<<24,g=255&r[8]|(255&r[9])<<8|(255&r[10])<<16|(255&r[11])<<24,p=255&n[16]|(255&n[17])<<8|(255&n[18])<<16|(255&n[19])<<24,y=255&n[20]|(255&n[21])<<8|(255&n[22])<<16|(255&n[23])<<24,_=255&n[24]|(255&n[25])<<8|(255&n[26])<<16|(255&n[27])<<24,b=255&n[28]|(255&n[29])<<8|(255&n[30])<<16|(255&n[31])<<24,I=255&r[12]|(255&r[13])<<8|(255&r[14])<<16|(255&r[15])<<24,E=s,m=o,w=a,C=h,S=c,B=u,Q=l,v=d,x=f,L=A,k=g,D=p,U=y,K=_,M=b,T=I,Y=0;Y<20;Y+=2)E^=(i=(U^=(i=(x^=(i=(S^=(i=E+U|0)<<7|i>>>25)+E|0)<<9|i>>>23)+S|0)<<13|i>>>19)+x|0)<<18|i>>>14,B^=(i=(m^=(i=(K^=(i=(L^=(i=B+m|0)<<7|i>>>25)+B|0)<<9|i>>>23)+L|0)<<13|i>>>19)+K|0)<<18|i>>>14,k^=(i=(Q^=(i=(w^=(i=(M^=(i=k+Q|0)<<7|i>>>25)+k|0)<<9|i>>>23)+M|0)<<13|i>>>19)+w|0)<<18|i>>>14,T^=(i=(D^=(i=(v^=(i=(C^=(i=T+D|0)<<7|i>>>25)+T|0)<<9|i>>>23)+C|0)<<13|i>>>19)+v|0)<<18|i>>>14,E^=(i=(C^=(i=(w^=(i=(m^=(i=E+C|0)<<7|i>>>25)+E|0)<<9|i>>>23)+m|0)<<13|i>>>19)+w|0)<<18|i>>>14,B^=(i=(S^=(i=(v^=(i=(Q^=(i=B+S|0)<<7|i>>>25)+B|0)<<9|i>>>23)+Q|0)<<13|i>>>19)+v|0)<<18|i>>>14,k^=(i=(L^=(i=(x^=(i=(D^=(i=k+L|0)<<7|i>>>25)+k|0)<<9|i>>>23)+D|0)<<13|i>>>19)+x|0)<<18|i>>>14,T^=(i=(M^=(i=(K^=(i=(U^=(i=T+M|0)<<7|i>>>25)+T|0)<<9|i>>>23)+U|0)<<13|i>>>19)+K|0)<<18|i>>>14;E=E+s|0,m=m+o|0,w=w+a|0,C=C+h|0,S=S+c|0,B=B+u|0,Q=Q+l|0,v=v+d|0,x=x+f|0,L=L+A|0,k=k+g|0,D=D+p|0,U=U+y|0,K=K+_|0,M=M+b|0,T=T+I|0,e[0]=E>>>0&255,e[1]=E>>>8&255,e[2]=E>>>16&255,e[3]=E>>>24&255,e[4]=m>>>0&255,e[5]=m>>>8&255,e[6]=m>>>16&255,e[7]=m>>>24&255,e[8]=w>>>0&255,e[9]=w>>>8&255,e[10]=w>>>16&255,e[11]=w>>>24&255,e[12]=C>>>0&255,e[13]=C>>>8&255,e[14]=C>>>16&255,e[15]=C>>>24&255,e[16]=S>>>0&255,e[17]=S>>>8&255,e[18]=S>>>16&255,e[19]=S>>>24&255,e[20]=B>>>0&255,e[21]=B>>>8&255,e[22]=B>>>16&255,e[23]=B>>>24&255,e[24]=Q>>>0&255,e[25]=Q>>>8&255,e[26]=Q>>>16&255,e[27]=Q>>>24&255,e[28]=v>>>0&255,e[29]=v>>>8&255,e[30]=v>>>16&255,e[31]=v>>>24&255,e[32]=x>>>0&255,e[33]=x>>>8&255,e[34]=x>>>16&255,e[35]=x>>>24&255,e[36]=L>>>0&255,e[37]=L>>>8&255,e[38]=L>>>16&255,e[39]=L>>>24&255,e[40]=k>>>0&255,e[41]=k>>>8&255,e[42]=k>>>16&255,e[43]=k>>>24&255,e[44]=D>>>0&255,e[45]=D>>>8&255,e[46]=D>>>16&255,e[47]=D>>>24&255,e[48]=U>>>0&255,e[49]=U>>>8&255,e[50]=U>>>16&255,e[51]=U>>>24&255,e[52]=K>>>0&255,e[53]=K>>>8&255,e[54]=K>>>16&255,e[55]=K>>>24&255,e[56]=M>>>0&255,e[57]=M>>>8&255,e[58]=M>>>16&255,e[59]=M>>>24&255,e[60]=T>>>0&255,e[61]=T>>>8&255,e[62]=T>>>16&255,e[63]=T>>>24&255}function mt(e,t,n,r){for(var i,s=255&r[0]|(255&r[1])<<8|(255&r[2])<<16|(255&r[3])<<24,o=255&n[0]|(255&n[1])<<8|(255&n[2])<<16|(255&n[3])<<24,a=255&n[4]|(255&n[5])<<8|(255&n[6])<<16|(255&n[7])<<24,h=255&n[8]|(255&n[9])<<8|(255&n[10])<<16|(255&n[11])<<24,c=255&n[12]|(255&n[13])<<8|(255&n[14])<<16|(255&n[15])<<24,u=255&r[4]|(255&r[5])<<8|(255&r[6])<<16|(255&r[7])<<24,l=255&t[0]|(255&t[1])<<8|(255&t[2])<<16|(255&t[3])<<24,d=255&t[4]|(255&t[5])<<8|(255&t[6])<<16|(255&t[7])<<24,f=255&t[8]|(255&t[9])<<8|(255&t[10])<<16|(255&t[11])<<24,A=255&t[12]|(255&t[13])<<8|(255&t[14])<<16|(255&t[15])<<24,g=255&r[8]|(255&r[9])<<8|(255&r[10])<<16|(255&r[11])<<24,p=255&n[16]|(255&n[17])<<8|(255&n[18])<<16|(255&n[19])<<24,y=255&n[20]|(255&n[21])<<8|(255&n[22])<<16|(255&n[23])<<24,_=255&n[24]|(255&n[25])<<8|(255&n[26])<<16|(255&n[27])<<24,b=255&n[28]|(255&n[29])<<8|(255&n[30])<<16|(255&n[31])<<24,I=255&r[12]|(255&r[13])<<8|(255&r[14])<<16|(255&r[15])<<24,E=0;E<20;E+=2)s^=(i=(y^=(i=(f^=(i=(c^=(i=s+y|0)<<7|i>>>25)+s|0)<<9|i>>>23)+c|0)<<13|i>>>19)+f|0)<<18|i>>>14,u^=(i=(o^=(i=(_^=(i=(A^=(i=u+o|0)<<7|i>>>25)+u|0)<<9|i>>>23)+A|0)<<13|i>>>19)+_|0)<<18|i>>>14,g^=(i=(l^=(i=(a^=(i=(b^=(i=g+l|0)<<7|i>>>25)+g|0)<<9|i>>>23)+b|0)<<13|i>>>19)+a|0)<<18|i>>>14,I^=(i=(p^=(i=(d^=(i=(h^=(i=I+p|0)<<7|i>>>25)+I|0)<<9|i>>>23)+h|0)<<13|i>>>19)+d|0)<<18|i>>>14,s^=(i=(h^=(i=(a^=(i=(o^=(i=s+h|0)<<7|i>>>25)+s|0)<<9|i>>>23)+o|0)<<13|i>>>19)+a|0)<<18|i>>>14,u^=(i=(c^=(i=(d^=(i=(l^=(i=u+c|0)<<7|i>>>25)+u|0)<<9|i>>>23)+l|0)<<13|i>>>19)+d|0)<<18|i>>>14,g^=(i=(A^=(i=(f^=(i=(p^=(i=g+A|0)<<7|i>>>25)+g|0)<<9|i>>>23)+p|0)<<13|i>>>19)+f|0)<<18|i>>>14,I^=(i=(b^=(i=(_^=(i=(y^=(i=I+b|0)<<7|i>>>25)+I|0)<<9|i>>>23)+y|0)<<13|i>>>19)+_|0)<<18|i>>>14;e[0]=s>>>0&255,e[1]=s>>>8&255,e[2]=s>>>16&255,e[3]=s>>>24&255,e[4]=u>>>0&255,e[5]=u>>>8&255,e[6]=u>>>16&255,e[7]=u>>>24&255,e[8]=g>>>0&255,e[9]=g>>>8&255,e[10]=g>>>16&255,e[11]=g>>>24&255,e[12]=I>>>0&255,e[13]=I>>>8&255,e[14]=I>>>16&255,e[15]=I>>>24&255,e[16]=l>>>0&255,e[17]=l>>>8&255,e[18]=l>>>16&255,e[19]=l>>>24&255,e[20]=d>>>0&255,e[21]=d>>>8&255,e[22]=d>>>16&255,e[23]=d>>>24&255,e[24]=f>>>0&255,e[25]=f>>>8&255,e[26]=f>>>16&255,e[27]=f>>>24&255,e[28]=A>>>0&255,e[29]=A>>>8&255,e[30]=A>>>16&255,e[31]=A>>>24&255}_t.NONCEBYTES=24,_t.KEYBYTES=32,_t.core_hsalsa20=mt,_t.SIGMA=ft,_t.prototype.update=function(e,t){if(!e)throw new Error("input must be Uint8Array or Buffer");return t||(t=new Uint8Array(e.length)),e.length&&this._xor.update(e,t),t},_t.prototype.final=_t.prototype.finalize=function(){this._xor.finalize(),this._xor=null},bt.prototype.realloc=function(e){dt.memory.grow(Math.ceil(Math.abs(e-this._memory.length)/65536)),this._memory=new Uint8Array(dt.memory.buffer)},bt.prototype.update=function(e,t){var n=this._overflow+e.length,r=At+this._overflow;(gt=At+n)>=this._memory.length&&this.realloc(gt),this._memory.set(e,r),dt.xsalsa20_xor(this._pointer,At,At,n,this._nonce,this._key),t.set(this._memory.subarray(r,At+n)),this._overflow=63&n},bt.prototype.finalize=function(){this._memory.fill(0,this._pointer,this._key+32),gt>At&&(this._memory.fill(0,At,gt),gt=0),pt.push(this._pointer)},It.prototype.update=function(e,t){for(var n=new Uint8Array(64),r=0,i=this._overflow,s=e.length+this._overflow,o=this._z,a=-this._overflow,h=-this._overflow;s>=64;){for(Et(n,o,this._s,ft);i<64;i++)t[h+i]=e[a+i]^n[i];for(r=1,i=8;i<16;i++)r+=255&o[i],o[i]=255&r,r>>>=8;s-=64,h+=64,a+=64,i=0}if(s>0)for(Et(n,o,this._s,ft);i<s;i++)t[h+i]=e[a+i]^n[i];this._overflow=63&s},It.prototype.finalize=function(){this._s.fill(0),this._z.fill(0)};var wt,Ct,St={exports:{}},Bt=(()=>{for(var e=new Uint8Array(128),t=0;t<64;t++)e[t<26?t+65:t<52?t+71:t<62?t-4:4*t-205]=t;return t=>{for(var n=t.length,r=new Uint8Array(3*(n-("="==t[n-1])-("="==t[n-2]))/4|0),i=0,s=0;i<n;){var o=e[t.charCodeAt(i++)],a=e[t.charCodeAt(i++)],h=e[t.charCodeAt(i++)],c=e[t.charCodeAt(i++)];r[s++]=o<<2|a>>4,r[s++]=a<<4|h>>2,r[s++]=h<<6|c}return r}})(),Qt=(wt={"wasm-binary:./sha256.wat"(e,t){t.exports=Bt("AGFzbQEAAAABNAVgAX8Bf2AIf39/f39/f38AYAR/f39/AX9gEX9/f39/f39/f39/f39/f39/AGAEf39/fwADBgUAAQIDBAUDAQABBikIfwFBAAt/AUEAC38BQQALfwFBAAt/AUEAC38BQQALfwFBAAt/AUEACwcTAgZtZW1vcnkCAAZzaGEyNTYABAreFwUZACAAQf+B/AdxQQh4IABBgP6DeHFBCHdyC7wDAQZ/IwQjBXEjBEF/cyMGcXMhCiMAIwFxIwAjAnFzIwEjAnFzIQsjAEECeCMAQQ14cyMAQRZ4cyEMIwRBBngjBEELeHMjBEEZeHMhDSMHIApqIA1qIABqIARqIQggDCALaiEJIwMgCGokByAIIAlqJAMjByMEcSMHQX9zIwVxcyEKIwMjAHEjAyMBcXMjACMBcXMhCyMDQQJ4IwNBDXhzIwNBFnhzIQwjB0EGeCMHQQt4cyMHQRl4cyENIwYgCmogDWogAWogBWohCCAMIAtqIQkjAiAIaiQGIAggCWokAiMGIwdxIwZBf3MjBHFzIQojAiMDcSMCIwBxcyMDIwBxcyELIwJBAngjAkENeHMjAkEWeHMhDCMGQQZ4IwZBC3hzIwZBGXhzIQ0jBSAKaiANaiACaiAGaiEIIAwgC2ohCSMBIAhqJAUgCCAJaiQBIwUjBnEjBUF/cyMHcXMhCiMBIwJxIwEjA3FzIwIjA3FzIQsjAUECeCMBQQ14cyMBQRZ4cyEMIwVBBngjBUELeHMjBUEZeHMhDSMEIApqIA1qIANqIAdqIQggDCALaiEJIwAgCGokBCAIIAlqJAALKwAgAEEReCAAQRN4cyAAQQp2cyABaiACQQd4IAJBEnhzIAJBA3ZzIANqagvLCwEwfyAAKAJoRQRAIABB58yn0AY2AgAgAEGF3Z7bezYCBCAAQfLmu+MDNgIIIABBuuq/qno2AgwgAEH/pLmIBTYCECAAQYzRldh5NgIUIABBq7OP/AE2AhggAEGZmoPfBTYCHCAAQQE2AmgLIAAoAgAkACAAKAIEJAEgACgCCCQCIAAoAgwkAyAAKAIQJAQgACgCFCQFIAAoAhgkBiAAKAIcJAcgARAAIQEgAhAAIQIgAxAAIQMgBBAAIQQgBRAAIQUgBhAAIQYgBxAAIQcgCBAAIQggCRAAIQkgChAAIQogCxAAIQsgDBAAIQwgDRAAIQ0gDhAAIQ4gDxAAIQ8gEBAAIRAgASACIAMgBEGY36iUBEGRid2JB0HP94Oue0Glt9fNfhABIAUgBiAHIAhB24TbygNB8aPEzwVBpIX+kXlB1b3x2HoQASAJIAogCyAMQZjVnsB9QYG2jZQBQb6LxqECQcP7sagFEAEgDSAOIA8gEEH0uvmVB0H+4/qGeEGnjfDeeUH04u+MfBABIA8gCiACIAEQAiEBIBAgCyADIAIQAiECIAEgDCAEIAMQAiEDIAIgDSAFIAQQAiEEIAMgDiAGIAUQAiEFIAQgDyAHIAYQAiEGIAUgECAIIAcQAiEHIAYgASAJIAgQAiEIIAcgAiAKIAkQAiEJIAggAyALIAoQAiEKIAkgBCAMIAsQAiELIAogBSANIAwQAiEMIAsgBiAOIA0QAiENIAwgByAPIA4QAiEOIA0gCCAQIA8QAiEPIA4gCSABIBAQAiEQIAEgAiADIARBwdPtpH5Bho/5/X5BxruG/gBBzMOyoAIQASAFIAYgByAIQe/YpO8CQaqJ0tMEQdzTwuUFQdqR5rcHEAEgCSAKIAsgDEHSovnBeUHtjMfBekHIz4yAe0HH/+X6exABIA0gDiAPIBBB85eAt3xBx6KerX1B0capNkHn0qShARABIA8gCiACIAEQAiEBIBAgCyADIAIQAiECIAEgDCAEIAMQAiEDIAIgDSAFIAQQAiEEIAMgDiAGIAUQAiEFIAQgDyAHIAYQAiEGIAUgECAIIAcQAiEHIAYgASAJIAgQAiEIIAcgAiAKIAkQAiEJIAggAyALIAoQAiEKIAkgBCAMIAsQAiELIAogBSANIAwQAiEMIAsgBiAOIA0QAiENIAwgByAPIA4QAiEOIA0gCCAQIA8QAiEPIA4gCSABIBAQAiEQIAEgAiADIARBhZXcvQJBuMLs8AJB/Nux6QRBk5rgmQUQASAFIAYgByAIQdTmqagGQbuVqLMHQa6Si454QYXZyJN5EAEgCSAKIAsgDEGh0f+VekHLzOnAekHwlq6SfEGjo7G7fBABIA0gDiAPIBBBmdDLjH1BpIzktH1Bheu4oH9B8MCqgwEQASAPIAogAiABEAIhASAQIAsgAyACEAIhAiABIAwgBCADEAIhAyACIA0gBSAEEAIhBCADIA4gBiAFEAIhBSAEIA8gByAGEAIhBiAFIBAgCCAHEAIhByAGIAEgCSAIEAIhCCAHIAIgCiAJEAIhCSAIIAMgCyAKEAIhCiAJIAQgDCALEAIhCyAKIAUgDSAMEAIhDCALIAYgDiANEAIhDSAMIAcgDyAOEAIhDiANIAggECAPEAIhDyAOIAkgASAQEAIhECABIAIgAyAEQZaCk80BQYjY3fEBQczuoboCQbX5wqUDEAEgBSAGIAcgCEGzmfDIA0HK1OL2BEHPlPPcBUHz37nBBhABIAkgCiALIAxB7oW+pAdB78aVxQdBlPChpnhBiISc5ngQASANIA4gDyAQQfr/+4V5QevZwaJ6QffH5vd7QfLxxbN8EAEgACAAKAIAIwBqNgIAIAAgACgCBCMBajYCBCAAIAAoAggjAmo2AgggACAAKAIMIwNqNgIMIAAgACgCECMEajYCECAAIAAoAhQjBWo2AhQgACAAKAIYIwZqNgIYIAAgACgCHCMHajYCHAuKCAIBfhJ/IAApAyAhBCAEp0E/cSACaiEGIAQgAq18IQQgACAENwMgAkAgACgCKCEHIAAoAiwhCCAAKAIwIQkgACgCNCEKIAAoAjghCyAAKAI8IQwgACgCQCENIAAoAkQhDiAAKAJIIQ8gACgCTCEQIAAoAlAhESAAKAJUIRIgACgCWCETIAAoAlwhFCAAKAJgIRUgACgCZCEWIAZBwABrIgZBAEgNACAAIAcgCCAJIAogCyAMIA0gDiAPIBAgESASIBMgFCAVIBYQAwNAIAEoAgAhByABKAIEIQggASgCCCEJIAEoAgwhCiABKAIQIQsgASgCFCEMIAEoAhghDSABKAIcIQ4gASgCICEPIAEoAiQhECABKAIoIREgASgCLCESIAEoAjAhEyABKAI0IRQgASgCOCEVIAEoAjwhFiABQcAAaiEBIAZBwABrIgZBAEgEQCAAIAc2AiggACAINgIsIAAgCTYCMCAAIAo2AjQgACALNgI4IAAgDDYCPCAAIA02AkAgACAONgJEIAAgDzYCSCAAIBA2AkwgACARNgJQIAAgEjYCVCAAIBM2AlggACAUNgJcIAAgFTYCYCAAIBY2AmQMAgsgACAHIAggCSAKIAsgDCANIA4gDyAQIBEgEiATIBQgFSAWEAMMAAsLIANBAUYEQCAEp0E/cSEGQYABIAZBA3FBA3R0IQUCQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAgBkECdg4PAwQFBgcICQoLDA0ODxABAgsLIAUgFXIhFUEAIQULIAUgFnIhFkEAIQUgACAHIAggCSAKIAsgDCANIA4gDyAQIBEgEiATIBQgFSAWEAMgACAENwMgQQAhB0EAIQhBACEJQQAhCkEAIQtBACEMQQAhDUEAIQ5BACEPQQAhEEEAIRFBACESQQAhE0EAIRRBACEVQQAhFgsgBSAHciEHQQAhBQsgBSAIciEIQQAhBQsgBSAJciEJQQAhBQsgBSAKciEKQQAhBQsgBSALciELQQAhBQsgBSAMciEMQQAhBQsgBSANciENQQAhBQsgBSAOciEOQQAhBQsgBSAPciEPQQAhBQsgBSAQciEQQQAhBQsgBSARciERQQAhBQsgBSASciESQQAhBQsgBSATciETQQAhBQsgBSAUciEUQQAhBQsgBEIdiKcQACEVIARCA4anEAAhFiAAIAcgCCAJIAogCyAMIA0gDiAPIBAgESASIBMgFCAVIBYQAyAAIAAoAgAQADYCACAAIAAoAgQQADYCBCAAIAAoAggQADYCCCAAIAAoAgwQADYCDCAAIAAoAhAQADYCECAAIAAoAhQQADYCFCAAIAAoAhgQADYCGCAAIAAoAhwQADYCHAsL")}},function(){return Ct||(0,wt[Object.keys(wt)[0]])((Ct={exports:{}}).exports,Ct),Ct.exports})(),vt=new WebAssembly.Module(Qt);const xt=e,Lt=I,kt="undefined"!=typeof WebAssembly&&(Dt={imports:{debug:{log(...e){console.log(...e.map((e=>(e>>>0).toString(16).padStart(8,"0"))))},log_tee:e=>(console.log((e>>>0).toString(16).padStart(8,"0")),e)}}},new WebAssembly.Instance(vt,Dt).exports);var Dt;let Ut=0;const Kt=[];St.exports=Yt;const Mt=St.exports.SHA256_BYTES=32,Tt=108;function Yt(){if(!(this instanceof Yt))return new Yt;if(!kt)throw new Error("WASM not loaded. Wait for Sha256.ready(cb)");Kt.length||(Kt.push(Ut),Ut+=Tt),this.finalized=!1,this.digestLength=Mt,this.pointer=Kt.pop(),this.pos=0,this._memory=new Uint8Array(kt.memory.buffer),this._memory.fill(0,this.pointer,this.pointer+Tt),this.pointer+this.digestLength>this._memory.length&&this._realloc(this.pointer+Tt)}function Nt(e){if(!(this instanceof Nt))return new Nt(e);this.pad=Lt.alloc(64),this.inner=Yt(),this.outer=Yt();const t=Lt.alloc(32);e.byteLength>64&&(Yt().update(e).digest(t),e=t),this.pad.fill(54);for(let t=0;t<e.byteLength;t++)this.pad[t]^=e[t];this.inner.update(this.pad),this.pad.fill(92);for(let t=0;t<e.byteLength;t++)this.pad[t]^=e[t];this.outer.update(this.pad),this.pad.fill(0),t.fill(0)}function Pt(){}Yt.prototype._realloc=function(e){kt.memory.grow(Math.max(0,Math.ceil(Math.abs(e-this._memory.length)/65536))),this._memory=new Uint8Array(kt.memory.buffer)},Yt.prototype.update=function(e,t){xt(!1===this.finalized,"Hash instance finalized"),Ut%4!=0&&(Ut+=4-Ut%4),xt(Ut%4==0,"input shoud be aligned for int32");const[n,r]=function(e,t){var n=Lt.from(e,t);return[n,n.byteLength]}(e,t);return xt(n instanceof Uint8Array,"input must be Uint8Array or Buffer"),Ut+r>this._memory.length&&this._realloc(Ut+e.length),this._memory.fill(0,Ut,Ut+(r+64-1&-64)-64),this._memory.set(n.subarray(0,64-this.pos),this.pointer+40+this.pos),this._memory.set(n.subarray(64-this.pos),Ut),this.pos=this.pos+r&63,kt.sha256(this.pointer,Ut,r,0),this},Yt.prototype.digest=function(e,t=0){xt(!1===this.finalized,"Hash instance finalized"),this.finalized=!0,Kt.push(this.pointer);const n=this.pointer+40+this.pos;this._memory.fill(0,n,this.pointer+40+64),kt.sha256(this.pointer,Ut,0,1);const r=this._memory.subarray(this.pointer,this.pointer+this.digestLength);if(!e)return r;if("string"==typeof e)return Lt.toString(r,e);xt(e instanceof Uint8Array,"output must be Uint8Array or Buffer"),xt(e.byteLength>=this.digestLength+t,"output must have at least 'SHA256_BYTES' bytes remaining");for(let n=0;n<this.digestLength;n++)e[n+t]=r[n];return e},Yt.WASM=kt,Yt.WASM_SUPPORTED="undefined"!=typeof WebAssembly,Yt.ready=function(e){return e||(e=Pt),kt?(e(),Promise.resolve()):e(new Error("WebAssembly not supported"))},Yt.prototype.ready=Yt.ready,Nt.prototype.update=function(e,t){return this.inner.update(e,t),this},Nt.prototype.digest=function(e,t=0){return this.outer.update(this.inner.digest()),this.outer.digest(e,t)},Yt.HMAC=Nt;var Ot=St.exports;St.exports.HMAC,St.exports.WASM,St.exports.WASM_SUPPORTED,St.exports.ready;var Ft={exports:{}},Ht={exports:{}};const Rt=n,Gt=P;Ht.exports=Wt;const Vt=Ht.exports.SHA256_BYTES=32,qt=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function Jt(e,t,n,r){return((e>>>17|e<<15)^(e>>>19|e<<13)^e>>>10)+t+(((n>>>7|n<<25)^(n>>>18|n<<14)^n>>>3)+r)|0}function jt(e,t){var n,r,i,[s,o,a,h,c,u,l,d]=e;const f=new Uint32Array(64);for(let e=0;e<16;e++)f[e]=Xt(t[e]);for(let e=16;e<64;e++)f[e]=Jt(f[e-2],f[e-7],f[e-15],f[e-16]);for(let e=0;e<64;e+=4)A(e);function A(e){n=s&o^s&a^o&a,r=(s>>>2|s<<30)^(s>>>13|s<<19)^(s>>>22|s<<10),i=d+(c&u^~c&l)+((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))+f[e]+qt[e],d=h+i,n=(h=i+(r+n))&s^h&o^s&o,r=(h>>>2|h<<30)^(h>>>13|h<<19)^(h>>>22|h<<10),i=l+(d&c^~d&u)+((d>>>6|d<<26)^(d>>>11|d<<21)^(d>>>25|d<<7))+f[e+1]+qt[e+1],l=a+i,n=(a=i+(r+n))&h^a&s^h&s,r=(a>>>2|a<<30)^(a>>>13|a<<19)^(a>>>22|a<<10),i=u+(l&d^~l&c)+((l>>>6|l<<26)^(l>>>11|l<<21)^(l>>>25|l<<7))+f[e+2]+qt[e+2],u=o+i,n=(o=i+(r+n))&a^o&h^a&h,r=(o>>>2|o<<30)^(o>>>13|o<<19)^(o>>>22|o<<10),i=c+(u&l^~u&d)+((u>>>6|u<<26)^(u>>>11|u<<21)^(u>>>25|u<<7))+f[e+3]+qt[e+3],c=s+i,s=i+(r+n)}e[0]=e[0]+s,e[1]=e[1]+o,e[2]=e[2]+a,e[3]=e[3]+h,e[4]=e[4]+c,e[5]=e[5]+u,e[6]=e[6]+l,e[7]=e[7]+d}function Wt(){return this instanceof Wt?(this.buffer=new ArrayBuffer(64),this.bytesRead=0,this.pos=0,this.digestLength=Vt,this.finalised=!1,this.load=new Uint8Array(this.buffer),this.words=new Uint32Array(this.buffer),this.state=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),this):new Wt}function zt(e){if(!(this instanceof zt))return new zt(e);this.pad=Gt.alloc(64),this.inner=Wt(),this.outer=Wt();const t=Gt.alloc(32);e.byteLength>64&&(Wt().update(e).digest(t),e=t),this.pad.fill(54);for(let t=0;t<e.byteLength;t++)this.pad[t]^=e[t];this.inner.update(this.pad),this.pad.fill(92);for(let t=0;t<e.byteLength;t++)this.pad[t]^=e[t];this.outer.update(this.pad),this.pad.fill(0),t.fill(0)}function Xt(e){return(16711935&e)>>>8|(16711935&e)<<24|(4278255360&e)<<8|(4278255360&e)>>>24}Wt.prototype.update=function(e,t){Rt(!1===this.finalised,"Hash instance finalised");var[n,r]=function(e,t){var n=Gt.from(e,t);return[n,n.byteLength]}(e,t),i=0;for(this.bytesRead+=r;r>0&&(this.load.set(n.subarray(i,i+64-this.pos),this.pos),i+=64-this.pos,!((r-=64-this.pos)<0));)this.pos=0,jt(this.state,this.words);return this.pos=63&this.bytesRead,this.load.fill(0,this.pos),this},Wt.prototype.digest=function(e,t=0){Rt(!1===this.finalised,"Hash instance finalised"),this.finalised=!0,this.load.fill(0,this.pos),this.load[this.pos]=128,this.pos>55&&(jt(this.state,this.words),this.words.fill(0),this.pos=0);const n=new DataView(this.buffer);n.setUint32(56,this.bytesRead/2**29),n.setUint32(60,this.bytesRead<<3),jt(this.state,this.words);const r=new Uint8Array(this.state.map(Xt).buffer);if(!e)return new Uint8Array(r);if("string"==typeof e)return Gt.toString(r,e);Rt(e instanceof Uint8Array,"input must be Uint8Array or Buffer"),Rt(e.byteLength>=this.digestLength+t,"input not large enough for digest");for(let n=0;n<this.digestLength;n++)e[n+t]=r[n];return e},zt.prototype.update=function(e,t){return this.inner.update(e,t),this},zt.prototype.digest=function(e,t=0){return this.outer.update(this.inner.digest()),this.outer.digest(e,t)},Wt.HMAC=zt;const Zt=Ht.exports,$t=Ot;var en=Zt;Ft.exports=function(){return new en},Ft.exports.ready=function(e){$t.ready((function(){e()}))},Ft.exports.WASM_SUPPORTED=$t.WASM_SUPPORTED,Ft.exports.WASM_LOADED=!1,Ft.exports.SHA256_BYTES=32,$t.ready((function(e){e||(Ft.exports.WASM_LOADED=!0,Ft.exports=en=$t)}));var tn=Ft.exports;const nn=e;var rn=on;const sn=[1634760805,857760878,2036477234,1797285236];function on(e,t,n){nn(32===t.byteLength),nn(8===e.byteLength||12===e.byteLength);const r=new Uint32Array(e.buffer,e.byteOffset,e.byteLength/4),i=new Uint32Array(t.buffer,t.byteOffset,t.byteLength/4);n||(n=0),nn(n<Number.MAX_SAFE_INTEGER),this.finalized=!1,this.pos=0,this.state=new Uint32Array(16);for(let e=0;e<4;e++)this.state[e]=sn[e];for(let e=0;e<8;e++)this.state[4+e]=i[e];return this.state[12]=4294967295&n,8===r.byteLength?(this.state[13]=(n&&0xffffffff00000000)>>32,this.state[14]=r[0],this.state[15]=r[1]):(this.state[13]=r[0],this.state[14]=r[1],this.state[15]=r[2]),this}function an(e){const t=new Uint32Array(16);for(let n=16;n--;)t[n]=e[n];for(let e=0;e<20;e+=2)cn(t,0,4,8,12),cn(t,1,5,9,13),cn(t,2,6,10,14),cn(t,3,7,11,15),cn(t,0,5,10,15),cn(t,1,6,11,12),cn(t,2,7,8,13),cn(t,3,4,9,14);for(let n=0;n<16;n++)t[n]+=e[n];return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}function hn(e,t){return e<<t|e>>>32-t}function cn(e,t,n,r,i){e[t]+=e[n],e[i]^=e[t],e[i]=hn(e[i],16),e[r]+=e[i],e[n]^=e[r],e[n]=hn(e[n],12),e[t]+=e[n],e[i]^=e[t],e[i]=hn(e[i],8),e[r]+=e[i],e[n]^=e[r],e[n]=hn(e[n],7)}on.prototype.update=function(e,t){nn(!this.finalized,"cipher finalized."),nn(e.byteLength>=t.byteLength,"output cannot be shorter than input.");let n=t.length,r=this.pos%64;this.pos+=n;let i=0,s=an(this.state);for(;r>0&&n>0;)e[i]=t[i++]^s[r],r=r+1&63,r||this.state[12]++,n--;for(;n>0;){if(s=an(this.state),n<64){for(let o=0;o<n;o++)e[i]=t[i++]^s[r++],r&=63;return}for(;r<64;)e[i]=t[i++]^s[r++];this.state[12]++,r=0,n-=64}},on.prototype.final=function(){this.state.fill(0),this.pos=0,this.finalized=!0};var un,ln,dn=(()=>{for(var e=new Uint8Array(128),t=0;t<64;t++)e[t<26?t+65:t<52?t+71:t<62?t-4:4*t-205]=t;return t=>{for(var n=t.length,r=new Uint8Array(3*(n-("="==t[n-1])-("="==t[n-2]))/4|0),i=0,s=0;i<n;){var o=e[t.charCodeAt(i++)],a=e[t.charCodeAt(i++)],h=e[t.charCodeAt(i++)],c=e[t.charCodeAt(i++)];r[s++]=o<<2|a>>4,r[s++]=a<<4|h>>2,r[s++]=h<<6|c}return r}})(),fn=(un={"wasm-binary:./siphash24.wat"(e,t){t.exports=dn("AGFzbQEAAAABBgFgAn9/AAMCAQAFBQEBCpBOBxQCBm1lbW9yeQIAB3NpcGhhc2gAAArdCAHaCAIIfgJ/QvXKzYPXrNu38wAhAkLt3pHzlszct+QAIQNC4eSV89bs2bzsACEEQvPK0cunjNmy9AAhBUEIKQMAIQdBECkDACEIIAGtQjiGIQYgAUEHcSELIAAgAWogC2shCiAFIAiFIQUgBCAHhSEEIAMgCIUhAyACIAeFIQICQANAIAAgCkYNASAAKQMAIQkgBSAJhSEFIAIgA3whAiADQg2JIQMgAyAChSEDIAJCIIkhAiAEIAV8IQQgBUIQiSEFIAUgBIUhBSACIAV8IQIgBUIViSEFIAUgAoUhBSAEIAN8IQQgA0IRiSEDIAMgBIUhAyAEQiCJIQQgAiADfCECIANCDYkhAyADIAKFIQMgAkIgiSECIAQgBXwhBCAFQhCJIQUgBSAEhSEFIAIgBXwhAiAFQhWJIQUgBSAChSEFIAQgA3whBCADQhGJIQMgAyAEhSEDIARCIIkhBCACIAmFIQIgAEEIaiEADAALCwJAAkACQAJAAkACQAJAAkAgCw4HBwYFBAMCAQALIAYgADEABkIwhoQhBgsgBiAAMQAFQiiGhCEGCyAGIAAxAARCIIaEIQYLIAYgADEAA0IYhoQhBgsgBiAAMQACQhCGhCEGCyAGIAAxAAFCCIaEIQYLIAYgADEAAIQhBgsgBSAGhSEFIAIgA3whAiADQg2JIQMgAyAChSEDIAJCIIkhAiAEIAV8IQQgBUIQiSEFIAUgBIUhBSACIAV8IQIgBUIViSEFIAUgAoUhBSAEIAN8IQQgA0IRiSEDIAMgBIUhAyAEQiCJIQQgAiADfCECIANCDYkhAyADIAKFIQMgAkIgiSECIAQgBXwhBCAFQhCJIQUgBSAEhSEFIAIgBXwhAiAFQhWJIQUgBSAChSEFIAQgA3whBCADQhGJIQMgAyAEhSEDIARCIIkhBCACIAaFIQIgBEL/AYUhBCACIAN8IQIgA0INiSEDIAMgAoUhAyACQiCJIQIgBCAFfCEEIAVCEIkhBSAFIASFIQUgAiAFfCECIAVCFYkhBSAFIAKFIQUgBCADfCEEIANCEYkhAyADIASFIQMgBEIgiSEEIAIgA3whAiADQg2JIQMgAyAChSEDIAJCIIkhAiAEIAV8IQQgBUIQiSEFIAUgBIUhBSACIAV8IQIgBUIViSEFIAUgAoUhBSAEIAN8IQQgA0IRiSEDIAMgBIUhAyAEQiCJIQQgAiADfCECIANCDYkhAyADIAKFIQMgAkIgiSECIAQgBXwhBCAFQhCJIQUgBSAEhSEFIAIgBXwhAiAFQhWJIQUgBSAChSEFIAQgA3whBCADQhGJIQMgAyAEhSEDIARCIIkhBCACIAN8IQIgA0INiSEDIAMgAoUhAyACQiCJIQIgBCAFfCEEIAVCEIkhBSAFIASFIQUgAiAFfCECIAVCFYkhBSAFIAKFIQUgBCADfCEEIANCEYkhAyADIASFIQMgBEIgiSEEQQAgAiADIAQgBYWFhTcDAAs=")}},function(){return ln||(0,un[Object.keys(un)[0]])((ln={exports:{}}).exports,ln),ln.exports})(),An=new WebAssembly.Module(fn);function gn(e,t){var n=e.l+t.l,r={h:e.h+t.h+(n/2>>>31)>>>0,l:n>>>0};e.h=r.h,e.l=r.l}function pn(e,t){e.h^=t.h,e.h>>>=0,e.l^=t.l,e.l>>>=0}function yn(e,t){var n={h:e.h<<t|e.l>>>32-t,l:e.l<<t|e.h>>>32-t};e.h=n.h,e.l=n.l}function _n(e){var t=e.l;e.l=e.h,e.h=t}function bn(e,t,n,r){gn(e,t),gn(n,r),yn(t,13),yn(r,16),pn(t,e),pn(r,n),_n(e),gn(n,t),gn(e,r),yn(t,17),yn(r,21),pn(t,n),pn(r,e),_n(n)}function In(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]}var En=e,mn="undefined"!=typeof WebAssembly&&new WebAssembly.Instance(An,undefined).exports,wn=function(e,t,n){var r,i={h:In(n,4),l:In(n,0)},s={h:In(n,12),l:In(n,8)},o={h:i.h,l:i.l},a=i,h={h:s.h,l:s.l},c=s,u=0,l=t.length,d=l-7,f=new Uint8Array(new ArrayBuffer(8));for(pn(o,{h:1936682341,l:1886610805}),pn(h,{h:1685025377,l:1852075885}),pn(a,{h:1819895653,l:1852142177}),pn(c,{h:1952801890,l:2037671283});u<d;)pn(c,r={h:In(t,u+4),l:In(t,u)}),bn(o,h,a,c),bn(o,h,a,c),pn(o,r),u+=8;f[7]=l;for(var A=0;u<l;)f[A++]=t[u++];for(;A<7;)f[A++]=0;pn(c,r={h:f[7]<<24|f[6]<<16|f[5]<<8|f[4],l:f[3]<<24|f[2]<<16|f[1]<<8|f[0]}),bn(o,h,a,c),bn(o,h,a,c),pn(o,r),pn(a,{h:0,l:255}),bn(o,h,a,c),bn(o,h,a,c),bn(o,h,a,c),bn(o,h,a,c);var g=o;pn(g,h),pn(g,a),pn(g,c),e[0]=255&g.l,e[1]=g.l>>8&255,e[2]=g.l>>16&255,e[3]=g.l>>24&255,e[4]=255&g.h,e[5]=g.h>>8&255,e[6]=g.h>>16&255,e[7]=g.h>>24&255},Cn=vn,Sn=vn.BYTES=8,Bn=vn.KEYBYTES=16;vn.WASM_SUPPORTED=!!mn,vn.WASM_LOADED=!!mn;var Qn=new Uint8Array(mn?mn.memory.buffer:0);function vn(e,t,n,r){var i;return n||(n=new Uint8Array(8)),!0!==r&&(En(n.length>=Sn,"output must be at least "+Sn),En(t.length>=Bn,"key must be at least "+Bn)),mn?(e.length+24>Qn.length&&(i=e.length+24,mn.memory.grow(Math.max(0,Math.ceil(Math.abs(i-Qn.length)/65536))),Qn=new Uint8Array(mn.memory.buffer)),Qn.set(t,8),Qn.set(e,24),mn.siphash(24,e.length),n.set(Qn.subarray(0,8))):wn(n,e,t),n}function xn(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Ln,kn={exports:{}},Dn={exports:{}};function Un(e){e.fill(0)}!function(t){var n,r=e,i=(n=globalThis.crypto||globalThis.msCrypto)&&n.getRandomValues?function(e,t){for(let r=0;r<t;r+=65536)n.getRandomValues(new Uint8Array(e.buffer,r+e.byteOffset,Math.min(t-r,65536)))}:null!=xn&&(n=xn("crypto"))&&n.randomBytes?function(e,t){new Uint8Array(e.buffer,e.byteOffset,t).set(n.randomBytes(t))}:function(){throw new Error("No secure random number generator available")};Object.defineProperty(t.exports,"randombytes",{value:i}),t.exports.randombytes_buf=function(e){r(e,"out must be given"),i(e,e.byteLength)}}(Dn);var Kn={sodium_malloc:function(e){return new Uint8Array(e)},sodium_free:function(e){Un(e),function(){if(Ln)return Ln;var e=globalThis.MessageChannel;return null==e&&({MessageChannel:e}=xn("worker_threads")),Ln=new e}().port1.postMessage(e.buffer,[e.buffer])},sodium_memzero:Un},Mn={exports:{}};!function(e){function t(e,t,n,r,i){var s=0;for(let o=0;o<i;o++)s|=e[t+o]^n[r+o];return(1&s-1>>>8)-1}e.exports={crypto_verify_16:function(e,n,r,i){return 0===t(e,n,r,i,16)},crypto_verify_32:function(e,n,r,i){return 0===t(e,n,r,i,32)},crypto_verify_64:function(e,n,r,i){return 0===t(e,n,r,i,64)}},Object.defineProperty(e.exports,"vn",{value:t})}(Mn);const Tn=e,{vn:Yn}=Mn.exports;var Nn={sodium_increment:function(e){const t=e.byteLength;for(var n=1,r=0;r<t;r++)n+=e[r],e[r]=n,n>>=8},sodium_memcmp:function(e,t){return Tn(e.byteLength===t.byteLength,"buffers must be the same size"),0===Yn(e,0,t,0,e.byteLength)},sodium_is_zero:function(e){var t=0;for(let n=0;n<e.length;n++)t|=e[n];return 0===t}};const{crypto_verify_32:Pn}=Mn.exports,On=ye,Fn=e;var Hn={crypto_auth_BYTES:32,crypto_auth_KEYBYTES:32,crypto_auth:function(e,t,n){Fn(32===e.byteLength,"out should be 'crypto_auth_BYTES' in length"),Fn(32===n.byteLength,"key should be 'crypto_auth_KEYBYTES' in length");const r=new Uint8Array(64),i=On.HMAC(n);i.update(t),i.digest(r),e.set(r.subarray(0,32))},crypto_auth_verify:function(e,t,n){Fn(32===e.byteLength,"h should be 'crypto_auth_BYTES' in length"),Fn(32===n.byteLength,"key should be 'crypto_auth_KEYBYTES' in length");const r=On.HMAC(n).update(t).digest();return Pn(e,0,r,0)}};const Rn=ye,Gn=e;if(1!==new Uint16Array([1])[0])throw new Error("Big endian architecture is not supported.");function Vn(e,t,n){return Gn(64===e.byteLength,"out must be 'crypto_hash_sha512_BYTES' bytes long"),Rn().update(t.subarray(0,n)).digest(e),0}var qn={crypto_hash:function(e,t,n){return Vn(e,t,n)},crypto_hash_sha512:Vn,crypto_hash_sha512_BYTES:64,crypto_hash_BYTES:64};if(1!==new Uint16Array([1])[0])throw new Error("Big endian architecture is not supported.");var Jn=function(e){var t,n=new Float64Array(16);if(e)for(t=0;t<e.length;t++)n[t]=e[t];return n},jn=new Uint8Array(32);jn[0]=9;var Wn=Jn(),zn=Jn([1]),Xn=Jn([56129,1]),Zn=Jn([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),$n=Jn([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),er=Jn([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),tr=Jn([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),nr=Jn([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function rr(e,t,n){var r,i,s=0,o=0,a=0,h=0,c=0,u=0,l=0,d=0,f=0,A=0,g=0,p=0,y=0,_=0,b=0,I=0,E=0,m=0,w=0,C=0,S=0,B=0,Q=0,v=0,x=0,L=0,k=0,D=0,U=0,K=0,M=0,T=n[0],Y=n[1],N=n[2],P=n[3],O=n[4],F=n[5],H=n[6],R=n[7],G=n[8],V=n[9],q=n[10],J=n[11],j=n[12],W=n[13],z=n[14],X=n[15];s+=(r=t[0])*T,o+=r*Y,a+=r*N,h+=r*P,c+=r*O,u+=r*F,l+=r*H,d+=r*R,f+=r*G,A+=r*V,g+=r*q,p+=r*J,y+=r*j,_+=r*W,b+=r*z,I+=r*X,o+=(r=t[1])*T,a+=r*Y,h+=r*N,c+=r*P,u+=r*O,l+=r*F,d+=r*H,f+=r*R,A+=r*G,g+=r*V,p+=r*q,y+=r*J,_+=r*j,b+=r*W,I+=r*z,E+=r*X,a+=(r=t[2])*T,h+=r*Y,c+=r*N,u+=r*P,l+=r*O,d+=r*F,f+=r*H,A+=r*R,g+=r*G,p+=r*V,y+=r*q,_+=r*J,b+=r*j,I+=r*W,E+=r*z,m+=r*X,h+=(r=t[3])*T,c+=r*Y,u+=r*N,l+=r*P,d+=r*O,f+=r*F,A+=r*H,g+=r*R,p+=r*G,y+=r*V,_+=r*q,b+=r*J,I+=r*j,E+=r*W,m+=r*z,w+=r*X,c+=(r=t[4])*T,u+=r*Y,l+=r*N,d+=r*P,f+=r*O,A+=r*F,g+=r*H,p+=r*R,y+=r*G,_+=r*V,b+=r*q,I+=r*J,E+=r*j,m+=r*W,w+=r*z,C+=r*X,u+=(r=t[5])*T,l+=r*Y,d+=r*N,f+=r*P,A+=r*O,g+=r*F,p+=r*H,y+=r*R,_+=r*G,b+=r*V,I+=r*q,E+=r*J,m+=r*j,w+=r*W,C+=r*z,S+=r*X,l+=(r=t[6])*T,d+=r*Y,f+=r*N,A+=r*P,g+=r*O,p+=r*F,y+=r*H,_+=r*R,b+=r*G,I+=r*V,E+=r*q,m+=r*J,w+=r*j,C+=r*W,S+=r*z,B+=r*X,d+=(r=t[7])*T,f+=r*Y,A+=r*N,g+=r*P,p+=r*O,y+=r*F,_+=r*H,b+=r*R,I+=r*G,E+=r*V,m+=r*q,w+=r*J,C+=r*j,S+=r*W,B+=r*z,Q+=r*X,f+=(r=t[8])*T,A+=r*Y,g+=r*N,p+=r*P,y+=r*O,_+=r*F,b+=r*H,I+=r*R,E+=r*G,m+=r*V,w+=r*q,C+=r*J,S+=r*j,B+=r*W,Q+=r*z,v+=r*X,A+=(r=t[9])*T,g+=r*Y,p+=r*N,y+=r*P,_+=r*O,b+=r*F,I+=r*H,E+=r*R,m+=r*G,w+=r*V,C+=r*q,S+=r*J,B+=r*j,Q+=r*W,v+=r*z,x+=r*X,g+=(r=t[10])*T,p+=r*Y,y+=r*N,_+=r*P,b+=r*O,I+=r*F,E+=r*H,m+=r*R,w+=r*G,C+=r*V,S+=r*q,B+=r*J,Q+=r*j,v+=r*W,x+=r*z,L+=r*X,p+=(r=t[11])*T,y+=r*Y,_+=r*N,b+=r*P,I+=r*O,E+=r*F,m+=r*H,w+=r*R,C+=r*G,S+=r*V,B+=r*q,Q+=r*J,v+=r*j,x+=r*W,L+=r*z,k+=r*X,y+=(r=t[12])*T,_+=r*Y,b+=r*N,I+=r*P,E+=r*O,m+=r*F,w+=r*H,C+=r*R,S+=r*G,B+=r*V,Q+=r*q,v+=r*J,x+=r*j,L+=r*W,k+=r*z,D+=r*X,_+=(r=t[13])*T,b+=r*Y,I+=r*N,E+=r*P,m+=r*O,w+=r*F,C+=r*H,S+=r*R,B+=r*G,Q+=r*V,v+=r*q,x+=r*J,L+=r*j,k+=r*W,D+=r*z,U+=r*X,b+=(r=t[14])*T,I+=r*Y,E+=r*N,m+=r*P,w+=r*O,C+=r*F,S+=r*H,B+=r*R,Q+=r*G,v+=r*V,x+=r*q,L+=r*J,k+=r*j,D+=r*W,U+=r*z,K+=r*X,I+=(r=t[15])*T,o+=38*(m+=r*N),a+=38*(w+=r*P),h+=38*(C+=r*O),c+=38*(S+=r*F),u+=38*(B+=r*H),l+=38*(Q+=r*R),d+=38*(v+=r*G),f+=38*(x+=r*V),A+=38*(L+=r*q),g+=38*(k+=r*J),p+=38*(D+=r*j),y+=38*(U+=r*W),_+=38*(K+=r*z),b+=38*(M+=r*X),s=(r=(s+=38*(E+=r*Y))+(i=1)+65535)-65536*(i=Math.floor(r/65536)),o=(r=o+i+65535)-65536*(i=Math.floor(r/65536)),a=(r=a+i+65535)-65536*(i=Math.floor(r/65536)),h=(r=h+i+65535)-65536*(i=Math.floor(r/65536)),c=(r=c+i+65535)-65536*(i=Math.floor(r/65536)),u=(r=u+i+65535)-65536*(i=Math.floor(r/65536)),l=(r=l+i+65535)-65536*(i=Math.floor(r/65536)),d=(r=d+i+65535)-65536*(i=Math.floor(r/65536)),f=(r=f+i+65535)-65536*(i=Math.floor(r/65536)),A=(r=A+i+65535)-65536*(i=Math.floor(r/65536)),g=(r=g+i+65535)-65536*(i=Math.floor(r/65536)),p=(r=p+i+65535)-65536*(i=Math.floor(r/65536)),y=(r=y+i+65535)-65536*(i=Math.floor(r/65536)),_=(r=_+i+65535)-65536*(i=Math.floor(r/65536)),b=(r=b+i+65535)-65536*(i=Math.floor(r/65536)),I=(r=I+i+65535)-65536*(i=Math.floor(r/65536)),s=(r=(s+=i-1+37*(i-1))+(i=1)+65535)-65536*(i=Math.floor(r/65536)),o=(r=o+i+65535)-65536*(i=Math.floor(r/65536)),a=(r=a+i+65535)-65536*(i=Math.floor(r/65536)),h=(r=h+i+65535)-65536*(i=Math.floor(r/65536)),c=(r=c+i+65535)-65536*(i=Math.floor(r/65536)),u=(r=u+i+65535)-65536*(i=Math.floor(r/65536)),l=(r=l+i+65535)-65536*(i=Math.floor(r/65536)),d=(r=d+i+65535)-65536*(i=Math.floor(r/65536)),f=(r=f+i+65535)-65536*(i=Math.floor(r/65536)),A=(r=A+i+65535)-65536*(i=Math.floor(r/65536)),g=(r=g+i+65535)-65536*(i=Math.floor(r/65536)),p=(r=p+i+65535)-65536*(i=Math.floor(r/65536)),y=(r=y+i+65535)-65536*(i=Math.floor(r/65536)),_=(r=_+i+65535)-65536*(i=Math.floor(r/65536)),b=(r=b+i+65535)-65536*(i=Math.floor(r/65536)),I=(r=I+i+65535)-65536*(i=Math.floor(r/65536)),s+=i-1+37*(i-1),e[0]=s,e[1]=o,e[2]=a,e[3]=h,e[4]=c,e[5]=u,e[6]=l,e[7]=d,e[8]=f,e[9]=A,e[10]=g,e[11]=p,e[12]=y,e[13]=_,e[14]=b,e[15]=I}function ir(e,t){rr(e,t,t)}function sr(e,t,n){for(var r,i=~(n-1),s=0;s<16;s++)r=i&(e[s]^t[s]),e[s]^=r,t[s]^=r}function or(e){var t,n,r=1;for(t=0;t<16;t++)n=e[t]+r+65535,r=Math.floor(n/65536),e[t]=n-65536*r;e[0]+=r-1+37*(r-1)}var ar={gf:Jn,A:function(e,t,n){for(var r=0;r<16;r++)e[r]=t[r]+n[r]},Z:function(e,t,n){for(var r=0;r<16;r++)e[r]=t[r]-n[r]},M:rr,S:ir,sel25519:sr,pack25519:function(e,t){var n,r,i,s=Jn(),o=Jn();for(n=0;n<16;n++)o[n]=t[n];for(or(o),or(o),or(o),r=0;r<2;r++){for(s[0]=o[0]-65517,n=1;n<15;n++)s[n]=o[n]-65535-(s[n-1]>>16&1),s[n-1]&=65535;s[15]=o[15]-32767-(s[14]>>16&1),i=s[15]>>16&1,s[14]&=65535,sr(o,s,1-i)}for(n=0;n<16;n++)e[2*n]=255&o[n],e[2*n+1]=o[n]>>8},unpack25519:function(e,t){var n;for(n=0;n<16;n++)e[n]=t[2*n]+(t[2*n+1]<<8);e[15]&=32767},inv25519:function(e,t){var n,r=Jn();for(n=0;n<16;n++)r[n]=t[n];for(n=253;n>=0;n--)ir(r,r),2!==n&&4!==n&&rr(r,r,t);for(n=0;n<16;n++)e[n]=r[n]},gf0:Wn,gf1:zn,_9:jn,_121665:Xn,D:Zn,D2:$n,X:er,Y:tr,I:nr};const{_9:hr,_121665:cr,gf:ur,inv25519:lr,pack25519:dr,unpack25519:fr,sel25519:Ar,A:gr,M:pr,Z:yr,S:_r}=ar;var br={crypto_scalarmult:Ir,crypto_scalarmult_base:function(e,t){return Ir(e,t,hr)},crypto_scalarmult_BYTES:32,crypto_scalarmult_SCALARBYTES:32};function Ir(e,t,n){Er(e,32),Er(t,32),Er(n,32);var r,i,s=new Uint8Array(32),o=new Float64Array(80),a=ur(),h=ur(),c=ur(),u=ur(),l=ur(),d=ur();for(i=0;i<31;i++)s[i]=t[i];for(s[31]=127&t[31]|64,s[0]&=248,fr(o,n),i=0;i<16;i++)h[i]=o[i],u[i]=a[i]=c[i]=0;for(a[0]=u[0]=1,i=254;i>=0;--i)r=s[i>>>3]>>>(7&i)&1,Ar(a,h,r),Ar(c,u,r),gr(l,a,c),yr(a,a,c),gr(c,h,u),yr(h,h,u),_r(u,l),_r(d,a),pr(a,c,a),pr(c,h,l),gr(l,a,c),yr(a,a,c),_r(h,a),yr(c,u,d),pr(a,c,cr),gr(a,a,u),pr(c,c,a),pr(a,u,d),pr(u,h,o),_r(h,l),Ar(a,h,r),Ar(c,u,r);for(i=0;i<16;i++)o[i+16]=a[i],o[i+32]=c[i],o[i+48]=h[i],o[i+64]=u[i];var f=o.subarray(32),A=o.subarray(16);return lr(f,f),pr(A,A,f),dr(e,A),0}function Er(e,t){if(!e||e.length<t)throw new Error("Argument must be a buffer of length "+t)}var mr={exports:{}};!function(e){var t=ht;if(1!==new Uint16Array([1])[0])throw new Error("Big endian architecture is not supported.");e.exports.crypto_generichash_PRIMITIVE="blake2b",e.exports.crypto_generichash_BYTES_MIN=t.BYTES_MIN,e.exports.crypto_generichash_BYTES_MAX=t.BYTES_MAX,e.exports.crypto_generichash_BYTES=t.BYTES,e.exports.crypto_generichash_KEYBYTES_MIN=t.KEYBYTES_MIN,e.exports.crypto_generichash_KEYBYTES_MAX=t.KEYBYTES_MAX,e.exports.crypto_generichash_KEYBYTES=t.KEYBYTES,e.exports.crypto_generichash_WASM_SUPPORTED=t.WASM_SUPPORTED,e.exports.crypto_generichash_WASM_LOADED=!1,e.exports.crypto_generichash=function(e,n,r){t(e.length,r).update(n).final(e)},e.exports.crypto_generichash_ready=t.ready,e.exports.crypto_generichash_batch=function(e,n,r){for(var i=t(e.length,r),s=0;s<n.length;s++)i.update(n[s]);i.final(e)},e.exports.crypto_generichash_instance=function(n,r){return null==r&&(r=e.exports.crypto_generichash_BYTES),t(r,n)},t.ready((function(n){e.exports.crypto_generichash_WASM_LOADED=t.WASM_LOADED}))}(mr);var wr={};if(function(e){const t=yt;if(1!==new Uint16Array([1])[0])throw new Error("Big endian architecture is not supported.");function n(e,n){this._instance=t(e,n)}e.crypto_stream_KEYBYTES=32,e.crypto_stream_NONCEBYTES=24,e.crypto_stream_PRIMITIVE="xsalsa20",e.crypto_stream_xsalsa20_MESSAGEBYTES_MAX=Number.MAX_SAFE_INTEGER,e.crypto_stream=function(t,n,r){t.fill(0),e.crypto_stream_xor(t,t,n,r)},e.crypto_stream_xor=function(e,n,r,i){const s=t(r,i);s.update(n,e),s.final()},e.crypto_stream_xor_instance=function(e,t){return new n(e,t)},n.prototype.update=function(e,t){this._instance.update(t,e)},n.prototype.final=function(){this._instance.finalize(),this._instance=null}}(wr),1!==new Uint16Array([1])[0])throw new Error("Big endian architecture is not supported.");var Cr=function(e){var t,n,r,i,s,o,a,h;this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0,t=255&e[0]|(255&e[1])<<8,this.r[0]=8191&t,n=255&e[2]|(255&e[3])<<8,this.r[1]=8191&(t>>>13|n<<3),r=255&e[4]|(255&e[5])<<8,this.r[2]=7939&(n>>>10|r<<6),i=255&e[6]|(255&e[7])<<8,this.r[3]=8191&(r>>>7|i<<9),s=255&e[8]|(255&e[9])<<8,this.r[4]=255&(i>>>4|s<<12),this.r[5]=s>>>1&8190,o=255&e[10]|(255&e[11])<<8,this.r[6]=8191&(s>>>14|o<<2),a=255&e[12]|(255&e[13])<<8,this.r[7]=8065&(o>>>11|a<<5),h=255&e[14]|(255&e[15])<<8,this.r[8]=8191&(a>>>8|h<<8),this.r[9]=h>>>5&127,this.pad[0]=255&e[16]|(255&e[17])<<8,this.pad[1]=255&e[18]|(255&e[19])<<8,this.pad[2]=255&e[20]|(255&e[21])<<8,this.pad[3]=255&e[22]|(255&e[23])<<8,this.pad[4]=255&e[24]|(255&e[25])<<8,this.pad[5]=255&e[26]|(255&e[27])<<8,this.pad[6]=255&e[28]|(255&e[29])<<8,this.pad[7]=255&e[30]|(255&e[31])<<8};Cr.prototype.blocks=function(e,t,n){for(var r,i,s,o,a,h,c,u,l,d,f,A,g,p,y,_,b,I,E,m=this.fin?0:2048,w=this.h[0],C=this.h[1],S=this.h[2],B=this.h[3],Q=this.h[4],v=this.h[5],x=this.h[6],L=this.h[7],k=this.h[8],D=this.h[9],U=this.r[0],K=this.r[1],M=this.r[2],T=this.r[3],Y=this.r[4],N=this.r[5],P=this.r[6],O=this.r[7],F=this.r[8],H=this.r[9];n>=16;)d=l=0,d+=(w+=8191&(r=255&e[t+0]|(255&e[t+1])<<8))*U,d+=(C+=8191&(r>>>13|(i=255&e[t+2]|(255&e[t+3])<<8)<<3))*(5*H),d+=(S+=8191&(i>>>10|(s=255&e[t+4]|(255&e[t+5])<<8)<<6))*(5*F),d+=(B+=8191&(s>>>7|(o=255&e[t+6]|(255&e[t+7])<<8)<<9))*(5*O),l=(d+=(Q+=8191&(o>>>4|(a=255&e[t+8]|(255&e[t+9])<<8)<<12))*(5*P))>>>13,d&=8191,d+=(v+=a>>>1&8191)*(5*N),d+=(x+=8191&(a>>>14|(h=255&e[t+10]|(255&e[t+11])<<8)<<2))*(5*Y),d+=(L+=8191&(h>>>11|(c=255&e[t+12]|(255&e[t+13])<<8)<<5))*(5*T),d+=(k+=8191&(c>>>8|(u=255&e[t+14]|(255&e[t+15])<<8)<<8))*(5*M),f=l+=(d+=(D+=u>>>5|m)*(5*K))>>>13,f+=w*K,f+=C*U,f+=S*(5*H),f+=B*(5*F),l=(f+=Q*(5*O))>>>13,f&=8191,f+=v*(5*P),f+=x*(5*N),f+=L*(5*Y),f+=k*(5*T),l+=(f+=D*(5*M))>>>13,f&=8191,A=l,A+=w*M,A+=C*K,A+=S*U,A+=B*(5*H),l=(A+=Q*(5*F))>>>13,A&=8191,A+=v*(5*O),A+=x*(5*P),A+=L*(5*N),A+=k*(5*Y),g=l+=(A+=D*(5*T))>>>13,g+=w*T,g+=C*M,g+=S*K,g+=B*U,l=(g+=Q*(5*H))>>>13,g&=8191,g+=v*(5*F),g+=x*(5*O),g+=L*(5*P),g+=k*(5*N),p=l+=(g+=D*(5*Y))>>>13,p+=w*Y,p+=C*T,p+=S*M,p+=B*K,l=(p+=Q*U)>>>13,p&=8191,p+=v*(5*H),p+=x*(5*F),p+=L*(5*O),p+=k*(5*P),y=l+=(p+=D*(5*N))>>>13,y+=w*N,y+=C*Y,y+=S*T,y+=B*M,l=(y+=Q*K)>>>13,y&=8191,y+=v*U,y+=x*(5*H),y+=L*(5*F),y+=k*(5*O),_=l+=(y+=D*(5*P))>>>13,_+=w*P,_+=C*N,_+=S*Y,_+=B*T,l=(_+=Q*M)>>>13,_&=8191,_+=v*K,_+=x*U,_+=L*(5*H),_+=k*(5*F),b=l+=(_+=D*(5*O))>>>13,b+=w*O,b+=C*P,b+=S*N,b+=B*Y,l=(b+=Q*T)>>>13,b&=8191,b+=v*M,b+=x*K,b+=L*U,b+=k*(5*H),I=l+=(b+=D*(5*F))>>>13,I+=w*F,I+=C*O,I+=S*P,I+=B*N,l=(I+=Q*Y)>>>13,I&=8191,I+=v*T,I+=x*M,I+=L*K,I+=k*U,E=l+=(I+=D*(5*H))>>>13,E+=w*H,E+=C*F,E+=S*O,E+=B*P,l=(E+=Q*N)>>>13,E&=8191,E+=v*Y,E+=x*T,E+=L*M,E+=k*K,w=d=8191&(l=(l=((l+=(E+=D*U)>>>13)<<2)+l|0)+(d&=8191)|0),C=f+=l>>>=13,S=A&=8191,B=g&=8191,Q=p&=8191,v=y&=8191,x=_&=8191,L=b&=8191,k=I&=8191,D=E&=8191,t+=16,n-=16;this.h[0]=w,this.h[1]=C,this.h[2]=S,this.h[3]=B,this.h[4]=Q,this.h[5]=v,this.h[6]=x,this.h[7]=L,this.h[8]=k,this.h[9]=D},Cr.prototype.finish=function(e,t){var n,r,i,s,o=new Uint16Array(10);if(this.leftover){for(s=this.leftover,this.buffer[s++]=1;s<16;s++)this.buffer[s]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(n=this.h[1]>>>13,this.h[1]&=8191,s=2;s<10;s++)this.h[s]+=n,n=this.h[s]>>>13,this.h[s]&=8191;for(this.h[0]+=5*n,n=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=n,n=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=n,o[0]=this.h[0]+5,n=o[0]>>>13,o[0]&=8191,s=1;s<10;s++)o[s]=this.h[s]+n,n=o[s]>>>13,o[s]&=8191;for(o[9]-=8192,r=(1^n)-1,s=0;s<10;s++)o[s]&=r;for(r=~r,s=0;s<10;s++)this.h[s]=this.h[s]&r|o[s];for(this.h[0]=65535&(this.h[0]|this.h[1]<<13),this.h[1]=65535&(this.h[1]>>>3|this.h[2]<<10),this.h[2]=65535&(this.h[2]>>>6|this.h[3]<<7),this.h[3]=65535&(this.h[3]>>>9|this.h[4]<<4),this.h[4]=65535&(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14),this.h[5]=65535&(this.h[6]>>>2|this.h[7]<<11),this.h[6]=65535&(this.h[7]>>>5|this.h[8]<<8),this.h[7]=65535&(this.h[8]>>>8|this.h[9]<<5),i=this.h[0]+this.pad[0],this.h[0]=65535&i,s=1;s<8;s++)i=(this.h[s]+this.pad[s]|0)+(i>>>16)|0,this.h[s]=65535&i;e[t+0]=this.h[0]>>>0&255,e[t+1]=this.h[0]>>>8&255,e[t+2]=this.h[1]>>>0&255,e[t+3]=this.h[1]>>>8&255,e[t+4]=this.h[2]>>>0&255,e[t+5]=this.h[2]>>>8&255,e[t+6]=this.h[3]>>>0&255,e[t+7]=this.h[3]>>>8&255,e[t+8]=this.h[4]>>>0&255,e[t+9]=this.h[4]>>>8&255,e[t+10]=this.h[5]>>>0&255,e[t+11]=this.h[5]>>>8&255,e[t+12]=this.h[6]>>>0&255,e[t+13]=this.h[6]>>>8&255,e[t+14]=this.h[7]>>>0&255,e[t+15]=this.h[7]>>>8&255},Cr.prototype.update=function(e,t,n){var r,i;if(this.leftover){for((i=16-this.leftover)>n&&(i=n),r=0;r<i;r++)this.buffer[this.leftover+r]=e[t+r];if(n-=i,t+=i,this.leftover+=i,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(n>=16&&(i=n-n%16,this.blocks(e,t,i),t+=i,n-=i),n){for(r=0;r<n;r++)this.buffer[this.leftover+r]=e[t+r];this.leftover+=n}};var Sr=Cr;const Br=e,Qr=Sr,{crypto_verify_16:vr}=Mn.exports;var xr={crypto_onetimeauth:Lr,crypto_onetimeauth_verify:function(e,t,n){Br(16===e.byteLength,"mac must be 'crypto_onetimeauth_BYTES' bytes"),Br(null!=t.byteLength,"msg must be buffer"),Br(32===n.byteLength,"key must be 'crypto_onetimeauth_KEYBYTES' bytes");var r=new Uint8Array(16);return Lr(r,t,n),vr(e,0,r,0)},crypto_onetimeauth_BYTES:16,crypto_onetimeauth_KEYBYTES:32,crypto_onetimeauth_PRIMITIVE:"poly1305"};function Lr(e,t,n){Br(16===e.byteLength,"mac must be 'crypto_onetimeauth_BYTES' bytes"),Br(null!=t.byteLength,"msg must be buffer"),Br(32===n.byteLength,"key must be 'crypto_onetimeauth_KEYBYTES' bytes");var r=new Qr(n);r.update(t,0,t.byteLength),r.finish(e,0)}const kr=e,{crypto_stream:Dr,crypto_stream_xor:Ur}=wr,{crypto_onetimeauth:Kr,crypto_onetimeauth_verify:Mr,crypto_onetimeauth_BYTES:Tr,crypto_onetimeauth_KEYBYTES:Yr}=xr,Nr=32,Pr=24,Or=32,Fr=16;var Hr={crypto_secretbox:Rr,crypto_secretbox_open:Gr,crypto_secretbox_detached:function(e,t,n,r,i){kr(e.byteLength===n.byteLength,"o must be 'msg.byteLength' bytes"),kr(16===t.byteLength,"mac must be 'crypto_secretbox_MACBYTES' bytes"),kr(r.byteLength===Pr,"n must be 'crypto_secretbox_NONCEBYTES' bytes"),kr(i.byteLength===Nr,"k must be 'crypto_secretbox_KEYBYTES' bytes");const s=new Uint8Array(n.byteLength+t.byteLength);return Vr(s,n,r,i),t.set(s.subarray(0,t.byteLength)),e.set(s.subarray(t.byteLength)),!0},crypto_secretbox_open_detached:function(e,t,n,r,i){kr(t.byteLength===e.byteLength,"o must be 'msg.byteLength' bytes"),kr(16===n.byteLength,"mac must be 'crypto_secretbox_MACBYTES' bytes"),kr(r.byteLength===Pr,"n must be 'crypto_secretbox_NONCEBYTES' bytes"),kr(i.byteLength===Nr,"k must be 'crypto_secretbox_KEYBYTES' bytes");const s=new Uint8Array(t.byteLength+n.byteLength);return s.set(n),s.set(t,n.byteLength),qr(e,s,r,i)},crypto_secretbox_easy:Vr,crypto_secretbox_open_easy:qr,crypto_secretbox_KEYBYTES:Nr,crypto_secretbox_NONCEBYTES:Pr,crypto_secretbox_ZEROBYTES:Or,crypto_secretbox_BOXZEROBYTES:Fr,crypto_secretbox_MACBYTES:16};function Rr(e,t,n,r){kr(e.byteLength===t.byteLength,"c must be 'm.byteLength' bytes");const i=t.byteLength;kr(i>=Or,"mlen must be at least 'crypto_secretbox_ZEROBYTES'"),kr(n.byteLength===Pr,"n must be 'crypto_secretbox_NONCEBYTES' bytes"),kr(r.byteLength===Nr,"k must be 'crypto_secretbox_KEYBYTES' bytes"),Ur(e,t,n,r),Kr(e.subarray(Fr,Fr+Tr),e.subarray(Fr+Tr,e.byteLength),e.subarray(0,Yr)),e.fill(0,0,Fr)}function Gr(e,t,n,r){kr(t.byteLength===e.byteLength,"c must be 'm.byteLength' bytes");const i=e.byteLength;kr(i>=Or,"mlen must be at least 'crypto_secretbox_ZEROBYTES'"),kr(n.byteLength===Pr,"n must be 'crypto_secretbox_NONCEBYTES' bytes"),kr(r.byteLength===Nr,"k must be 'crypto_secretbox_KEYBYTES' bytes");const s=new Uint8Array(Yr);return Dr(s,n,r),!1!==Mr(t.subarray(Fr,Fr+Tr),t.subarray(Fr+Tr,t.byteLength),s)&&(Ur(e,t,n,r),e.fill(0,0,32),!0)}function Vr(e,t,n,r){kr(e.byteLength===t.byteLength+16,"o must be 'msg.byteLength + crypto_secretbox_MACBYTES' bytes"),kr(n.byteLength===Pr,"n must be 'crypto_secretbox_NONCEBYTES' bytes"),kr(r.byteLength===Nr,"k must be 'crypto_secretbox_KEYBYTES' bytes");const i=new Uint8Array(Or+t.byteLength),s=new Uint8Array(i.byteLength);i.set(t,Or),Rr(s,i,n,r),e.set(s.subarray(Fr))}function qr(e,t,n,r){kr(t.byteLength===e.byteLength+16,"box must be 'msg.byteLength + crypto_secretbox_MACBYTES' bytes"),kr(n.byteLength===Pr,"n must be 'crypto_secretbox_NONCEBYTES' bytes"),kr(r.byteLength===Nr,"k must be 'crypto_secretbox_KEYBYTES' bytes");const i=new Uint8Array(Fr+t.byteLength),s=new Uint8Array(i.byteLength);return i.set(t,Fr),!1!==Gr(s,i,n,r)&&(e.set(s.subarray(Or)),!0)}const{crypto_hash_sha512:Jr}=qn,{crypto_scalarmult:jr,crypto_scalarmult_base:Wr}=br,{randombytes:zr}=Dn.exports,{crypto_generichash_batch:Xr}=mr.exports,{crypto_stream_xsalsa20_MESSAGEBYTES_MAX:Zr}=wr,{crypto_secretbox_open_easy:$r,crypto_secretbox_easy:ei,crypto_secretbox_detached:ti,crypto_secretbox_open_detached:ni}=Hr,ri=yt,ii=e,si=32,oi=32,ai=32,hi=16,ci=Zr-16;var ui={crypto_box_easy:function(e,t,n,r,i){return ii(e.length>=t.length+hi,"c should be at least 'm.length + crypto_box_MACBYTES' bytes"),ii(t.length<=ci,"m should be at most 'crypto_box_MESSAGEBYTES_MAX' bytes"),function(e,t,n,r,i,s){fi(t,hi),fi(r,24),fi(i,si),fi(s,oi);const o=new Uint8Array(ai);ii(di(o,i,s));const a=function(e,t,n,r,i){return ti(e,t,n,r,i)}(e,t,n,r,o);return Ai(o),a}(e.subarray(hi,t.length+hi),e.subarray(0,hi),t,n,r,i)},crypto_box_open_easy:function(e,t,n,r,i){return ii(t.length>=e.length+hi,"c should be at least 'm.length + crypto_box_MACBYTES' bytes"),function(e,t,n,r,i,s){const o=new Uint8Array(ai);ii(di(o,i,s));const a=function(e,t,n,r,i){return ni(e,t,n,r,i)}(e,t,n,r,o);return Ai(o),a}(e,t.subarray(hi,e.length+hi),t.subarray(0,hi),n,r,i)},crypto_box_keypair:li,crypto_box_seed_keypair:function(e,t,n){ii(e.byteLength===si,"pk should be 'crypto_box_PUBLICKEYBYTES' bytes"),ii(t.byteLength===oi,"sk should be 'crypto_box_SECRETKEYBYTES' bytes"),ii(32===t.byteLength,"sk should be 'crypto_box_SEEDBYTES' bytes");const r=new Uint8Array(64);return Jr(r,n,32),t.set(r.subarray(0,32)),r.fill(0),Wr(e,t)},crypto_box_seal:function(e,t,n){fi(e,48+t.length),fi(n,si);var r=e.subarray(0,si),i=new Uint8Array(oi);li(r,i);var s=new Uint8Array(24);Xr(s,[r,n]);var o=new Uint8Array(si);jr(o,i,n);var a=new Uint8Array(ai),h=new Uint8Array(16);ri.core_hsalsa20(a,h,o,ri.SIGMA),ei(e.subarray(r.length),t,s,a),Ai(i)},crypto_box_seal_open:function(e,t,n,r){fi(t,48),fi(e,t.length-48),fi(n,si),fi(r,oi);var i=t.subarray(0,si),s=new Uint8Array(24);Xr(s,[i,n]);var o=new Uint8Array(si);jr(o,r,i);var a=new Uint8Array(ai),h=new Uint8Array(16);return ri.core_hsalsa20(a,h,o,ri.SIGMA),$r(e,t.subarray(i.length),s,a)},crypto_box_PUBLICKEYBYTES:si,crypto_box_SECRETKEYBYTES:oi,crypto_box_NONCEBYTES:24,crypto_box_ZEROBYTES:32,crypto_box_BOXZEROBYTES:16,crypto_box_SEALBYTES:48,crypto_box_SEEDBYTES:32,crypto_box_BEFORENMBYTES:ai,crypto_box_MACBYTES:hi};function li(e,t){return fi(e,si),fi(t,oi),zr(t,32),Wr(e,t)}function di(e,t,n){const r=new Uint8Array(16),i=new Uint8Array(32);return ii(0===jr(i,n,t)),ri.core_hsalsa20(e,r,i,ri.SIGMA),!0}function fi(e,t){if(!e||t&&e.length<t)throw new Error("Argument must be a buffer"+(t?" of length "+t:""))}function Ai(e){for(let t=0;t<e.length;t++)e[t]=0}const gi=tn,pi=e;if(1!==new Uint16Array([1])[0])throw new Error("Big endian architecture is not supported.");var yi={crypto_hash_sha256:function(e,t,n){return pi(32===e.byteLength,"out must be 'crypto_hash_sha256_BYTES' bytes long"),gi().update(t.subarray(0,n)).digest(e),0},crypto_hash_sha256_BYTES:32},_i={exports:{}};!function(t){const n=e,r=Dn.exports.randombytes_buf,i=ht;t.exports.crypto_kdf_PRIMITIVE="blake2b",t.exports.crypto_kdf_BYTES_MIN=16,t.exports.crypto_kdf_BYTES_MAX=64,t.exports.crypto_kdf_CONTEXTBYTES=8,t.exports.crypto_kdf_KEYBYTES=32,t.exports.crypto_kdf_derive_from_key=function(e,r,s,o){n(e.length>=t.exports.crypto_kdf_BYTES_MIN,"subkey must be at least crypto_kdf_BYTES_MIN"),n(r>=0&&r<=9007199254740991,"subkey_id must be safe integer"),n(s.length>=t.exports.crypto_kdf_CONTEXTBYTES,"context must be at least crypto_kdf_CONTEXTBYTES");var a=new Uint8Array(i.PERSONALBYTES),h=new Uint8Array(i.SALTBYTES);a.set(s,0,t.exports.crypto_kdf_CONTEXTBYTES),function(e,t){var n=1,r=0;for(e[0]=255&t;++r<8&&(n*=256);)e[r]=t/n&255}(h,r);var c=Math.min(e.length,t.exports.crypto_kdf_BYTES_MAX);i(c,o.subarray(0,t.exports.crypto_kdf_KEYBYTES),h,a,!0).final(e)},t.exports.crypto_kdf_keygen=function(e){n(e.length>=t.exports.crypto_kdf_KEYBYTES,"out.length must be crypto_kdf_KEYBYTES"),r(e.subarray(0,t.exports.crypto_kdf_KEYBYTES))}}(_i);const{crypto_scalarmult_base:bi}=br,{crypto_generichash:Ii}=mr.exports,{randombytes_buf:Ei}=Dn.exports,mi=e;var wi={crypto_kx_keypair:function(e,t){return mi(32===e.byteLength,"pk must be 'crypto_kx_PUBLICKEYBYTES' bytes"),mi(32===t.byteLength,"sk must be 'crypto_kx_SECRETKEYBYTES' bytes"),Ei(t,32),bi(e,t)},crypto_kx_seed_keypair:function(e,t,n){return mi(32===e.byteLength,"pk must be 'crypto_kx_PUBLICKEYBYTES' bytes"),mi(32===t.byteLength,"sk must be 'crypto_kx_SECRETKEYBYTES' bytes"),mi(32===n.byteLength,"seed must be 'crypto_kx_SEEDBYTES' bytes"),Ii(t,n),bi(e,t)},crypto_kx_SEEDBYTES:32,crypto_kx_SECRETKEYBYTES:32,crypto_kx_PUBLICKEYBYTES:32},Ci={};!function(t){const n=e,r=rn;if(1!==new Uint16Array([1])[0])throw new Error("Big endian architecture is not supported.");t.crypto_stream_chacha20_KEYBYTES=32,t.crypto_stream_chacha20_NONCEBYTES=8,t.crypto_stream_chacha20_MESSAGEBYTES_MAX=Number.MAX_SAFE_INTEGER,t.crypto_stream_chacha20_ietf_KEYBYTES=32,t.crypto_stream_chacha20_ietf_NONCEBYTES=12,t.crypto_stream_chacha20_ietf_MESSAGEBYTES_MAX=2**32,t.crypto_stream_chacha20=function(e,n,r){e.fill(0),t.crypto_stream_chacha20_xor(e,e,n,r)},t.crypto_stream_chacha20_xor=function(e,i,s,o){n(s.byteLength===t.crypto_stream_chacha20_NONCEBYTES,"n should be crypto_stream_chacha20_NONCEBYTES"),n(o.byteLength===t.crypto_stream_chacha20_KEYBYTES,"k should be crypto_stream_chacha20_KEYBYTES");const a=new r(s,o);a.update(e,i),a.final()},t.crypto_stream_chacha20_xor_ic=function(e,i,s,o,a){n(s.byteLength===t.crypto_stream_chacha20_NONCEBYTES,"n should be crypto_stream_chacha20_NONCEBYTES"),n(a.byteLength===t.crypto_stream_chacha20_KEYBYTES,"k should be crypto_stream_chacha20_KEYBYTES");const h=new r(s,a,o);h.update(e,i),h.final()},t.crypto_stream_chacha20_xor_instance=function(e,i){return n(e.byteLength===t.crypto_stream_chacha20_NONCEBYTES,"n should be crypto_stream_chacha20_NONCEBYTES"),n(i.byteLength===t.crypto_stream_chacha20_KEYBYTES,"k should be crypto_stream_chacha20_KEYBYTES"),new r(e,i)},t.crypto_stream_chacha20_ietf=function(e,n,r){e.fill(0),t.crypto_stream_chacha20_ietf_xor(e,e,n,r)},t.crypto_stream_chacha20_ietf_xor=function(e,i,s,o){n(s.byteLength===t.crypto_stream_chacha20_ietf_NONCEBYTES,"n should be crypto_stream_chacha20_ietf_NONCEBYTES"),n(o.byteLength===t.crypto_stream_chacha20_ietf_KEYBYTES,"k should be crypto_stream_chacha20_ietf_KEYBYTES");const a=new r(s,o);a.update(e,i),a.final()},t.crypto_stream_chacha20_ietf_xor_ic=function(e,i,s,o,a){n(s.byteLength===t.crypto_stream_chacha20_ietf_NONCEBYTES,"n should be crypto_stream_chacha20_ietf_NONCEBYTES"),n(a.byteLength===t.crypto_stream_chacha20_ietf_KEYBYTES,"k should be crypto_stream_chacha20_ietf_KEYBYTES");const h=new r(s,a,o);h.update(e,i),h.final()},t.crypto_stream_chacha20_ietf_xor_instance=function(e,i){return n(e.byteLength===t.crypto_stream_chacha20_ietf_NONCEBYTES,"n should be crypto_stream_chacha20_ietf_NONCEBYTES"),n(i.byteLength===t.crypto_stream_chacha20_ietf_KEYBYTES,"k should be crypto_stream_chacha20_ietf_KEYBYTES"),new r(e,i)}}(Ci);const{crypto_stream_chacha20_ietf:Si,crypto_stream_chacha20_ietf_xor_ic:Bi}=Ci,{crypto_verify_16:Qi}=Mn.exports,vi=Sr,xi=e,Li=16,ki=Number.MAX_SAFE_INTEGER,Di=new Uint8Array(16);function Ui(e,t,n,r,i,s,o){if(null===r)return Ui(e,t,n,new Uint8Array(0),i,s,o);xi(e.byteLength===n.byteLength,"ciphertext should be same length than message"),xi(12===s.byteLength,"npub should be 'crypto_aead_chacha20poly1305_ietf_NPUBBYTES' long"),xi(32===o.byteLength,"k should be 'crypto_aead_chacha20poly1305_ietf_KEYBYTES' long"),xi(n.byteLength<=ki,"message is too large"),xi(t.byteLength<=Li,"mac should be 'crypto_aead_chacha20poly1305_ietf_ABYTES' long");const a=new Uint8Array(64);var h=new Uint8Array(8);Si(a,s,o);const c=new vi(a);return a.fill(0),c.update(r,0,r.byteLength),c.update(Di,0,16-r.byteLength&15),Bi(e,n,s,1,o),c.update(e,0,n.byteLength),c.update(Di,0,16-n.byteLength&15),Mi(h,0,r.byteLength),c.update(h,0,h.byteLength),Mi(h,0,n.byteLength),c.update(h,0,h.byteLength),c.finish(t,0),h.fill(0),Li}function Ki(e,t,n,r,i,s,o){if(null===i)return Ki(e,t,n,r,new Uint8Array(0),s,o);xi(n.byteLength===e.byteLength,"message should be same length than ciphertext"),xi(12===s.byteLength,"npub should be 'crypto_aead_chacha20poly1305_ietf_NPUBBYTES' long"),xi(32===o.byteLength,"k should be 'crypto_aead_chacha20poly1305_ietf_KEYBYTES' long"),xi(e.byteLength<=ki,"message is too large"),xi(r.byteLength<=Li,"mac should be 'crypto_aead_chacha20poly1305_ietf_ABYTES' long");const a=new Uint8Array(64),h=new Uint8Array(8),c=new Uint8Array(Li);Si(a,s,o);const u=new vi(a);a.fill(0),u.update(i,0,i.byteLength),u.update(Di,0,16-i.byteLength&15);const l=n.byteLength;u.update(n,0,l),u.update(Di,0,16-l&15),Mi(h,0,i.byteLength),u.update(h,0,h.byteLength),Mi(h,0,l),u.update(h,0,h.byteLength),u.finish(c,0),xi(16===c.byteLength);const d=Qi(c,0,r,0);if(c.fill(0),h.fill(0),!d)throw e.fill(0),new Error("could not verify data");Bi(e,n,s,1,o)}function Mi(e,t,n){e.fill(0,0,8);const r=new DataView(e.buffer,e.byteOffset,e.byteLength);r.setUint32(t,4294967295&n,!0),r.setUint32(t+4,n/2**32&4294967295,!0)}var Ti={crypto_aead_chacha20poly1305_ietf_encrypt:function e(t,n,r,i,s,o){if(null===r)return e(t,n,new Uint8Array(0),i,s,o);xi(t.byteLength===n.byteLength+Li,"ciphertext should be 'crypto_aead_chacha20poly1305_ietf_ABYTES' longer than message"),xi(12===s.byteLength,"npub should be 'crypto_aead_chacha20poly1305_ietf_NPUBBYTES' long"),xi(32===o.byteLength,"k should be 'crypto_aead_chacha20poly1305_ietf_KEYBYTES' long"),xi(n.byteLength<=ki,"message is too large");const a=Ui(t.subarray(0,n.byteLength),t.subarray(n.byteLength),n,r,i,s,o);return n.byteLength+a},crypto_aead_chacha20poly1305_ietf_encrypt_detached:Ui,crypto_aead_chacha20poly1305_ietf_decrypt:function e(t,n,r,i,s,o){if(null===i)return e(t,n,r,new Uint8Array(0),s,o);if(xi(t.byteLength===r.byteLength-Li,"message should be 'crypto_aead_chacha20poly1305_ietf_ABYTES' shorter than ciphertext"),xi(12===s.byteLength,"npub should be 'crypto_aead_chacha20poly1305_ietf_NPUBBYTES' long"),xi(32===o.byteLength,"k should be 'crypto_aead_chacha20poly1305_ietf_KEYBYTES' long"),xi(t.byteLength<=ki,"message is too large"),r.byteLength<Li)throw new Error("could not verify data");return Ki(t,n,r.subarray(0,r.byteLength-Li),r.subarray(r.byteLength-Li),i,s,o),r.byteLength-Li},crypto_aead_chacha20poly1305_ietf_decrypt_detached:Ki,crypto_aead_chacha20poly1305_ietf_ABYTES:Li,crypto_aead_chacha20poly1305_ietf_KEYBYTES:32,crypto_aead_chacha20poly1305_ietf_NPUBBYTES:12,crypto_aead_chacha20poly1305_ietf_NSECBYTES:0,crypto_aead_chacha20poly1305_ietf_MESSAGEBYTES_MAX:ki};const Yi=e;if(1!==new Uint16Array([1])[0])throw new Error("Big endian architecture is not supported.");function Ni(e,t){return(e&=4294967295)<<(t&=4294967295)|e>>>32-t}function Pi(e,t){Yi(e instanceof Uint8Array,"src not byte array");let n=e[t];return n|=e[t+1]<<8,n|=e[t+2]<<16,n|=e[t+3]<<24,n}function Oi(e,t,n){Yi(e instanceof Uint8Array,"dest not byte array");var r=1,i=0;for(e[n]=255&t;++i<4&&(r*=256);)e[n+i]=t/r&255}function Fi(e,t,n,r,i){e[t]+=e[n],e[i]=Ni(e[i]^e[t],16),e[r]+=e[i],e[n]=Ni(e[n]^e[r],12),e[t]+=e[n],e[i]=Ni(e[i]^e[t],8),e[r]+=e[i],e[n]=Ni(e[n]^e[r],7)}var Hi={crypto_core_hchacha20_INPUTBYTES:16,LOAD32_LE:Pi,STORE32_LE:Oi,QUARTERROUND:Fi,crypto_core_hchacha20:function(e,t,n,r){Yi(e instanceof Uint8Array&&32===e.length,"out is not an array of 32 bytes"),Yi(n instanceof Uint8Array&&32===n.length,"k is not an array of 32 bytes"),Yi(null===r||r instanceof Uint8Array&&16===r.length,"c is not null or an array of 16 bytes");let i=0;const s=new Uint32Array(16);for(r?(s[0]=Pi(r,0),s[1]=Pi(r,4),s[2]=Pi(r,8),s[3]=Pi(r,12)):(s[0]=1634760805,s[1]=857760878,s[2]=2036477234,s[3]=1797285236),s[4]=Pi(n,0),s[5]=Pi(n,4),s[6]=Pi(n,8),s[7]=Pi(n,12),s[8]=Pi(n,16),s[9]=Pi(n,20),s[10]=Pi(n,24),s[11]=Pi(n,28),s[12]=Pi(t,0),s[13]=Pi(t,4),s[14]=Pi(t,8),s[15]=Pi(t,12),i=0;i<10;i++)Fi(s,0,4,8,12),Fi(s,1,5,9,13),Fi(s,2,6,10,14),Fi(s,3,7,11,15),Fi(s,0,5,10,15),Fi(s,1,6,11,12),Fi(s,2,7,8,13),Fi(s,3,4,9,14);return Oi(e,s[0],0),Oi(e,s[1],4),Oi(e,s[2],8),Oi(e,s[3],12),Oi(e,s[12],16),Oi(e,s[13],20),Oi(e,s[14],24),Oi(e,s[15],28),0},crypto_core_hchacha20_outputbytes:function(){return 32},crypto_core_hchacha20_inputbytes:function(){return 16},crypto_core_hchacha20_keybytes:function(){return 32},crypto_core_hchacha20_constbytes:function(){return 16}};const Ri=e,{randombytes_buf:Gi}=Dn.exports,{crypto_stream_chacha20_ietf:Vi,crypto_stream_chacha20_ietf_xor:qi,crypto_stream_chacha20_ietf_xor_ic:Ji,crypto_stream_chacha20_ietf_KEYBYTES:ji}=Ci,{crypto_core_hchacha20:Wi,crypto_core_hchacha20_INPUTBYTES:zi}=Hi,Xi=Sr,{sodium_increment:Zi,sodium_is_zero:$i,sodium_memcmp:es}=Nn,ts=32,ns=Number.MAX_SAFE_INTEGER,rs=Number.MAX_SAFE_INTEGER,is=new Uint8Array([0]),ss=new Uint8Array([1]),os=new Uint8Array([2]),as=new Uint8Array([ss|os]),hs=52,cs=ts,us=44,ls=new Uint8Array(16);function ds(e,t){let n=1,r=0;for(e[0]=255&t;++r<8&&(n*=256);)e[r]=t/n&255}function fs(e){Ri(e.byteLength===hs,"state is should be crypto_secretstream_xchacha20poly1305_STATEBYTES long");const t=e.subarray(cs,us);for(let e=0;e<4;e++)t[e]=0;t[0]=1}function As(e){Ri(e.byteLength===hs,"state is should be crypto_secretstream_xchacha20poly1305_STATEBYTES long");const t=e.subarray(0,cs),n=e.subarray(cs,us),r=new Uint8Array(ji+8);let i;for(i=0;i<ji;i++)r[i]=t[i];for(i=0;i<8;i++)r[ji+i]=n[4+i];for(qi(r,r,n,t),i=0;i<ji;i++)t[i]=r[i];for(i=0;i<8;i++)n[4+i]=r[ji+i];fs(e)}function gs(e,t,n){for(let r=0;r<n;r++)e[r]^=t[r]}var ps={crypto_secretstream_xchacha20poly1305_keygen:function(e){Ri(e.length===ts),Gi(e)},crypto_secretstream_xchacha20poly1305_init_push:function(e,t,n){Ri(e.byteLength===hs,"state is should be crypto_secretstream_xchacha20poly1305_STATEBYTES long"),Ri(t instanceof Uint8Array&&24===t.length,"out not byte array of length crypto_secretstream_xchacha20poly1305_HEADERBYTES"),Ri(n instanceof Uint8Array&&n.length===ts,"key not byte array of length crypto_secretstream_xchacha20poly1305_KEYBYTES");const r=e.subarray(0,cs),i=e.subarray(cs,us),s=e.subarray(us);Gi(t,24),Wi(r,t,n,null),fs(e);for(let e=0;e<8;e++)i[e+4]=t[e+zi];s.fill(0)},crypto_secretstream_xchacha20poly1305_init_pull:function(e,t,n){Ri(e.byteLength===hs,"state is should be crypto_secretstream_xchacha20poly1305_STATEBYTES long"),Ri(t instanceof Uint8Array&&24===t.length,"_in not byte array of length crypto_secretstream_xchacha20poly1305_HEADERBYTES"),Ri(n instanceof Uint8Array&&n.length===ts,"key not byte array of length crypto_secretstream_xchacha20poly1305_KEYBYTES");const r=e.subarray(0,cs),i=e.subarray(cs,us),s=e.subarray(us);Wi(r,t,n,null),fs(e);for(let e=0;e<8;e++)i[e+4]=t[e+zi];s.fill(0)},crypto_secretstream_xchacha20poly1305_rekey:As,crypto_secretstream_xchacha20poly1305_push:function(e,t,n,r,i){Ri(e.byteLength===hs,"state is should be crypto_secretstream_xchacha20poly1305_STATEBYTES long"),r||(r=new Uint8Array(0));const s=e.subarray(0,cs),o=e.subarray(cs,us),a=new Uint8Array(64),h=new Uint8Array(8);Ri(ns<=rs),Vi(a,o,s);const c=new Xi(a);a.fill(0),c.update(r,0,r.byteLength),c.update(ls,0,16-r.byteLength&15),a[0]=i[0],Ji(a,a,o,1,s),c.update(a,0,a.byteLength),t[0]=a[0];const u=t.subarray(1,t.byteLength);Ji(u,n,o,2,s),c.update(u,0,n.byteLength),c.update(ls,0,16-a.byteLength+n.byteLength&15),ds(h,r.byteLength),c.update(h,0,h.byteLength),ds(h,a.byteLength+n.byteLength),c.update(h,0,h.byteLength);const l=t.subarray(1+n.byteLength,t.byteLength);return c.finish(l,0),Ri(!0),gs(o.subarray(4,o.length),l,8),Zi(o),(!!(i[0]&os)||$i(o.subarray(0,4)))&&As(e),17+n.byteLength},crypto_secretstream_xchacha20poly1305_pull:function(e,t,n,r,i){Ri(e.byteLength===hs,"state is should be crypto_secretstream_xchacha20poly1305_STATEBYTES long"),i||(i=new Uint8Array(0));const s=e.subarray(0,cs),o=e.subarray(cs,us),a=new Uint8Array(64),h=new Uint8Array(8),c=new Uint8Array(16);Ri(r.byteLength>=17,"ciphertext is too short.");const u=r.byteLength-17;Vi(a,o,s);const l=new Xi(a);a.fill(0),l.update(i,0,i.byteLength),l.update(ls,0,16-i.byteLength&15),a.fill(0),a[0]=r[0],Ji(a,a,o,1,s),n[0]=a[0],a[0]=r[0],l.update(a,0,a.byteLength);const d=r.subarray(1,r.length);l.update(d,0,u),l.update(ls,0,16-a.byteLength+u&15),ds(h,i.byteLength),l.update(h,0,h.byteLength),ds(h,a.byteLength+t.byteLength),l.update(h,0,h.byteLength),l.finish(c,0);const f=r.subarray(1+u,r.length);if(!es(c,f))throw c.fill(0),new Error("MAC could not be verified.");return Ji(t,d.subarray(0,t.length),o,2,s),gs(o.subarray(4,o.length),c,8),Zi(o),(!!(n&os)||$i(o.subarray(0,4)))&&As(e),u},crypto_secretstream_xchacha20poly1305_STATEBYTES:hs,crypto_secretstream_xchacha20poly1305_ABYTES:17,crypto_secretstream_xchacha20poly1305_HEADERBYTES:24,crypto_secretstream_xchacha20poly1305_KEYBYTES:ts,crypto_secretstream_xchacha20poly1305_MESSAGEBYTES_MAX:ns,crypto_secretstream_xchacha20poly1305_TAGBYTES:1,crypto_secretstream_xchacha20poly1305_TAG_MESSAGE:is,crypto_secretstream_xchacha20poly1305_TAG_PUSH:ss,crypto_secretstream_xchacha20poly1305_TAG_REKEY:os,crypto_secretstream_xchacha20poly1305_TAG_FINAL:as},ys={},_s=Cn;if(1!==new Uint16Array([1])[0])throw new Error("Big endian architecture is not supported.");ys.crypto_shorthash_PRIMITIVE="siphash24",ys.crypto_shorthash_BYTES=_s.BYTES,ys.crypto_shorthash_KEYBYTES=_s.KEYBYTES,ys.crypto_shorthash_WASM_SUPPORTED=_s.WASM_SUPPORTED,ys.crypto_shorthash_WASM_LOADED=_s.WASM_LOADED,ys.crypto_shorthash=function(e,t,n,r){_s(t,n,e,r)};const{crypto_verify_32:bs}=Mn.exports,{crypto_hash:Is}=qn,{gf:Es,gf0:ms,gf1:ws,D:Cs,D2:Ss,X:Bs,Y:Qs,I:vs,A:xs,Z:Ls,M:ks,S:Ds,sel25519:Us,pack25519:Ks,inv25519:Ms,unpack25519:Ts}=ar,{randombytes:Ys}=Dn.exports,{crypto_scalarmult_BYTES:Ns}=br,{crypto_hash_sha512_BYTES:Ps}=qn,Os=e,Fs=64;var Hs={crypto_sign_keypair:Ws,crypto_sign_seed_keypair:function(e,t,n){return io(n,32),t.set(n),Ws(e,t,!0)},crypto_sign:$s,crypto_sign_detached:function(e,t,n){var r=new Uint8Array(t.length+Fs);$s(r,t,n);for(let t=0;t<Fs;t++)e[t]=r[t]},crypto_sign_open:to,crypto_sign_verify_detached:function(e,t,n){io(e,Fs);var r=new Uint8Array(t.length+Fs),i=0;for(i=0;i<Fs;i++)r[i]=e[i];for(i=0;i<t.length;i++)r[i+Fs]=t[i];return to(t,r,n)},crypto_sign_BYTES:Fs,crypto_sign_PUBLICKEYBYTES:32,crypto_sign_SECRETKEYBYTES:64,crypto_sign_SEEDBYTES:32,crypto_sign_ed25519_PUBLICKEYBYTES:32,crypto_sign_ed25519_SECRETKEYBYTES:64,crypto_sign_ed25519_SEEDBYTES:32,crypto_sign_ed25519_BYTES:64,crypto_sign_ed25519_pk_to_curve25519:function(e,t){io(e,32),io(t,32);var n=[Es(),Es(),Es(),Es()],r=Es([1]),i=Es([1]);Os(function(e){var t,n=[Uint8Array.from([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Uint8Array.from([1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Uint8Array.from([38,232,149,143,194,178,39,176,69,195,244,137,242,239,152,240,213,223,172,5,211,198,51,57,177,56,2,136,109,83,252,5]),Uint8Array.from([199,23,106,112,61,77,216,79,186,60,11,118,13,16,103,15,42,32,83,250,44,57,204,198,78,199,253,119,146,172,3,122]),Uint8Array.from([236,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,127]),Uint8Array.from([237,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,127]),Uint8Array.from([238,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,127])],r=new Uint8Array(7);io(n,7);for(let i=0;i<n.length;i++)for(t=0;t<31;t++)r[i]|=e[t]^n[i][t];for(let i=0;i<n.length;i++)r[i]|=127&e[t]^n[i][t];var i=0;for(let e=0;e<n.length;e++)i|=r[e]-1;return!(i>>8&1)}(t)&&eo(n,t)&&function(e){var t=[Es(),Es(),Es(),Es()];!function(e,t){Js(e,t,zs)}(t,e);var n=0;for(let e=0;e<16;e++)n|=65535&t[0][e];return 0===n}(n),"Cannot convert key: bad point");for(let t=0;t<n.length;t++)Ks(e,n[t]);return Ls(i,i,n[1]),xs(r,r,n[1]),Ms(i,i),ks(r,r,i),Ks(e,r),0},crypto_sign_ed25519_sk_to_curve25519:function(e,t){Os(e&&e.byteLength===Ns,"curveSk must be 'crypto_sign_SECRETKEYBYTES' long"),Os(t&&64===t.byteLength,"edSk must be 'crypto_sign_ed25519_SECRETKEYBYTES' long");var n=new Uint8Array(Ps);return Is(n,t,32),n[0]&=248,n[31]&=127,n[31]|=64,e.set(n.subarray(0,Ns)),n.fill(0),e},crypto_sign_ed25519_sk_to_pk:function(e,t){return io(e,32),e.set(t.subarray(32)),e},unpackneg:eo,pack:qs};function Rs(e,t){for(let n=0;n<16;n++)e[n]=0|t[n]}function Gs(e,t){var n=Es(),r=Es(),i=Es(),s=Es(),o=Es(),a=Es(),h=Es(),c=Es(),u=Es();Ls(n,e[1],e[0]),Ls(u,t[1],t[0]),ks(n,n,u),xs(r,e[0],e[1]),xs(u,t[0],t[1]),ks(r,r,u),ks(i,e[3],t[3]),ks(i,i,Ss),ks(s,e[2],t[2]),xs(s,s,s),Ls(o,r,n),Ls(a,s,i),xs(h,s,i),xs(c,r,n),ks(e[0],o,a),ks(e[1],c,h),ks(e[2],h,a),ks(e[3],o,c)}function Vs(e,t,n){var r;for(r=0;r<4;r++)Us(e[r],t[r],n)}function qs(e,t){var n=Es(),r=Es(),i=Es();Ms(i,t[2]),ks(n,t[0],i),ks(r,t[1],i),Ks(e,r),e[31]^=no(n)<<7}function Js(e,t,n){var r,i,s=[Es(t[0]),Es(t[1]),Es(t[2]),Es(t[3])];for(Rs(e[0],ms),Rs(e[1],ws),Rs(e[2],ws),Rs(e[3],ms),i=255;i>=0;--i)Vs(e,s,r=n[i/8|0]>>(7&i)&1),Gs(s,e),Gs(e,e),Vs(e,s,r)}function js(e,t){var n=[Es(),Es(),Es(),Es()];Rs(n[0],Bs),Rs(n[1],Qs),Rs(n[2],ws),ks(n[3],Bs,Qs),Js(e,n,t)}function Ws(e,t,n){io(e,32),io(t,64);var r,i=new Uint8Array(64),s=[Es(),Es(),Es(),Es()];for(n||Ys(t,32),Is(i,t,32),i[0]&=248,i[31]&=127,i[31]|=64,js(s,i),qs(e,s),r=0;r<32;r++)t[r+32]=e[r]}var zs=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function Xs(e,t){var n,r,i,s;for(r=63;r>=32;--r){for(n=0,i=r-32,s=r-12;i<s;++i)t[i]+=n-16*t[r]*zs[i-(r-32)],n=t[i]+128>>8,t[i]-=256*n;t[i]+=n,t[r]=0}for(n=0,i=0;i<32;i++)t[i]+=n-(t[31]>>4)*zs[i],n=t[i]>>8,t[i]&=255;for(i=0;i<32;i++)t[i]-=n*zs[i];for(r=0;r<32;r++)t[r+1]+=t[r]>>8,e[r]=255&t[r]}function Zs(e){var t=new Float64Array(64);for(let n=0;n<64;n++)t[n]=e[n];for(let t=0;t<64;t++)e[t]=0;Xs(e,t)}function $s(e,t,n){io(e,Fs+t.length),io(t,0),io(n,64);var r,i,s=t.length,o=new Uint8Array(64),a=new Uint8Array(64),h=new Uint8Array(64),c=new Float64Array(64),u=[Es(),Es(),Es(),Es()];Is(o,n,32),o[0]&=248,o[31]&=127,o[31]|=64;var l=s+64;for(r=0;r<s;r++)e[64+r]=t[r];for(r=0;r<32;r++)e[32+r]=o[32+r];for(Is(h,e.subarray(32),s+32),Zs(h),js(u,h),qs(e,u),r=32;r<64;r++)e[r]=n[r];for(Is(a,e,s+64),Zs(a),r=0;r<64;r++)c[r]=0;for(r=0;r<32;r++)c[r]=h[r];for(r=0;r<32;r++)for(i=0;i<32;i++)c[r+i]+=a[r]*o[i];return Xs(e.subarray(32),c),l}function eo(e,t){var n=Es(),r=Es(),i=Es(),s=Es(),o=Es(),a=Es(),h=Es();return Rs(e[2],ws),Ts(e[1],t),Ds(i,e[1]),ks(s,i,Cs),Ls(i,i,e[2]),xs(s,e[2],s),Ds(o,s),Ds(a,o),ks(h,a,o),ks(n,h,i),ks(n,n,s),function(e,t){var n,r=Es();for(n=0;n<16;n++)r[n]=t[n];for(n=250;n>=0;n--)Ds(r,r),1!==n&&ks(r,r,t);for(n=0;n<16;n++)e[n]=r[n]}(n,n),ks(n,n,i),ks(n,n,s),ks(n,n,s),ks(e[0],n,s),Ds(r,e[0]),ks(r,r,s),ro(r,i)||ks(e[0],e[0],vs),Ds(r,e[0]),ks(r,r,s),!!ro(r,i)&&(no(e[0])===t[31]>>7&&Ls(e[0],Es(),e[0]),ks(e[3],e[0],e[1]),!0)}function to(e,t,n){io(e,t.length-Fs),io(t,Fs),io(n,32);var r,i=t.length,s=new Uint8Array(t.length),o=new Uint8Array(32),a=new Uint8Array(64),h=[Es(),Es(),Es(),Es()],c=[Es(),Es(),Es(),Es()];if(i<64)return!1;if(!eo(c,n))return!1;for(r=0;r<i;r++)s[r]=t[r];for(r=0;r<32;r++)s[r+32]=n[r];if(Is(a,s,i),Zs(a),Js(h,c,a),js(c,t.subarray(32)),Gs(h,c),qs(o,h),i-=64,!bs(t,0,o,0)){for(r=0;r<i;r++)s[r]=0;return!1}for(r=0;r<i;r++)e[r]=t[r+64];return!0}function no(e){var t=new Uint8Array(32);return Ks(t,e),1&t[0]}function ro(e,t){var n=new Uint8Array(32),r=new Uint8Array(32);return Ks(n,e),Ks(r,t),bs(n,0,r,0)}function io(e,t,n="Argument"){if(!e||t&&e.length<t)throw new Error(n+" must be a buffer"+(t?" of length "+t:""))}!function(e){function t(t){Object.keys(t).forEach((function(n){e.exports[n]=t[n]}))}t(Dn.exports),t(Kn),t(Nn),t(Mn.exports),t(Hn),t(ui),t(mr.exports),t(qn),t(yi),t(_i.exports),t(wi),t(Ti),t(xr),t(br),t(Hr),t(ps),t(ys),t(Hs),t(wr),t(Ci)}(kn);var so=kn.exports,oo=so,ao={exports:{}};function ho(e){return e.length}var co={byteLength:ho,toString:function(e){const t=e.byteLength;let n="";for(let r=0;r<t;r++)n+=String.fromCharCode(e[r]);return n},write:function(e,t,n=0,r=ho(t)){const i=Math.min(r,e.byteLength-n);for(let r=0;r<i;r++)e[n+r]=t.charCodeAt(r);return i}};const uo="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lo=new Uint8Array(256);for(let e=0;e<64;e++)lo[uo.charCodeAt(e)]=e;function fo(e){let t=e.length;return 61===e.charCodeAt(t-1)&&t--,t>1&&61===e.charCodeAt(t-1)&&t--,3*t>>>2}lo[45]=62,lo[95]=63;var Ao={byteLength:fo,toString:function(e){const t=e.byteLength;let n="";for(let r=0;r<t;r+=3)n+=uo[e[r]>>2]+uo[(3&e[r])<<4|e[r+1]>>4]+uo[(15&e[r+1])<<2|e[r+2]>>6]+uo[63&e[r+2]];return t%3==2?n=n.substring(0,n.length-1)+"=":t%3==1&&(n=n.substring(0,n.length-2)+"=="),n},write:function(e,t,n=0,r=fo(t)){const i=Math.min(r,e.byteLength-n);for(let n=0,r=0;r<i;n+=4){const i=lo[t.charCodeAt(n)],s=lo[t.charCodeAt(n+1)],o=lo[t.charCodeAt(n+2)],a=lo[t.charCodeAt(n+3)];e[r++]=i<<2|s>>4,e[r++]=(15&s)<<4|o>>2,e[r++]=(3&o)<<6|63&a}return i}};function go(e){return e.length>>>1}var po={byteLength:go,toString:function(e){const t=e.byteLength;e=new DataView(e.buffer,e.byteOffset,t);let n="",r=0;for(let i=t-t%4;r<i;r+=4)n+=e.getUint32(r).toString(16).padStart(8,"0");for(;r<t;r++)n+=e.getUint8(r).toString(16).padStart(2,"0");return n},write:function(e,t,n=0,r=go(t)){const i=Math.min(r,e.byteLength-n);for(let r=0;r<i;r++){const i=yo(t.charCodeAt(2*r)),s=yo(t.charCodeAt(2*r+1));if(void 0===i||void 0===s)return e.subarray(0,r);e[n+r]=i<<4|s}return i}};function yo(e){return e>=48&&e<=57?e-48:e>=65&&e<=70?e-65+10:e>=97&&e<=102?e-97+10:void 0}function _o(e){let t=0;for(let n=0,r=e.length;n<r;n++){const i=e.charCodeAt(n);if(i>=55296&&i<=56319&&n+1<r){const r=e.charCodeAt(n+1);if(r>=56320&&r<=57343){t+=4,n++;continue}}t+=i<=127?1:i<=2047?2:3}return t}let bo,Io;if("undefined"!=typeof TextDecoder){const e=new TextDecoder;bo=function(t){return e.decode(t)}}else bo=function(e){const t=e.byteLength;let n="",r=0;for(;r<t;){let i=e[r];if(i<=127){n+=String.fromCharCode(i),r++;continue}let s=0,o=0;if(i<=223?(s=1,o=31&i):i<=239?(s=2,o=15&i):i<=244&&(s=3,o=7&i),t-r-s>0){let t=0;for(;t<s;)i=e[r+t+1],o=o<<6|63&i,t+=1}else o=65533,s=t-r;n+=String.fromCodePoint(o),r+=s+1}return n};if("undefined"!=typeof TextEncoder){const e=new TextEncoder;Io=function(t,n,r=0,i=_o(n)){const s=Math.min(i,t.byteLength-r);return e.encodeInto(n,t.subarray(r,r+s)),s}}else Io=function(e,t,n=0,r=_o(t)){const i=Math.min(r,e.byteLength-n);e=e.subarray(n,n+i);let s=0,o=0;for(;s<t.length;){const n=t.codePointAt(s);if(n<=127){e[o++]=n,s++;continue}let r=0,i=0;for(n<=2047?(r=6,i=192):n<=65535?(r=12,i=224):n<=2097151&&(r=18,i=240),e[o++]=i|n>>r,r-=6;r>=0;)e[o++]=128|n>>r&63,r-=6;s+=n>=65536?2:1}return i};var Eo={byteLength:_o,toString:bo,write:Io};function mo(e){return 2*e.length}var wo={byteLength:mo,toString:function(e){const t=e.byteLength;let n="";for(let r=0;r<t-1;r+=2)n+=String.fromCharCode(e[r]+256*e[r+1]);return n},write:function(e,t,n=0,r=mo(t)){const i=Math.min(r,e.byteLength-n);let s=i;for(let r=0;r<t.length&&!((s-=2)<0);++r){const i=t.charCodeAt(r),s=i>>8,o=i%256;e[n+2*r]=o,e[n+2*r+1]=s}return i}};!function(e,t){const n=co,r=Ao,i=po,s=Eo,o=wo,a=255===new Uint8Array(Uint16Array.of(255).buffer)[0];function h(e){switch(e){case"ascii":return n;case"base64":return r;case"hex":return i;case"utf8":case"utf-8":case void 0:case null:return s;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return o;default:throw new Error(`Unknown encoding: ${e}`)}}function c(e){return e instanceof Uint8Array}function u(e,t,n){return"string"==typeof e?function(e,t){const n=h(t),r=new Uint8Array(n.byteLength(e));return n.write(r,e,0,r.byteLength),r}(e,t):Array.isArray(e)?function(e){const t=new Uint8Array(e.length);return t.set(e),t}(e):ArrayBuffer.isView(e)?function(e){const t=new Uint8Array(e.byteLength);return t.set(e),t}(e):function(e,t,n){return new Uint8Array(e,t,n)}(e,t,n)}function l(e,t,n,r,i){if(0===e.byteLength)return-1;if("string"==typeof n?(r=n,n=0):void 0===n?n=i?0:e.length-1:n<0&&(n+=e.byteLength),n>=e.byteLength){if(i)return-1;n=e.byteLength-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t)t=u(t,r);else if("number"==typeof t)return t&=255,i?e.indexOf(t,n):e.lastIndexOf(t,n);if(0===t.byteLength)return-1;if(i){let r=-1;for(let i=n;i<e.byteLength;i++)if(e[i]===t[-1===r?0:i-r]){if(-1===r&&(r=i),i-r+1===t.byteLength)return r}else-1!==r&&(i-=i-r),r=-1}else{n+t.byteLength>e.byteLength&&(n=e.byteLength-t.byteLength);for(let r=n;r>=0;r--){let n=!0;for(let i=0;i<t.byteLength;i++)if(e[r+i]!==t[i]){n=!1;break}if(n)return r}}return-1}function d(e,t,n,r){return l(e,t,n,r,!0)}function f(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}e.exports=t={isBuffer:c,isEncoding:function(e){try{return h(e),!0}catch{return!1}},alloc:function(e,n,r){const i=new Uint8Array(e);return void 0!==n&&t.fill(i,n,0,i.byteLength,r),i},allocUnsafe:function(e){return new Uint8Array(e)},allocUnsafeSlow:function(e){return new Uint8Array(e)},byteLength:function(e,t){return h(t).byteLength(e)},compare:function(e,t){if(e===t)return 0;const n=Math.min(e.byteLength,t.byteLength);e=new DataView(e.buffer,e.byteOffset,e.byteLength),t=new DataView(t.buffer,t.byteOffset,t.byteLength);let r=0;for(let i=n-n%4;r<i&&e.getUint32(r,a)===t.getUint32(r,a);r+=4);for(;r<n;r++){const n=e.getUint8(r),i=t.getUint8(r);if(n<i)return-1;if(n>i)return 1}return e.byteLength>t.byteLength?1:e.byteLength<t.byteLength?-1:0},concat:function(e,t){void 0===t&&(t=e.reduce(((e,t)=>e+t.byteLength),0));const n=new Uint8Array(t);let r=0;for(const t of e){if(r+t.byteLength>n.byteLength){const e=t.subarray(0,n.byteLength-r);return n.set(e,r),n}n.set(t,r),r+=t.byteLength}return n},copy:function(e,t,n=0,r=0,i=e.byteLength){if(i>0&&i<r)return 0;if(i===r)return 0;if(0===e.byteLength||0===t.byteLength)return 0;if(n<0)throw new RangeError("targetStart is out of range");if(r<0||r>=e.byteLength)throw new RangeError("sourceStart is out of range");if(i<0)throw new RangeError("sourceEnd is out of range");n>=t.byteLength&&(n=t.byteLength),i>e.byteLength&&(i=e.byteLength),t.byteLength-n<i-r&&(i=t.length-n+r);const s=i-r;return e===t?t.copyWithin(n,r,i):t.set(e.subarray(r,i),n),s},equals:function(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;const n=e.byteLength;e=new DataView(e.buffer,e.byteOffset,e.byteLength),t=new DataView(t.buffer,t.byteOffset,t.byteLength);let r=0;for(let i=n-n%4;r<i;r+=4)if(e.getUint32(r,a)!==t.getUint32(r,a))return!1;for(;r<n;r++)if(e.getUint8(r)!==t.getUint8(r))return!1;return!0},fill:function(e,t,n,r,i){if("string"==typeof t?"string"==typeof n?(i=n,n=0,r=e.byteLength):"string"==typeof r&&(i=r,r=e.byteLength):"number"==typeof t?t&=255:"boolean"==typeof t&&(t=+t),n<0||e.byteLength<n||e.byteLength<r)throw new RangeError("Out of range index");if(void 0===n&&(n=0),void 0===r&&(r=e.byteLength),r<=n)return e;if(t||(t=0),"number"==typeof t)for(let i=n;i<r;++i)e[i]=t;else{const s=(t=c(t)?t:u(t,i)).byteLength;for(let i=0;i<r-n;++i)e[i+n]=t[i%s]}return e},from:u,includes:function(e,t,n,r){return-1!==d(e,t,n,r)},indexOf:d,lastIndexOf:function(e,t,n,r){return l(e,t,n,r,!1)},swap16:function(e){const t=e.byteLength;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let n=0;n<t;n+=2)f(e,n,n+1);return e},swap32:function(e){const t=e.byteLength;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let n=0;n<t;n+=4)f(e,n,n+3),f(e,n+1,n+2);return e},swap64:function(e){const t=e.byteLength;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let n=0;n<t;n+=8)f(e,n,n+7),f(e,n+1,n+6),f(e,n+2,n+5),f(e,n+3,n+4);return e},toBuffer:function(e){return e},toString:function(e,t,n=0,r=e.byteLength){const i=e.byteLength;return n>=i||r<=n?"":(n<0&&(n=0),r>i&&(r=i),(0!==n||r<i)&&(e=e.subarray(n,r)),h(t).toString(e))},write:function(e,t,n,r,i){return void 0===n?i="utf8":void 0===r&&"string"==typeof n?(i=n,n=void 0):void 0===i&&"string"==typeof r&&(i=r,r=void 0),h(i).write(e,t,n,r)},writeDoubleLE:function(e,t,n){return void 0===n&&(n=0),new DataView(e.buffer,e.byteOffset,e.byteLength).setFloat64(n,t,!0),n+8},writeFloatLE:function(e,t,n){return void 0===n&&(n=0),new DataView(e.buffer,e.byteOffset,e.byteLength).setFloat32(n,t,!0),n+4},writeUInt32LE:function(e,t,n){return void 0===n&&(n=0),new DataView(e.buffer,e.byteOffset,e.byteLength).setUint32(n,t,!0),n+4},writeInt32LE:function(e,t,n){return void 0===n&&(n=0),new DataView(e.buffer,e.byteOffset,e.byteLength).setInt32(n,t,!0),n+4},readDoubleLE:function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat64(t,!0)},readFloatLE:function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat32(t,!0)},readUInt32LE:function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getUint32(t,!0)},readInt32LE:function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getInt32(t,!0)},writeDoubleBE:function(e,t,n){return void 0===n&&(n=0),new DataView(e.buffer,e.byteOffset,e.byteLength).setFloat64(n,t,!1),n+8},writeFloatBE:function(e,t,n){return void 0===n&&(n=0),new DataView(e.buffer,e.byteOffset,e.byteLength).setFloat32(n,t,!1),n+4},writeUInt32BE:function(e,t,n){return void 0===n&&(n=0),new DataView(e.buffer,e.byteOffset,e.byteLength).setUint32(n,t,!1),n+4},writeInt32BE:function(e,t,n){return void 0===n&&(n=0),new DataView(e.buffer,e.byteOffset,e.byteLength).setInt32(n,t,!1),n+4},readDoubleBE:function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat64(t,!1)},readFloatBE:function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat32(t,!1)},readUInt32BE:function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getUint32(t,!1)},readInt32BE:function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getInt32(t,!1)}}}(ao,ao.exports);var Co=ao.exports;const So=oo,Bo=Co;var Qo={hash:function(e){const t=Bo.allocUnsafe(32);return So.crypto_generichash(t,e),t},unslabbedHash:function(e){const t=Bo.allocUnsafeSlow(32);return So.crypto_generichash(t,e),t},createKeyPair:function(e){const t=Bo.alloc(32),n=Bo.alloc(64);return e?So.crypto_sign_seed_keypair(t,n,e):So.crypto_sign_keypair(t,n),{publicKey:t,secretKey:n}}};const{hash:vo,createKeyPair:xo}=Qo;var Lo={};function ko(e,t){return t._index<e.length&&e[t._index]===t}Lo.add=function(e,t){return ko(e,t)||(t._index=e.length,e.push(t)),t},Lo.has=ko,Lo.remove=function(e,t){if(!ko(e,t))return null;var n=e.pop();return n!==t&&(e[t._index]=n,n._index=t._index),t},Lo.swap=function(e,t,n){if(ko(e,t)&&ko(e,n)){var r=t._index;t._index=n._index,e[t._index]=t,n._index=r,e[n._index]=n}};const Do=Lo;let Uo=class{constructor(e){this.priorities=[],this.equals=e&&e.equals||null}get length(){return this.priorities.reduce(Yo,0)}[Symbol.iterator](){return new Ko(this)}head(){for(let e=this.priorities.length-1;e>=0;e--){const t=this.priorities[e];if(t.length)return Mo(t,0)}return null}tail(){for(let e=0;e<this.priorities.length;e++){const t=this.priorities[e];if(t.length)return Mo(t,0)}return null}prev(e){return e?To(this.priorities,e,1):this.tail()}next(e){return e?To(this.priorities,e,-1):this.head()}shift(){return this.remove(this.head())}pop(){return this.remove(this.tail())}add(e){const t=e.priority||0;for(;t>=this.priorities.length;)this.priorities.push([]);return Do.add(this.priorities[t],e),e}remove(e){return e&&(void 0!==e._index||(e=this.find(e)))?Do.remove(this.priorities[e.priority||0],e):null}has(e){if(void 0===e._index)return this.find(e);const t=e.priority||0;return!(t>=this.priorities.length)&&Do.has(this.priorities[t],e)}find(e){if(void 0!==e._index)return e;const t=e.priority||0,n=this.priorities;if(t>=n.length)return null;const r=n[t];for(let t=0;t<r.length;t++)if(this.equals(r[t],e))return r[t];return null}},Ko=class{constructor(e){this.prev=null,this.queue=e}next(){const e=this.queue.next(this.prev);return this.prev=e,{done:!e,value:e}}};function Mo(e,t){const n=t+Math.floor(Math.random()*(e.length-t));return Do.swap(e,e[n],e[t]),e[t]}function To(e,t,n){let r=t.priority||0,i=(t._index||0)+1;for(;;){if(r<0||r>=e.length)return null;const t=e[r];if(!(i>=t.length))return Mo(t,i);r+=n,i=0}}function Yo(e,t){return e+t.length}const No=I;Oo.all=function(e){let t=0;for(let n=0;n<e.length;n++){const r=e[n];t+=null===r||r.buffer.byteLength===r.byteLength?0:r.byteLength}const n=No.allocUnsafeSlow(t),r=new Array(e.length);let i=0;for(let t=0;t<e.length;t++){let s=e[t];null!==s&&s.buffer.byteLength!==s.byteLength&&(n.set(s,i),s=n.subarray(i,i+=s.byteLength)),r[t]=s}return r},Oo.is=function(e){return e.buffer.byteLength!==e.byteLength};var Po=Oo;function Oo(e){if(null===e||e.buffer.byteLength===e.byteLength)return e;const t=No.allocUnsafeSlow(e.byteLength);return t.set(e,0),t}var Fo=function(e){if(function(e){return!!e&&(e instanceof TypeError||e instanceof SyntaxError||e instanceof ReferenceError||e instanceof EvalError||e instanceof RangeError||e instanceof URIError||"ERR_ASSERTION"===e.code)}(e))throw function(e){queueMicrotask((()=>{throw e}))}(e),e};function Ho(){}function Ro(){Ro.init.call(this)}function Go(e){return void 0===e._maxListeners?Ro.defaultMaxListeners:e._maxListeners}function Vo(e,t,n,r){var i,s,o,a;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if((s=e._events)?(s.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),s=e._events),o=s[t]):(s=e._events=new Ho,e._eventsCount=0),o){if("function"==typeof o?o=s[t]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),!o.warned&&(i=Go(e))&&i>0&&o.length>i){o.warned=!0;var h=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");h.name="MaxListenersExceededWarning",h.emitter=e,h.type=t,h.count=o.length,a=h,"function"==typeof console.warn?console.warn(a):console.log(a)}}else o=s[t]=n,++e._eventsCount;return e}function qo(e,t,n){var r=!1;function i(){e.removeListener(t,i),r||(r=!0,n.apply(e,arguments))}return i.listener=n,i}function Jo(e){var t=this._events;if(t){var n=t[e];if("function"==typeof n)return 1;if(n)return n.length}return 0}function jo(e,t){for(var n=new Array(t);t--;)n[t]=e[t];return n}Ho.prototype=Object.create(null),Ro.EventEmitter=Ro,Ro.usingDomains=!1,Ro.prototype.domain=void 0,Ro.prototype._events=void 0,Ro.prototype._maxListeners=void 0,Ro.defaultMaxListeners=10,Ro.init=function(){this.domain=null,Ro.usingDomains&&(void 0).active,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new Ho,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Ro.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},Ro.prototype.getMaxListeners=function(){return Go(this)},Ro.prototype.emit=function(e){var t,n,r,i,s,o,a,h="error"===e;if(o=this._events)h=h&&null==o.error;else if(!h)return!1;if(a=this.domain,h){if(t=arguments[1],!a){if(t instanceof Error)throw t;var c=new Error('Uncaught, unspecified "error" event. ('+t+")");throw c.context=t,c}return t||(t=new Error('Uncaught, unspecified "error" event')),t.domainEmitter=this,t.domain=a,t.domainThrown=!1,a.emit("error",t),!1}if(!(n=o[e]))return!1;var u="function"==typeof n;switch(r=arguments.length){case 1:!function(e,t,n){if(t)e.call(n);else for(var r=e.length,i=jo(e,r),s=0;s<r;++s)i[s].call(n)}(n,u,this);break;case 2:!function(e,t,n,r){if(t)e.call(n,r);else for(var i=e.length,s=jo(e,i),o=0;o<i;++o)s[o].call(n,r)}(n,u,this,arguments[1]);break;case 3:!function(e,t,n,r,i){if(t)e.call(n,r,i);else for(var s=e.length,o=jo(e,s),a=0;a<s;++a)o[a].call(n,r,i)}(n,u,this,arguments[1],arguments[2]);break;case 4:!function(e,t,n,r,i,s){if(t)e.call(n,r,i,s);else for(var o=e.length,a=jo(e,o),h=0;h<o;++h)a[h].call(n,r,i,s)}(n,u,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(r-1),s=1;s<r;s++)i[s-1]=arguments[s];!function(e,t,n,r){if(t)e.apply(n,r);else for(var i=e.length,s=jo(e,i),o=0;o<i;++o)s[o].apply(n,r)}(n,u,this,i)}return!0},Ro.prototype.addListener=function(e,t){return Vo(this,e,t,!1)},Ro.prototype.on=Ro.prototype.addListener,Ro.prototype.prependListener=function(e,t){return Vo(this,e,t,!0)},Ro.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,qo(this,e,t)),this},Ro.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,qo(this,e,t)),this},Ro.prototype.removeListener=function(e,t){var n,r,i,s,o;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(r=this._events))return this;if(!(n=r[e]))return this;if(n===t||n.listener&&n.listener===t)0==--this._eventsCount?this._events=new Ho:(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,s=n.length;s-- >0;)if(n[s]===t||n[s].listener&&n[s].listener===t){o=n[s].listener,i=s;break}if(i<0)return this;if(1===n.length){if(n[0]=void 0,0==--this._eventsCount)return this._events=new Ho,this;delete r[e]}else!function(e,t){for(var n=t,r=n+1,i=e.length;r<i;n+=1,r+=1)e[n]=e[r];e.pop()}(n,i);r.removeListener&&this.emit("removeListener",e,o||t)}return this},Ro.prototype.off=function(e,t){return this.removeListener(e,t)},Ro.prototype.removeAllListeners=function(e){var t,n;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=new Ho,this._eventsCount=0):n[e]&&(0==--this._eventsCount?this._events=new Ho:delete n[e]),this;if(0===arguments.length){for(var r,i=Object.keys(n),s=0;s<i.length;++s)"removeListener"!==(r=i[s])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=new Ho,this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(t)do{this.removeListener(e,t[t.length-1])}while(t[0]);return this},Ro.prototype.listeners=function(e){var t,n=this._events;return n&&(t=n[e])?"function"==typeof t?[t.listener||t]:function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(t):[]},Ro.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):Jo.call(e,t)},Ro.prototype.listenerCount=Jo,Ro.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var Wo=function(e){return e&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}(Object.freeze({__proto__:null,default:Ro,EventEmitter:Ro}));const{EventEmitter:zo}=Wo,Xo=Co,Zo=Po,$o=class{constructor(e,t){this._time=e,this._fn=t,this._interval=null,this._next=[],this._pending=[],this._destroyed=!1}destroy(){this._destroyed||(this._destroyed=!0,clearInterval(this._interval),this._interval=null)}_ontick(){(this._next.length||this._pending.length)&&(this._next.length&&this._fn(this._next),this._next=this._pending,this._pending=[])}add(e){this._destroyed||(this._interval||(this._interval=setInterval(this._ontick.bind(this),Math.floor(.66*this._time))),this._pending.push(e))}},ea=1e3+Math.round(500*Math.random()),ta=5e3+Math.round(1e3*Math.random()),na=15e3+Math.round(2e3*Math.random()),ra=6e5+Math.round(12e4*Math.random()),ia=Co;var sa=class{constructor(){this._byPublicKey=new Map}[Symbol.iterator](){return this._byPublicKey.values()}get size(){return this._byPublicKey.size}has(e){return this._byPublicKey.has(ia.toString(e,"hex"))}get(e){return this._byPublicKey.get(ia.toString(e,"hex"))}add(e){this._byPublicKey.set(ia.toString(e.remotePublicKey,"hex"),e)}delete(e){const t=ia.toString(e.remotePublicKey,"hex");this._byPublicKey.get(t)===e&&this._byPublicKey.delete(t)}};const oa=Fo,aa=Co;let ha=class{constructor(e){this.discovery=e,this.isClient=!1,this.isServer=!1,this.destroyed=!1}get swarm(){return this.discovery.swarm}get topic(){return this.discovery.topic}async refresh({client:e=this.isClient,server:t=this.isServer}={}){if(this.destroyed)throw new Error("PeerDiscovery is destroyed");if(!e&&!t)throw new Error("Cannot refresh with neither client nor server option");return e!==this.isClient&&(this.isClient=e,this.discovery._clientSessions+=e?1:-1),t!==this.isServer&&(this.isServer=t,this.discovery._serverSessions+=t?1:-1),this.discovery.refresh()}async flushed(){return this.discovery.flushed()}async destroy(){if(this.destroyed)return;this.destroyed=!0,this.isClient&&this.discovery._clientSessions--,this.isServer&&this.discovery._serverSessions--;const e=this.discovery._sessions.indexOf(this),t=this.discovery._sessions.pop();return t!==this&&(this.discovery._sessions[e]=t),this.discovery._destroyMaybe()}};function ca(e,t,n){for(let r=0;r<t;r++){const t=e[r];if(t.id&&aa.equals(t.id,n.id))return!0}return!1}function ua(){}const{EventEmitter:la}=Wo,da=class{constructor(){throw new Error("hyperdht is not supported in browsers")}static keyPair(e){return xo(e)}static hash(e){return vo(e)}},fa=e=>new Uo(e),Aa=Co,ga=Po,pa=class extends zo{constructor({publicKey:e,relayAddresses:t}){super(),this.publicKey=Zo(e),this.relayAddresses=t,this.reconnecting=!0,this.proven=!1,this.connectedTime=-1,this.banned=!1,this.tried=!1,this.explicit=!1,this.waiting=!1,this.forceRelaying=!1,this.queued=!1,this.client=!1,this.topics=[],this.attempts=0,this.priority=2,this._index=0,this._flushTick=0,this._seenTopics=new Set}get server(){return!this.client}get prioritized(){return this.priority>=2}_getPriority(){return this.tried&&!this.proven||this.attempts>3?0:3===this.attempts?1:2===this.attempts?3:1===this.attempts?4:2}_connected(){this.proven=!0,this.connectedTime=Date.now()}_disconnected(){this.connectedTime>-1&&(Date.now()-this.connectedTime>=15e3&&(this.attempts=0),this.connectedTime=-1),this.attempts++}_deprioritize(){this.attempts=3}_reset(){this.client=!1,this.proven=!1,this.tried=!1,this.attempts=0}_updatePriority(){return this.explicit&&this.attempts>3&&this._deprioritize(),!(this.banned||this.queued||this.attempts>3||(this.priority=this._getPriority(),0))}_topic(e){const t=Xo.toString(e,"hex");this._seenTopics.has(t)||(this._seenTopics.add(t),this.topics.push(e),this.emit("topic",e))}reconnect(e){this.reconnecting=!!e}ban(e){this.banned=!!e}shouldGC(){return!(this.banned||this.queued||this.explicit||this.waiting)}},ya=class{constructor(e,{backoffs:t=[ea,ta,na,ra],jitter:n=500}={}){this.jitter=n,this.backoffs=t,this._sTimer=new $o(t[0]+Math.round(n*Math.random()),e),this._mTimer=new $o(t[1]+Math.round(n*Math.random()),e),this._lTimer=new $o(t[2]+Math.round(n*Math.random()),e),this._xTimer=new $o(t[3]+Math.round(n*Math.random()),e)}_selectRetryTimer(e){if(e.banned||!e.reconnecting)return null;if(e.attempts>3)return e.explicit?this._xTimer:null;if(0===e.attempts)return this._sTimer;if(e.proven)switch(e.attempts){case 1:return this._sTimer;case 2:return this._mTimer;case 3:return this._lTimer}else switch(e.attempts){case 1:return this._mTimer;case 2:case 3:return this._lTimer}return null}add(e){const t=this._selectRetryTimer(e);return!!t&&(t.add(e),!0)}destroy(){this._sTimer.destroy(),this._mTimer.destroy(),this._lTimer.destroy(),this._xTimer.destroy()}},_a=sa,ba=class{constructor(e,t,{wait:n=null,suspended:r=!1,onpeer:i=ua,onerror:s=oa}){this.swarm=e,this.topic=t,this.isClient=!1,this.isServer=!1,this.destroyed=!1,this.destroying=null,this.suspended=r,this._sessions=[],this._clientSessions=0,this._serverSessions=0,this._onpeer=i,this._onerror=s,this._activeQuery=null,this._timer=null,this._currentRefresh=null,this._closestNodes=null,this._firstAnnounce=!0,this._needsUnannounce=!1,this._refreshes=0,this._wait=n}session({server:e=!0,client:t=!0,onerror:n=oa}){if(this.destroyed)throw new Error("PeerDiscovery is destroyed");const r=new ha(this);return r.refresh({server:e,client:t}).catch(n),this._sessions.push(r),r}_refreshLater(e){const t=Math.round(12e4*Math.random()),n=e?t:6e5+t;this._timer&&clearTimeout(this._timer);const r=Date.now();this._timer=setTimeout((()=>{Date.now()-r>n+3e4?this._refreshLater(!0):this.refresh().catch(this._onerror)}),n)}_isActive(){return!this.destroyed&&!this.suspended}async _refresh(){if(this.suspended)return;const e=++this._refreshes;if(this._wait&&(await this._wait,this._wait=null,e!==this._refreshes||!this._isActive()))return;const t=this.isServer&&this._firstAnnounce;t&&(this._firstAnnounce=!1);const n={clear:t,closestNodes:this._closestNodes};if(this.isServer){if(await this.swarm.listen(),e!==this._refreshes||!this._isActive())return;this._needsUnannounce=!0}const r=this.isServer,i=this._activeQuery=r?this.swarm.dht.announce(this.topic,this.swarm.keyPair,this.swarm.server.relayAddresses,n):this._needsUnannounce?this.swarm.dht.lookupAndUnannounce(this.topic,this.swarm.keyPair,n):this.swarm.dht.lookup(this.topic,n);try{for await(const e of this._activeQuery)if(this.isClient&&this._isActive())for(const t of e.peers)this._onpeer(t,e)}catch(e){if(this._isActive())throw e}finally{this._activeQuery===i&&(this._activeQuery=null,this.destroyed||this.suspended||this._refreshLater(!1))}this._closestNodes=i.closestNodes,e===this._refreshes&&(r||(this._needsUnannounce=!1))}async refresh(){if(this.destroyed)throw new Error("PeerDiscovery is destroyed");const e=this._serverSessions>0,t=this._clientSessions>0;if(this.suspended)return;if(e===this.isServer&&t===this.isClient){if(this._currentRefresh)return this._currentRefresh;this._currentRefresh=this._refresh()}else this._activeQuery&&this._activeQuery.destroy(),this.isServer=e,this.isClient=t,this._currentRefresh=this._refresh();const n=this._currentRefresh;try{await n}finally{n===this._currentRefresh&&(this._currentRefresh=null)}}async flushed(){this.swarm.listening&&await this.swarm.listening;try{return await this._currentRefresh,!0}catch{return!1}}async _destroyMaybe(){if(!this.destroyed)try{0===this._sessions.length?await this.swarm.leave(this.topic):0===this._serverSessions&&this._needsUnannounce&&await this.refresh()}catch(e){oa(e)}}destroy(){return this.destroying||(this.destroying=this._destroy()),this.destroying}async _abort(){this._wait&&await this._wait,this._activeQuery&&(this._activeQuery.destroy(),this._activeQuery=null),this._timer&&(clearTimeout(this._timer),this._timer=null);let e=this._closestNodes;if(this._currentRefresh)try{await this._currentRefresh}catch{}if(!this._isActive()){if(e){if(this._closestNodes!==e){const t=e.length;for(const n of this._closestNodes)n.id&&!ca(e,t,n)&&e.push(n)}}else e=this._closestNodes;this._needsUnannounce&&(e&&e.length&&await this.swarm.dht.unannounce(this.topic,this.swarm.keyPair,{closestNodes:e,onlyClosestNodes:!0}),this._needsUnannounce=!1)}}_destroy(){if(!this.destroyed)return this.destroyed=!0,this._abort()}async suspend(){if(!this.suspended)return this.suspended=!0,this._abort()}resume(){this.suspended&&(this.suspended=!1,this.refresh().catch(ua))}},Ia=64,Ea=3,ma=1/0,wa=1/0,Ca="Topic is required and must be a 32-byte buffer",Sa="Duplicate connection";var Ba=class extends la{constructor(e={}){super();const{seed:t,relayThrough:n,keyPair:r=da.keyPair(t),maxPeers:i=Ia,maxClientConnections:s=ma,maxServerConnections:o=wa,maxParallel:a=Ea,firewall:h=va}=e;this.keyPair=r,this.dht=e.dht||new da({bootstrap:e.bootstrap,nodes:e.nodes}),this.server=this.dht.createServer({firewall:this._handleFirewall.bind(this),relayThrough:this._maybeRelayConnection.bind(this)},this._handleServerConnection.bind(this)),this.destroyed=!1,this.suspended=!1,this.maxPeers=i,this.maxClientConnections=s,this.maxServerConnections=o,this.maxParallel=a,this.relayThrough=n||null,this.connecting=0,this.connections=new Set,this.peers=new Map,this.explicitPeers=new Set,this.listening=null,this.stats={updates:0,connects:{client:{opened:0,closed:0,attempted:0},server:{opened:0,closed:0}}},this._discovery=new Map,this._timer=new ya(this._requeue.bind(this),{backoffs:e.backoffs,jitter:e.jitter}),this._queue=fa(),this._allConnections=new _a,this._pendingFlushes=[],this._flushTick=0,this._drainingQueue=!1,this._clientConnections=0,this._serverConnections=0,this._firewall=h,this.dht.on("network-change",this._handleNetworkChange.bind(this)),this.on("update",this._handleUpdate)}_maybeRelayConnection(e){return this.relayThrough?this.relayThrough(e):null}_enqueue(e){e.queued||(e.queued=!0,e._flushTick=this._flushTick,this._queue.add(e),this._attemptClientConnections())}_requeue(e){if(!this.suspended){for(const t of e)t.waiting=!1,!1===t._updatePriority()||this._allConnections.has(t.publicKey)||t.queued||(t.queued=!0,t._flushTick=this._flushTick,this._queue.add(t));this._attemptClientConnections()}}_flushMaybe(e){for(let t=0;t<this._pendingFlushes.length;t++){const n=this._pendingFlushes[t];e._flushTick>n.tick||--n.missing>0||(n.onflush(!0),this._pendingFlushes.splice(t--,1))}}_flushAllMaybe(){if(this.connecting>0||this._allConnections.size<this.maxPeers&&this._clientConnections<this.maxClientConnections)return!1;for(;this._pendingFlushes.length;)this._pendingFlushes.pop().onflush(!0);return!0}_shouldConnect(){return!this.destroyed&&!this.suspended&&this.connecting<this.maxParallel&&this._allConnections.size<this.maxPeers&&this._clientConnections<this.maxClientConnections}_shouldRequeue(e){if(this.suspended)return!1;if(e.explicit)return!0;for(const t of e.topics)if(this._discovery.has(Aa.toString(t,"hex"))&&!this.destroyed)return!0;return!1}_connect(e){if(e.banned||this._allConnections.has(e.publicKey))return void this._flushMaybe(e);if(this._handleFirewall(e.publicKey,null))return e.ban(!0),void this._flushMaybe(e);const t=this._maybeRelayConnection(e.forceRelaying),n=this.dht.connect(e.publicKey,{relayAddresses:e.relayAddresses,keyPair:this.keyPair,relayThrough:t});this._allConnections.add(n),this.stats.connects.client.attempted++,this.connecting++,this._clientConnections++;let r=!1;const i=t=>{var n;this.relayThrough&&("HOLEPUNCH_ABORTED"===(n=t.code)||"HOLEPUNCH_DOUBLE_RANDOMIZED_NATS"===n||"REMOTE_NOT_HOLEPUNCHABLE"===n)&&(e.forceRelaying=!0,e.attempts=0)};n.on("error",i),n.on("open",(()=>{r=!0,this.stats.connects.client.opened++,this._connectDone(),this.connections.add(n),n.removeListener("error",i),e._connected(),e.client=!0,this.emit("connection",n,e),this._flushMaybe(e),this.emit("update")})),n.on("close",(()=>{r||this._connectDone(),this.stats.connects.client.closed++,this.connections.delete(n),this._allConnections.delete(n),this._clientConnections--,e._disconnected(),e.waiting=this._shouldRequeue(e)&&this._timer.add(e),this._maybeDeletePeer(e),r||this._flushMaybe(e),this._attemptClientConnections(),this.emit("update")})),this.emit("update")}_connectDone(){this.connecting--,this.connecting<this.maxParallel&&this._attemptClientConnections(),0===this.connecting&&this._flushAllMaybe()}_attemptClientConnections(){if(!this._drainingQueue){for(this._drainingQueue=!0;this._queue.length&&this._shouldConnect();){const e=this._queue.shift();e.queued=!1,this._connect(e)}this._drainingQueue=!1,0===this.connecting&&this._flushAllMaybe()}}_handleFirewall(e,t){if(this.suspended)return!0;if(Aa.equals(e,this.keyPair.publicKey))return!0;const n=this.peers.get(Aa.toString(e,"hex"));return!(!n||!n.banned)||this._firewall(e,t)}_handleServerConnectionSwap(e,t){let n=!1;function r(){n=!0}e.on("close",(()=>{n||(t.removeListener("error",Qa),t.removeListener("close",r),this._handleServerConnection(t))})),t.on("error",Qa),t.on("close",r)}_handleServerConnection(e){if(this.destroyed)return e.on("error",Qa),e.destroy("Swarm has been destroyed");const t=this._allConnections.get(e.remotePublicKey);if(t){const n=t.rawBytesRead>0&&t.rawBytesWritten>0,r=Aa.compare(e.publicKey,e.remotePublicKey)>0;return!1===(n||r===e.isInitiator)?(t.sendKeepAlive(),e.on("error",Qa),void e.destroy(new Error(Sa))):(t.on("error",Qa),t.destroy(new Error(Sa)),void this._handleServerConnectionSwap(t,e))}this.stats.connects.server.opened++;const n=this._upsertPeer(e.remotePublicKey,null);this.connections.add(e),this._allConnections.add(e),this._serverConnections++,e.on("close",(()=>{this.connections.delete(e),this._allConnections.delete(e),this._serverConnections--,this.stats.connects.server.closed++,this._maybeDeletePeer(n),this._attemptClientConnections(),this.emit("update")})),n.client=!1,this.emit("connection",e,n),this.emit("update")}_upsertPeer(e,t){if(Aa.equals(e,this.keyPair.publicKey))return null;const n=Aa.toString(e,"hex");let r=this.peers.get(n);return r?(r.relayAddresses=t,r):(r=new pa({publicKey:e,relayAddresses:t}),this.peers.set(n,r),r)}_handleUpdate(){this.stats.updates++}_maybeDeletePeer(e){if(!e.shouldGC())return;if(this._allConnections.has(e.publicKey))return;const t=Aa.toString(e.publicKey,"hex");this.peers.delete(t)}_handlePeer(e,t){const n=this._upsertPeer(e.publicKey,e.relayAddresses);n&&n._topic(t),n&&!this._allConnections.has(e.publicKey)&&(n.prioritized&&!n.server||n._reset(),n._updatePriority()&&this._enqueue(n))}async _handleNetworkChange(){for(const e of this._allConnections)e.sendKeepAlive();const e=[];for(const t of this._discovery.values())e.push(t.refresh());await Promise.allSettled(e)}status(e){return this._discovery.get(Aa.toString(e,"hex"))||null}listen(){return this.listening||(this.listening=this.server.listen(this.keyPair)),this.listening}join(e,t={}){if(!e)throw new Error(Ca);e=ga(e);const n=Aa.toString(e,"hex");let r=this._discovery.get(n);return r&&!r.destroyed||(r=new ba(this,e,{wait:r?r.destroy():null,suspended:this.suspended,onpeer:t=>this._handlePeer(t,e)}),this._discovery.set(n,r)),r.session(t)}async leave(e){if(!e)throw new Error(Ca);const t=Aa.toString(e,"hex");if(!this._discovery.has(t))return Promise.resolve();const n=this._discovery.get(t);await n.destroy(),this._discovery.get(t)===n&&this._discovery.delete(t)}joinPeer(e){const t=this._upsertPeer(e,null);t&&(this.explicitPeers.has(t)||(t.explicit=!0,this.explicitPeers.add(t)),this._allConnections.has(e)||t._updatePriority()&&this._enqueue(t))}leavePeer(e){const t=Aa.toString(e,"hex");if(!this.peers.has(t))return;const n=this.peers.get(t);n.explicit=!1,this.explicitPeers.delete(n),this._maybeDeletePeer(n)}async flush(){const e=[...this._discovery.values()].map((e=>e.flushed()));if(await Promise.all(e),this._flushAllMaybe())return!0;const t=this._allConnections.size-this.connections.size;return!this._queue.length&&!t||new Promise((e=>{this._pendingFlushes.push({onflush:e,missing:this._queue.length+t,tick:this._flushTick++})}))}async clear(){const e=Promise.allSettled([...this._discovery.values()].map((e=>e.destroy())));return this._discovery.clear(),e}async destroy({force:e}={}){if(!this.destroyed||e){for(this.destroyed=!0,this._timer.destroy(),e||await this.clear(),await this.server.close();this._pendingFlushes.length;)this._pendingFlushes.pop().onflush(!1);await this.dht.destroy({force:e})}}async suspend(){if(this.suspended)return;const e=[];e.push(this.server.suspend());for(const t of this._discovery.values())e.push(t.suspend());for(const e of this._allConnections)e.destroy();this.suspended=!0,await Promise.allSettled(e),await this.dht.suspend()}async resume(){if(this.suspended){await this.dht.resume(),await this.server.resume();for(const e of this._discovery.values())e.resume();this._attemptClientConnections(),this.suspended=!1}}topics(){return this._discovery.values()}};function Qa(){}function va(){return!1}var xa={RTCPeerConnection:window.RTCPeerConnection,RTCIceCandidate:window.RTCIceCandidate},La={},ka={};const Da=ka.LE=255===new Uint8Array(new Uint16Array([255]).buffer)[0];ka.BE=!Da;var Ua={exports:{}};!function(e,t){const n=I,{BE:r}=ka;t=e.exports={preencode(e,t){e.end+=t.byteLength},encode(e,t){e.buffer.set(t,e.start),e.start+=t.byteLength},decode(e){const t=e.buffer.subarray(e.start,e.end);return e.start=e.end,t}};const i=t.buffer={preencode(e,t){t?o.preencode(e,t):e.end++},encode(e,t){t?o.encode(e,t):e.buffer[e.start++]=0},decode(e){const t=e.buffer.subarray(e.start);return 0===t.byteLength?null:(e.start=e.end,t)}};function s(e,t){const n=e.BYTES_PER_ELEMENT;return{preencode(e,t){e.end+=t.byteLength},encode(e,n){const i=new Uint8Array(n.buffer,n.byteOffset,n.byteLength);r&&t&&t(i),e.buffer.set(i,e.start),e.start+=n.byteLength},decode(i){let s=i.buffer.subarray(i.start);return s.byteOffset%n!=0&&(s=new Uint8Array(s)),r&&t&&t(s),i.start=i.end,new e(s.buffer,s.byteOffset,s.byteLength/n)}}}t.binary={...i,preencode(e,t){"string"==typeof t?h.preencode(e,t):i.preencode(e,t)},encode(e,t){"string"==typeof t?h.encode(e,t):i.encode(e,t)}},t.arraybuffer={preencode(e,t){e.end+=t.byteLength},encode(e,t){const n=new Uint8Array(t);e.buffer.set(n,e.start),e.start+=t.byteLength},decode(e){const t=new ArrayBuffer(e.end-e.start);return new Uint8Array(t).set(e.buffer.subarray(e.start)),e.start=e.end,t}};const o=t.uint8array=s(Uint8Array);function a(e){return{preencode(t,r){t.end+=n.byteLength(r,e)},encode(t,r){t.start+=n.write(t.buffer,r,t.start,e)},decode(t){const r=n.toString(t.buffer,e,t.start);return t.start=t.end,r}}}t.uint16array=s(Uint16Array,n.swap16),t.uint32array=s(Uint32Array,n.swap32),t.int8array=s(Int8Array),t.int16array=s(Int16Array,n.swap16),t.int32array=s(Int32Array,n.swap32),t.biguint64array=s(BigUint64Array,n.swap64),t.bigint64array=s(BigInt64Array,n.swap64),t.float32array=s(Float32Array,n.swap32),t.float64array=s(Float64Array,n.swap64);const h=t.string=t.utf8=a("utf-8");t.ascii=a("ascii"),t.hex=a("hex"),t.base64=a("base64"),t.ucs2=t.utf16le=a("utf16le"),t.array=function(e){return{preencode(t,n){for(const r of n)e.preencode(t,r)},encode(t,n){for(const r of n)e.encode(t,r)},decode(t){const n=[];for(;t.start<t.end;)n.push(e.decode(t));return n}}},t.json={preencode(e,t){h.preencode(e,JSON.stringify(t))},encode(e,t){h.encode(e,JSON.stringify(t))},decode:e=>JSON.parse(h.decode(e))},t.ndjson={preencode(e,t){h.preencode(e,JSON.stringify(t)+"\n")},encode(e,t){h.encode(e,JSON.stringify(t)+"\n")},decode:e=>JSON.parse(h.decode(e))}}(Ua,Ua.exports);var Ka={preencode:function e(t,n){if(n<251)t.end++;else if(n<256)t.end+=2;else if(n<65536)t.end+=3;else if(n<16777216)t.end+=4;else if(n<4294967296)t.end+=5;else{t.end++;e(t,Math.floor(Math.log(n)/Math.log(2))-32),t.end+=6}},encode:function e(t,n){const r=n-251;if(n<251)t.buffer[t.start++]=n;else if(n<256)t.buffer[t.start++]=251,t.buffer[t.start++]=r;else if(n<65536)t.buffer[t.start++]=252,t.buffer[t.start++]=r>>8&255,t.buffer[t.start++]=255&r;else if(n<16777216)t.buffer[t.start++]=253,t.buffer[t.start++]=r>>16,t.buffer[t.start++]=r>>8&255,t.buffer[t.start++]=255&r;else if(n<4294967296)t.buffer[t.start++]=254,t.buffer[t.start++]=r>>24,t.buffer[t.start++]=r>>16&255,t.buffer[t.start++]=r>>8&255,t.buffer[t.start++]=255&r;else{const n=Math.floor(Math.log(r)/Math.log(2))-32;t.buffer[t.start++]=255,e(t,n);const i=r/Math.pow(2,n-11);for(let e=5;e>=0;e--)t.buffer[t.start++]=i/Math.pow(2,8*e)&255}},decode:function e(t){const n=251;if(t.end-t.start<1)throw new Error("Out of bounds");const r=t.buffer[t.start++];if(r<n)return r;if(t.end-t.start<r-n+1)throw new Error("Out of bounds.");if(r<252)return t.buffer[t.start++]+n;if(r<253)return(t.buffer[t.start++]<<8)+t.buffer[t.start++]+n;if(r<254)return(t.buffer[t.start++]<<16)+(t.buffer[t.start++]<<8)+t.buffer[t.start++]+n;if(r<255)return 16777216*t.buffer[t.start++]+(t.buffer[t.start++]<<16)+(t.buffer[t.start++]<<8)+t.buffer[t.start++]+n;const i=e(t);if(t.end-t.start<6)throw new Error("Out of bounds");let s=0;for(let e=5;e>=0;e--)s+=t.buffer[t.start++]*Math.pow(2,8*e);return s*Math.pow(2,i-11)+n}};!function(e){const t=I,{BE:n}=ka;e.state=function(e=0,t=0,n=null){return{start:e,end:t,buffer:n,cache:null}};const r=e.raw=Ua.exports,i=e.uint={preencode(e,t){e.end+=t<=252?1:t<=65535?3:t<=4294967295?5:9},encode(e,t){t<=252?s.encode(e,t):t<=65535?(e.buffer[e.start++]=253,o.encode(e,t)):t<=4294967295?(e.buffer[e.start++]=254,h.encode(e,t)):(e.buffer[e.start++]=255,d.encode(e,t))},decode(e){const t=s.decode(e);return t<=252?t:253===t?o.decode(e):254===t?h.decode(e):d.decode(e)}},s=e.uint8={preencode(e,t){e.end+=1},encode(e,t){e.buffer[e.start++]=t},decode(e){if(e.start>=e.end)throw new Error("Out of bounds");return e.buffer[e.start++]}},o=e.uint16={preencode(e,t){e.end+=2},encode(e,t){e.buffer[e.start++]=t,e.buffer[e.start++]=t>>>8},decode(e){if(e.end-e.start<2)throw new Error("Out of bounds");return e.buffer[e.start++]+256*e.buffer[e.start++]}},a=e.uint24={preencode(e,t){e.end+=3},encode(e,t){e.buffer[e.start++]=t,e.buffer[e.start++]=t>>>8,e.buffer[e.start++]=t>>>16},decode(e){if(e.end-e.start<3)throw new Error("Out of bounds");return e.buffer[e.start++]+256*e.buffer[e.start++]+65536*e.buffer[e.start++]}},h=e.uint32={preencode(e,t){e.end+=4},encode(e,t){e.buffer[e.start++]=t,e.buffer[e.start++]=t>>>8,e.buffer[e.start++]=t>>>16,e.buffer[e.start++]=t>>>24},decode(e){if(e.end-e.start<4)throw new Error("Out of bounds");return e.buffer[e.start++]+256*e.buffer[e.start++]+65536*e.buffer[e.start++]+16777216*e.buffer[e.start++]}},c=e.uint40={preencode(e,t){e.end+=5},encode(e,t){const n=Math.floor(t/256);s.encode(e,t),h.encode(e,n)},decode(e){if(e.end-e.start<5)throw new Error("Out of bounds");return s.decode(e)+256*h.decode(e)}},u=e.uint48={preencode(e,t){e.end+=6},encode(e,t){const n=Math.floor(t/65536);o.encode(e,t),h.encode(e,n)},decode(e){if(e.end-e.start<6)throw new Error("Out of bounds");return o.decode(e)+65536*h.decode(e)}},l=e.uint56={preencode(e,t){e.end+=7},encode(e,t){const n=Math.floor(t/16777216);a.encode(e,t),h.encode(e,n)},decode(e){if(e.end-e.start<7)throw new Error("Out of bounds");return a.decode(e)+16777216*h.decode(e)}},d=e.uint64={preencode(e,t){e.end+=8},encode(e,t){const n=Math.floor(t/4294967296);h.encode(e,t),h.encode(e,n)},decode(e){if(e.end-e.start<8)throw new Error("Out of bounds");return h.decode(e)+4294967296*h.decode(e)}};e.int=Q(i),e.int8=Q(s),e.int16=Q(o),e.int24=Q(a),e.int32=Q(h),e.int40=Q(c),e.int48=Q(u),e.int56=Q(l),e.int64=Q(d);const f=e.biguint64={preencode(e,t){e.end+=8},encode(e,t){new DataView(e.buffer.buffer,e.start+e.buffer.byteOffset,8).setBigUint64(0,t,!0),e.start+=8},decode(e){if(e.end-e.start<8)throw new Error("Out of bounds");const t=new DataView(e.buffer.buffer,e.start+e.buffer.byteOffset,8).getBigUint64(0,!0);return e.start+=8,t}};e.bigint64=x(f);const A=e.biguint={preencode(e,t){let n=0;for(let e=t;e;e>>=64n)n++;i.preencode(e,n),e.end+=8*n},encode(e,t){let n=0;for(let e=t;e;e>>=64n)n++;i.encode(e,n);const r=new DataView(e.buffer.buffer,e.start+e.buffer.byteOffset,8*n);for(let e=t,n=0;e;e>>=64n,n+=8)r.setBigUint64(n,BigInt.asUintN(64,e),!0);e.start+=8*n},decode(e){const t=i.decode(e);if(e.end-e.start<8*t)throw new Error("Out of bounds");const n=new DataView(e.buffer.buffer,e.start+e.buffer.byteOffset,8*t);let r=0n;for(let e=t-1;e>=0;e--)r=(r<<64n)+n.getBigUint64(8*e,!0);return e.start+=8*t,r}};e.bigint=x(A),e.lexint=Ka,e.float32={preencode(e,t){e.end+=4},encode(e,t){new DataView(e.buffer.buffer,e.start+e.buffer.byteOffset,4).setFloat32(0,t,!0),e.start+=4},decode(e){if(e.end-e.start<4)throw new Error("Out of bounds");const t=new DataView(e.buffer.buffer,e.start+e.buffer.byteOffset,4).getFloat32(0,!0);return e.start+=4,t}},e.float64={preencode(e,t){e.end+=8},encode(e,t){new DataView(e.buffer.buffer,e.start+e.buffer.byteOffset,8).setFloat64(0,t,!0),e.start+=8},decode(e){if(e.end-e.start<8)throw new Error("Out of bounds");const t=new DataView(e.buffer.buffer,e.start+e.buffer.byteOffset,8).getFloat64(0,!0);return e.start+=8,t}};const g=e.buffer={preencode(e,t){t?y.preencode(e,t):e.end++},encode(e,t){t?y.encode(e,t):e.buffer[e.start++]=0},decode(e){const t=i.decode(e);if(0===t)return null;if(e.end-e.start<t)throw new Error("Out of bounds");return e.buffer.subarray(e.start,e.start+=t)}};function p(e,t){const r=e.BYTES_PER_ELEMENT;return{preencode(e,t){i.preencode(e,t.length),e.end+=t.byteLength},encode(e,r){i.encode(e,r.length);const s=new Uint8Array(r.buffer,r.byteOffset,r.byteLength);n&&t&&t(s),e.buffer.set(s,e.start),e.start+=r.byteLength},decode(s){const o=i.decode(s);let a=s.buffer.subarray(s.start,s.start+=o*r);if(a.byteLength!==o*r)throw new Error("Out of bounds");return a.byteOffset%r!=0&&(a=new Uint8Array(a)),n&&t&&t(a),new e(a.buffer,a.byteOffset,a.byteLength/r)}}}e.binary={...g,preencode(e,t){"string"==typeof t?b.preencode(e,t):g.preencode(e,t)},encode(e,t){"string"==typeof t?b.encode(e,t):g.encode(e,t)}},e.arraybuffer={preencode(e,t){i.preencode(e,t.byteLength),e.end+=t.byteLength},encode(e,t){i.encode(e,t.byteLength);const n=new Uint8Array(t);e.buffer.set(n,e.start),e.start+=t.byteLength},decode(e){const t=i.decode(e),n=new ArrayBuffer(t);return new Uint8Array(n).set(e.buffer.subarray(e.start,e.start+=t)),n}};const y=e.uint8array=p(Uint8Array);function _(e){return{preencode(n,r){const s=t.byteLength(r,e);i.preencode(n,s),n.end+=s},encode(n,r){const s=t.byteLength(r,e);i.encode(n,s),t.write(n.buffer,r,n.start,e),n.start+=s},decode(n){const r=i.decode(n);if(n.end-n.start<r)throw new Error("Out of bounds");return t.toString(n.buffer,e,n.start,n.start+=r)},fixed:n=>({preencode(e){e.end+=n},encode(r,i){t.write(r.buffer,i,r.start,n,e),r.start+=n},decode(r){if(r.end-r.start<n)throw new Error("Out of bounds");return t.toString(r.buffer,e,r.start,r.start+=n)}})}}e.uint16array=p(Uint16Array,t.swap16),e.uint32array=p(Uint32Array,t.swap32),e.int8array=p(Int8Array),e.int16array=p(Int16Array,t.swap16),e.int32array=p(Int32Array,t.swap32),e.biguint64array=p(BigUint64Array,t.swap64),e.bigint64array=p(BigInt64Array,t.swap64),e.float32array=p(Float32Array,t.swap32),e.float64array=p(Float64Array,t.swap64);const b=e.string=e.utf8=_("utf-8");e.ascii=_("ascii"),e.hex=_("hex"),e.base64=_("base64"),e.ucs2=e.utf16le=_("utf16le"),e.bool={preencode(e,t){e.end++},encode(e,t){e.buffer[e.start++]=t?1:0},decode(e){if(e.start>=e.end)throw Error("Out of bounds");return 1===e.buffer[e.start++]}};const E=e.fixed=function(e){return{preencode(t,n){t.end+=e},encode(t,n){t.buffer.set(n,t.start),t.start+=e},decode(t){if(t.end-t.start<e)throw new Error("Out of bounds");return t.buffer.subarray(t.start,t.start+=e)}}};e.fixed32=E(32),e.fixed64=E(64),e.array=function(e){return{preencode(t,n){i.preencode(t,n.length);for(let r=0;r<n.length;r++)e.preencode(t,n[r])},encode(t,n){i.encode(t,n.length);for(let r=0;r<n.length;r++)e.encode(t,n[r])},decode(t){const n=i.decode(t);if(n>1048576)throw new Error("Array is too big");const r=new Array(n);for(let i=0;i<n;i++)r[i]=e.decode(t);return r}}},e.frame=function(t){const n=e.state();return{preencode(e,n){const r=e.end;t.preencode(e,n),i.preencode(e,e.end-r)},encode(e,r){n.end=0,t.preencode(n,r),i.encode(e,n.end),t.encode(e,r)},decode(e){const n=e.end,r=i.decode(e);e.end=e.start+r;const s=t.decode(e);return e.start=e.end,e.end=n,s}}},e.json={preencode(e,t){b.preencode(e,JSON.stringify(t))},encode(e,t){b.encode(e,JSON.stringify(t))},decode:e=>JSON.parse(b.decode(e))},e.ndjson={preencode(e,t){b.preencode(e,JSON.stringify(t)+"\n")},encode(e,t){b.encode(e,JSON.stringify(t)+"\n")},decode:e=>JSON.parse(b.decode(e))},e.none={preencode(e,t){},encode(e,t){},decode:e=>null};const m={preencode(e,t){i.preencode(e,t.length);for(let n=0;n<t.length;n++)S.preencode(e,t[n])},encode(e,t){i.encode(e,t.length);for(let n=0;n<t.length;n++)S.encode(e,t[n])},decode(e){const t=[];let n=i.decode(e);for(;n-- >0;)t.push(S.decode(e));return t}},w={preencode(e,t){const n=Object.keys(t);i.preencode(e,n.length);for(const r of n)b.preencode(e,r),S.preencode(e,t[r])},encode(e,t){const n=Object.keys(t);i.encode(e,n.length);for(const r of n)b.encode(e,r),S.encode(e,t[r])},decode(e){let t=i.decode(e);const n={};for(;t-- >0;)n[b.decode(e)]=S.decode(e);return n}},C=[e.none,e.bool,e.string,e.buffer,e.uint,e.int,e.float64,m,w],S=e.any={preencode(e,t){const n=B(t);i.preencode(e,n),C[n].preencode(e,t)},encode(e,t){const n=B(t);i.encode(e,n),C[n].encode(e,t)},decode(e){const t=i.decode(e);if(t>=C.length)throw new Error("Unknown type: "+t);return C[t].decode(e)}};function B(e){if(null==e)return 0;if("boolean"==typeof e)return 1;if("string"==typeof e)return 2;if(t.isBuffer(e))return 3;if("number"==typeof e)return Number.isInteger(e)?e>=0?4:5:6;if(Array.isArray(e))return 7;if("object"==typeof e)return 8;throw new Error("Unsupported type for "+e)}function Q(e){return{preencode(t,n){e.preencode(t,v(n))},encode(t,n){e.encode(t,v(n))},decode(t){return 0===(n=e.decode(t))?n:1&n?-(n+1)/2:n/2;var n}}}function v(e){return e<0?2*-e-1:0===e?0:2*e}function x(e){return{preencode(t,n){e.preencode(t,L(n))},encode(t,n){e.encode(t,L(n))},decode(t){return 0n===(n=e.decode(t))?n:0n===(1n&n)?n/2n:-(n+1n)/2n;var n}}}function L(e){return e<0n?2n*-e-1n:0n===e?0n:2n*e}e.from=function(e){return"string"==typeof e?function(e){switch(e){case"ascii":return r.ascii;case"utf-8":case"utf8":return r.utf8;case"hex":return r.hex;case"base64":return r.base64;case"utf16-le":case"utf16le":case"ucs-2":case"ucs2":return r.ucs2;case"ndjson":return r.ndjson;case"json":return r.json;default:return r.binary}}(e):e.preencode?e:e.encodingLength?function(e){return{preencode(t,n){t.end+=e.encodingLength(n)},encode(t,n){e.encode(n,t.buffer,t.start),t.start+=e.encode.bytes},decode(t){const n=e.decode(t.buffer,t.start,t.end);return t.start+=e.decode.bytes,n}}}(e):function(e){let t=null,n=null;return{preencode(r,i){t=i,n=e.encode(i),r.end+=n.byteLength},encode(i,s){r.encode(i,s===t?n:e.encode(s)),t=n=null},decode:t=>e.decode(r.decode(t))}}(e)},e.encode=function(n,r){const i=e.state();return n.preencode(i,r),i.buffer=t.allocUnsafe(i.end),n.encode(i,r),i.buffer},e.decode=function(t,n){return t.decode(e.state(0,n.byteLength,n))}}(La);var Ma="function"==typeof queueMicrotask?queueMicrotask:e=>Promise.resolve().then(e);const Ta=new Map,Ya=Symbol.for("hypertrace.traceFunction");let Na=class{constructor(e,t={}){if(!e)throw new Error("Context required, see hypertrace documentation");const{parent:n,props:r}=t;this.enabled=!0,this.ctx=e,this.className=e.constructor.name,this.props=r||null,this.parentObject=n?{className:n.className,id:n.objectId,props:{...n.props},ctx:n.ctx}:null;const i=Ta.get(e.constructor)||{id:0,stacktraceCache:new Map};i.id+=1,this.objectId=i.id,Ta.set(e.constructor,i)}setParent(e){this.parentObject=e?{className:e.className,id:e.objectId,props:{...e.props},ctx:e.ctx}:null}trace(e,t){const n=globalThis[Ya];if(!n)return;"string"==typeof e||(t=e,e=null);const r=Ta.get(this.ctx.constructor);let i=e&&r.stacktraceCache.get(e);i||(i=(new Error).stack,r.stacktraceCache.set(e,i));const s=i.split("\n")[2],[,o,a,h,c]=s.match(/.*at (.+) \((?:file:\/:\/)?(.+):(\d+):(\d+)\)/),u=o.split(".")[0]===this.className?o.substr(o.indexOf(".")+1):o,l={className:this.className,id:this.objectId,props:this.props&&{...this.props},ctx:this.ctx},d={functionName:u,filename:a,line:Number(h),column:Number(c),props:t&&{...t}};n({id:e||null,object:l,parentObject:this.parentObject,caller:d})}};const Pa=new class{constructor(){this.enabled=!1,this.ctx=null,this.className=null,this.props=null,this.parentObject=null,this.objectId=null}trace(){}setParent(){}};var Oa={setTraceFunction:e=>{globalThis[Ya]=e},clearTraceFunction:()=>{globalThis[Ya]=void 0},createTracer:(e,t)=>globalThis[Ya]?new Na(e,t):Pa};const Fa=I,Ha=La,Ra=Ma,Ga=Fo,{createTracer:Va}=Oa;let qa=class{constructor(e,t,n,r,i,s,o,a,h,c,u,l){this.tracer=Va(this),this.userData=n,this.protocol=r,this.aliases=i,this.id=s,this.handshake=null,this.messages=[],this.opened=!1,this.closed=!1,this.destroyed=!1,this.onopen=h,this.onclose=c,this.ondestroy=u,this.ondrain=l,this._handshake=o,this._mux=e,this._info=t,this._localId=0,this._remoteId=0,this._active=0,this._extensions=null,this._decBound=this._dec.bind(this),this._decAndDestroyBound=this._decAndDestroy.bind(this),this._openedPromise=null,this._openedResolve=null;for(const e of a)this.addMessage(e)}get drained(){return this._mux.drained}fullyOpened(){return this.opened?Promise.resolve(!0):this.closed?Promise.resolve(!1):(this._openedPromise||(this._openedPromise=new Promise((e=>{this._openedResolve=e}))),this._openedPromise)}open(e){const t=this._mux._free.length>0?this._mux._free.pop():this._mux._local.push(null)-1;this._info.opened++,this._info.lastChannel=this,this._localId=t+1,this._mux._local[t]=this,0===this._remoteId&&this._info.outgoing.push(this._localId);const n={buffer:null,start:2,end:2};Ha.uint.preencode(n,this._localId),Ha.string.preencode(n,this.protocol),Ha.buffer.preencode(n,this.id),this._handshake&&this._handshake.preencode(n,e),n.buffer=this._mux._alloc(n.end),n.buffer[0]=0,n.buffer[1]=1,Ha.uint.encode(n,this._localId),Ha.string.encode(n,this.protocol),Ha.buffer.encode(n,this.id),this._handshake&&this._handshake.encode(n,e),this._mux._write0(n.buffer)}_dec(){0==--this._active&&!0===this.closed&&this._destroy()}_decAndDestroy(e){this._dec(),this._mux._safeDestroy(e)}_fullyOpenSoon(){this._mux._remote[this._remoteId-1].session=this,Ra(this._fullyOpen.bind(this))}_fullyOpen(){if(!0===this.opened||!0===this.closed)return;const e=this._mux._remote[this._remoteId-1];this.opened=!0,this.handshake=this._handshake?this._handshake.decode(e.state):null,this._track(this.onopen(this.handshake,this)),e.session=this,e.state=null,null!==e.pending&&this._drain(e),this._resolveOpen(!0)}_resolveOpen(e){null!==this._openedResolve&&(this._openedResolve(e),this._openedResolve=this._openedPromise=null)}_drain(e){for(let t=0;t<e.pending.length;t++){const n=e.pending[t];this._mux._buffered-=za(n.state),this._recv(n.type,n.state)}e.pending=null,this._mux._resumeMaybe()}_track(e){return!0===function(e){return!(!e||"function"!=typeof e.then)}(e)?(this._active++,e.then(this._decBound,this._decAndDestroyBound)):null}_close(e){!0!==this.closed&&(this.closed=!0,this._info.opened--,this._info.lastChannel===this&&(this._info.lastChannel=null),this._remoteId>0&&(this._mux._remote[this._remoteId-1]=null,this._remoteId=0,this._mux._free.push(this._localId-1)),this._mux._local[this._localId-1]=null,this._localId=0,this._mux._gc(this._info),this._track(this.onclose(e,this)),0===this._active&&this._destroy(),this._resolveOpen(!1))}_destroy(){!0!==this.destroyed&&(this.destroyed=!0,this._track(this.ondestroy(this)))}_recv(e,t){return e<this.messages.length?this.messages[e].recv(t,this):null}cork(){this._mux.cork()}uncork(){this._mux.uncork()}close(){if(!0===this.closed)return;const e={buffer:null,start:2,end:2};Ha.uint.preencode(e,this._localId),e.buffer=this._mux._alloc(e.end),e.buffer[0]=0,e.buffer[1]=3,Ha.uint.encode(e,this._localId),this._close(!1),this._mux._write0(e.buffer)}addMessage(e){if(!e)return this._skipMessage();const t=this.messages.length,n=e.encoding||Ha.raw,r=e.onmessage||ja,i=this,s=function(e,t){const n={buffer:null,start:0,end:0};return e.preencode(n,t),n.end}(Ha.uint,t),o={type:t,encoding:n,onmessage:r,recv:(e,r)=>(i.tracer.trace("recv",{protocol:i.protocol,id:i.id,type:t}),r._track(o.onmessage(n.decode(e),r))),send(e,r=i){if(!0===r.closed)return!1;i.tracer.trace("send",{protocol:i.protocol,id:i.id,type:t});const o=r._mux,a={buffer:null,start:0,end:s};return null!==o._batch?(n.preencode(a,e),a.buffer=o._alloc(a.end),Ha.uint.encode(a,t),n.encode(a,e),o._pushBatch(r._localId,a.buffer),!0):(Ha.uint.preencode(a,r._localId),n.preencode(a,e),a.buffer=o._alloc(a.end),Ha.uint.encode(a,r._localId),Ha.uint.encode(a,t),n.encode(a,e),o.drained=o.stream.write(a.buffer),o.drained)}};return this.messages.push(o),o}_skipMessage(){const e={type:this.messages.length,encoding:Ha.raw,onmessage:ja,recv(e,t){},send(e,t){}};return this.messages.push(e),e}};var Ja=class{constructor(e,{alloc:t}={}){null===e.userData&&(e.userData=this),this.isProtomux=!0,this.stream=e,this.corked=0,this.drained=!0,this._alloc=t||("function"==typeof e.alloc?e.alloc.bind(e):Fa.allocUnsafe),this._safeDestroyBound=this._safeDestroy.bind(this),this._uncorkBound=this.uncork.bind(this),this._remoteBacklog=0,this._buffered=0,this._paused=!1,this._remote=[],this._local=[],this._free=[],this._batch=null,this._batchState=null,this._infos=new Map,this._notify=new Map,this.stream.on("data",this._ondata.bind(this)),this.stream.on("drain",this._ondrain.bind(this)),this.stream.on("end",this._onend.bind(this)),this.stream.on("error",ja),this.stream.on("close",this._shutdown.bind(this))}static from(e,t){return e.userData&&e.userData.isProtomux?e.userData:e.isProtomux?e:new this(e,t)}static isProtomux(e){return"object"==typeof e&&!0===e.isProtomux}*[Symbol.iterator](){for(const e of this._local)null!==e&&(yield e)}cork(){1==++this.corked&&(this._batch=[],this._batchState={buffer:null,start:0,end:1})}uncork(){0==--this.corked&&(this._sendBatch(this._batch,this._batchState),this._batch=null,this._batchState=null)}getLastChannel({protocol:e,id:t=null}){const n=Wa(e,t),r=this._infos.get(n);return r?r.lastChannel:null}pair({protocol:e,id:t=null},n){this._notify.set(Wa(e,t),n)}unpair({protocol:e,id:t=null}){this._notify.delete(Wa(e,t))}opened({protocol:e,id:t=null}){const n=Wa(e,t),r=this._infos.get(n);return!!r&&r.opened>0}createChannel({userData:e=null,protocol:t,aliases:n=[],id:r=null,unique:i=!0,handshake:s=null,messages:o=[],onopen:a=ja,onclose:h=ja,ondestroy:c=ja,ondrain:u=ja}){if(this.stream.destroyed)return null;const l=this._get(t,r,n);if(i&&l.opened>0)return null;if(0===l.incoming.length)return new qa(this,l,e,t,n,r,s,o,a,h,c,u);this._remoteBacklog--;const d=l.incoming.shift();if(null===this._remote[d-1])return null;const f=new qa(this,l,e,t,n,r,s,o,a,h,c,u);return f._remoteId=d,f._fullyOpenSoon(),f}_pushBatch(e,t){this._batchState.end>=8388608&&(this._sendBatch(this._batch,this._batchState),this._batch=[],this._batchState={buffer:null,start:0,end:1}),0!==this._batch.length&&this._batch[this._batch.length-1].localId===e||(this._batchState.end++,Ha.uint.preencode(this._batchState,e)),Ha.buffer.preencode(this._batchState,t),this._batch.push({localId:e,buffer:t})}_sendBatch(e,t){if(0===e.length)return;let n=e[0].localId;t.buffer=this._alloc(t.end),t.buffer[t.start++]=0,t.buffer[t.start++]=0,Ha.uint.encode(t,n);for(let r=0;r<e.length;r++){const i=e[r];n!==i.localId&&(t.buffer[t.start++]=0,Ha.uint.encode(t,n=i.localId)),Ha.buffer.encode(t,i.buffer)}this.drained=this.stream.write(t.buffer)}_get(e,t,n=[]){const r=Wa(e,t);let i=this._infos.get(r);if(i)return i;i={key:r,protocol:e,aliases:[],id:t,pairing:0,opened:0,incoming:[],outgoing:[],lastChannel:null},this._infos.set(r,i);for(const e of n){const n=Wa(e,t);i.aliases.push(n),this._infos.set(n,i)}return i}_gc(e){if(0===e.opened&&0===e.outgoing.length&&0===e.incoming.length){this._infos.delete(e.key);for(const t of e.aliases)this._infos.delete(t)}}_ondata(e){if(0!==e.byteLength)try{const t={buffer:e,start:0,end:e.byteLength};this._decode(Ha.uint.decode(t),t)}catch(e){this._safeDestroy(e)}}_ondrain(){this.drained=!0;for(const e of this._local)null!==e&&e._track(e.ondrain(e))}_onend(){this.stream.end()}_decode(e,t){const n=Ha.uint.decode(t);if(0===e)return this._oncontrolsession(n,t);const r=e<=this._remote.length?this._remote[e-1]:null;if(null!==r){if(null===r.pending)return r.session._recv(n,t);this._bufferMessage(r,n,t)}}_oncontrolsession(e,t){switch(e){case 0:this._onbatch(t);break;case 1:return this._onopensession(t);case 2:this._onrejectsession(t);break;case 3:this._onclosesession(t)}return null}_bufferMessage(e,t,{buffer:n,start:r,end:i}){const s={buffer:n,start:r,end:i};e.pending.push({type:t,state:s}),this._buffered+=za(s),this._pauseMaybe()}_pauseMaybe(){!0===this._paused||this._buffered<=32768||(this._paused=!0,this.stream.pause())}_resumeMaybe(){!1===this._paused||this._buffered>32768||(this._paused=!1,this.stream.resume())}_onbatch(e){const t=e.end;let n=Ha.uint.decode(e),r=null;for(;e.end>e.start;){const i=Ha.uint.decode(e);if(0===i){n=Ha.uint.decode(e);continue}e.end=e.start+i,t!==e.end&&null===r&&(r=[],this.cork());const s=this._decode(n,e);null!==r&&null!==s&&r.push(s),e.start=e.end,e.end=t}null!==r&&Promise.all(r).then(this._uncorkBound,this._safeDestroyBound)}_onopensession(e){const t=Ha.uint.decode(e),n=Ha.string.decode(e),r=Ha.buffer.decode(e);if(0===t)return this._rejectSession(0),null;const i=t-1,s=this._get(n,r);if(this._remote.length===i&&this._remote.push(null),i>=this._remote.length||null!==this._remote[i])throw new Error("Invalid open message");if(s.outgoing.length>0){const n=s.outgoing.shift(),r=this._local[n-1];return null===r?(this._free.push(n-1),null):(this._remote[i]={state:e,pending:null,session:null},r._remoteId=t,r._fullyOpen(),null)}const o={buffer:e.buffer,start:e.start,end:e.end};if(this._remote[i]={state:o,pending:[],session:null},++this._remoteBacklog>1/0)throw new Error("Remote exceeded backlog");return s.pairing++,s.incoming.push(t),this._requestSession(n,r,s).catch(this._safeDestroyBound)}_onrejectsession(e){const t=Ha.uint.decode(e);for(const e of this._infos.values()){const n=e.outgoing.indexOf(t);if(-1===n)continue;e.outgoing.splice(n,1);const r=this._local[t-1];return this._free.push(t-1),null!==r&&r._close(!0),void this._gc(e)}throw new Error("Invalid reject message")}_onclosesession(e){const t=Ha.uint.decode(e);if(0===t)return;const n=t-1,r=n<this._remote.length?this._remote[n]:null;null!==r&&null!==r.session&&r.session._close(!0)}async _requestSession(e,t,n){const r=this._notify.get(Wa(e,t))||this._notify.get(Wa(e,null));if(r&&await r(t),!(--n.pairing>0)){for(;n.incoming.length>0;)this._rejectSession(n,n.incoming.shift());this._gc(n)}}_rejectSession(e,t){if(t>0){const e=this._remote[t-1];if(null!==e.pending)for(let t=0;t<e.pending.length;t++)this._buffered-=za(e.pending[t].state);this._remote[t-1]=null,this._resumeMaybe()}const n={buffer:null,start:2,end:2};Ha.uint.preencode(n,t),n.buffer=this._alloc(n.end),n.buffer[0]=0,n.buffer[1]=2,Ha.uint.encode(n,t),this._write0(n.buffer)}_write0(e){null===this._batch?this.drained=this.stream.write(e):this._pushBatch(0,e.subarray(1))}destroy(e){this.stream.destroy(e)}_safeDestroy(e){Ga(e),this.stream.destroy(e)}_shutdown(){for(const e of this._local)null!==e&&e._close(!0)}};function ja(){}function Wa(e,t){return e+"##"+(t?Fa.toString(t,"hex"):"")}function za(e){return e.end-e.start+512}const Xa=class{constructor(e){if(!(e>0)||e-1&e)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}clear(){this.top=this.btm=0,this.next=null,this.buffer.fill(void 0)}push(e){return void 0===this.buffer[this.top]&&(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){const e=this.buffer[this.btm];if(void 0!==e)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}peek(){return this.buffer[this.btm]}isEmpty(){return void 0===this.buffer[this.btm]}};var Za=class{constructor(e){this.hwm=e||16,this.head=new Xa(this.hwm),this.tail=this.head,this.length=0}clear(){this.head=this.tail,this.head.clear(),this.length=0}push(e){if(this.length++,!this.head.push(e)){const t=this.head;this.head=t.next=new Xa(2*this.head.buffer.length),this.head.push(e)}}shift(){0!==this.length&&this.length--;const e=this.tail.shift();if(void 0===e&&this.tail.next){const e=this.tail.next;return this.tail.next=null,this.tail=e,this.tail.shift()}return e}peek(){const e=this.tail.peek();return void 0===e&&this.tail.next?this.tail.next.peek():e}isEmpty(){return 0===this.length}};const $a=I,eh=I,th=class{constructor(e){this.encoding=e}decode(e){return $a.toString(e,this.encoding)}flush(){return""}},nh=class{constructor(){this.codePoint=0,this.bytesSeen=0,this.bytesNeeded=0,this.lowerBoundary=128,this.upperBoundary=191}decode(e){if(0===this.bytesNeeded){let t=!0;for(let n=Math.max(0,e.byteLength-4),r=e.byteLength;n<r&&t;n++)t=e[n]<=127;if(t)return eh.toString(e,"utf8")}let t="";for(let n=0,r=e.byteLength;n<r;n++){const r=e[n];0!==this.bytesNeeded?r<this.lowerBoundary||r>this.upperBoundary?(this.codePoint=0,this.bytesNeeded=0,this.bytesSeen=0,this.lowerBoundary=128,this.upperBoundary=191,t+=""):(this.lowerBoundary=128,this.upperBoundary=191,this.codePoint=this.codePoint<<6|63&r,this.bytesSeen++,this.bytesSeen===this.bytesNeeded&&(t+=String.fromCodePoint(this.codePoint),this.codePoint=0,this.bytesNeeded=0,this.bytesSeen=0)):r<=127?t+=String.fromCharCode(r):r>=194&&r<=223?(this.bytesNeeded=1,this.codePoint=31&r):r>=224&&r<=239?(224===r?this.lowerBoundary=160:237===r&&(this.upperBoundary=159),this.bytesNeeded=2,this.codePoint=15&r):r>=240&&r<=244?(240===r&&(this.lowerBoundary=144),244===r&&(this.upperBoundary=143),this.bytesNeeded=3,this.codePoint=7&r):t+=""}return t}flush(){const e=this.bytesNeeded>0?"":"";return this.codePoint=0,this.bytesNeeded=0,this.bytesSeen=0,this.lowerBoundary=128,this.upperBoundary=191,e}};function rh(){}function ih(){ih.init.call(this)}function sh(e){return void 0===e._maxListeners?ih.defaultMaxListeners:e._maxListeners}function oh(e,t,n,r){var i,s,o,a;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if((s=e._events)?(s.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),s=e._events),o=s[t]):(s=e._events=new rh,e._eventsCount=0),o){if("function"==typeof o?o=s[t]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),!o.warned&&(i=sh(e))&&i>0&&o.length>i){o.warned=!0;var h=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");h.name="MaxListenersExceededWarning",h.emitter=e,h.type=t,h.count=o.length,a=h,"function"==typeof console.warn?console.warn(a):console.log(a)}}else o=s[t]=n,++e._eventsCount;return e}function ah(e,t,n){var r=!1;function i(){e.removeListener(t,i),r||(r=!0,n.apply(e,arguments))}return i.listener=n,i}function hh(e){var t=this._events;if(t){var n=t[e];if("function"==typeof n)return 1;if(n)return n.length}return 0}function ch(e,t){for(var n=new Array(t);t--;)n[t]=e[t];return n}rh.prototype=Object.create(null),ih.EventEmitter=ih,ih.usingDomains=!1,ih.prototype.domain=void 0,ih.prototype._events=void 0,ih.prototype._maxListeners=void 0,ih.defaultMaxListeners=10,ih.init=function(){this.domain=null,ih.usingDomains&&(void 0).active,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new rh,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},ih.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},ih.prototype.getMaxListeners=function(){return sh(this)},ih.prototype.emit=function(e){var t,n,r,i,s,o,a,h="error"===e;if(o=this._events)h=h&&null==o.error;else if(!h)return!1;if(a=this.domain,h){if(t=arguments[1],!a){if(t instanceof Error)throw t;var c=new Error('Uncaught, unspecified "error" event. ('+t+")");throw c.context=t,c}return t||(t=new Error('Uncaught, unspecified "error" event')),t.domainEmitter=this,t.domain=a,t.domainThrown=!1,a.emit("error",t),!1}if(!(n=o[e]))return!1;var u="function"==typeof n;switch(r=arguments.length){case 1:!function(e,t,n){if(t)e.call(n);else for(var r=e.length,i=ch(e,r),s=0;s<r;++s)i[s].call(n)}(n,u,this);break;case 2:!function(e,t,n,r){if(t)e.call(n,r);else for(var i=e.length,s=ch(e,i),o=0;o<i;++o)s[o].call(n,r)}(n,u,this,arguments[1]);break;case 3:!function(e,t,n,r,i){if(t)e.call(n,r,i);else for(var s=e.length,o=ch(e,s),a=0;a<s;++a)o[a].call(n,r,i)}(n,u,this,arguments[1],arguments[2]);break;case 4:!function(e,t,n,r,i,s){if(t)e.call(n,r,i,s);else for(var o=e.length,a=ch(e,o),h=0;h<o;++h)a[h].call(n,r,i,s)}(n,u,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(r-1),s=1;s<r;s++)i[s-1]=arguments[s];!function(e,t,n,r){if(t)e.apply(n,r);else for(var i=e.length,s=ch(e,i),o=0;o<i;++o)s[o].apply(n,r)}(n,u,this,i)}return!0},ih.prototype.addListener=function(e,t){return oh(this,e,t,!1)},ih.prototype.on=ih.prototype.addListener,ih.prototype.prependListener=function(e,t){return oh(this,e,t,!0)},ih.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,ah(this,e,t)),this},ih.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,ah(this,e,t)),this},ih.prototype.removeListener=function(e,t){var n,r,i,s,o;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(r=this._events))return this;if(!(n=r[e]))return this;if(n===t||n.listener&&n.listener===t)0==--this._eventsCount?this._events=new rh:(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,s=n.length;s-- >0;)if(n[s]===t||n[s].listener&&n[s].listener===t){o=n[s].listener,i=s;break}if(i<0)return this;if(1===n.length){if(n[0]=void 0,0==--this._eventsCount)return this._events=new rh,this;delete r[e]}else!function(e,t){for(var n=t,r=n+1,i=e.length;r<i;n+=1,r+=1)e[n]=e[r];e.pop()}(n,i);r.removeListener&&this.emit("removeListener",e,o||t)}return this},ih.prototype.off=function(e,t){return this.removeListener(e,t)},ih.prototype.removeAllListeners=function(e){var t,n;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=new rh,this._eventsCount=0):n[e]&&(0==--this._eventsCount?this._events=new rh:delete n[e]),this;if(0===arguments.length){for(var r,i=Object.keys(n),s=0;s<i.length;++s)"removeListener"!==(r=i[s])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=new rh,this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(t)do{this.removeListener(e,t[t.length-1])}while(t[0]);return this},ih.prototype.listeners=function(e){var t,n=this._events;return n&&(t=n[e])?"function"==typeof t?[t.listener||t]:function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(t):[]},ih.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):hh.call(e,t)},ih.prototype.listenerCount=hh,ih.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var uh=function(e){return e&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}(Object.freeze({__proto__:null,default:ih,EventEmitter:ih}));const{EventEmitter:lh}=uh,dh=new Error("Stream was destroyed"),fh=new Error("Premature close"),Ah=Ma,gh=Za,ph=class{constructor(e="utf8"){switch(this.encoding=function(e){switch(e=e.toLowerCase()){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:throw new Error("Unknown encoding: "+e)}}(e),this.encoding){case"utf8":this.decoder=new nh;break;case"utf16le":case"base64":throw new Error("Unsupported encoding: "+this.encoding);default:this.decoder=new th(this.encoding)}}push(e){return"string"==typeof e?e:this.decoder.decode(e)}write(e){return this.push(e)}end(e){let t="";return e&&(t=this.push(e)),t+=this.decoder.flush(),t}},yh=536870911,_h=1^yh,bh=16384,Ih=32768,Eh=131072,mh=768^yh,wh=536838143,Ch=536739839,Sh=2<<18,Bh=4<<18,Qh=8<<18,vh=32<<18,xh=64<<18,Lh=128<<18,kh=512<<18,Dh=1024<<18,Uh=469499903,Kh=503316479,Mh=268435455,Th=262160,Yh=8404992,Nh=8405006,Ph=33587200,Oh=33587215,Fh=270794767,Hh=Symbol.asyncIterator||Symbol("asyncIterator");let Rh=class{constructor(e,{highWaterMark:t=16384,map:n=null,mapWritable:r,byteLength:i,byteLengthWritable:s}={}){this.stream=e,this.queue=new gh,this.highWaterMark=t,this.buffered=0,this.error=null,this.pipeline=null,this.drains=null,this.byteLength=s||i||dc,this.map=r||n,this.afterWrite=zh.bind(this),this.afterUpdateNextTick=$h.bind(this)}get ended(){return!!(this.stream._duplexState&vh)}push(e){return null!==this.map&&(e=this.map(e)),this.buffered+=this.byteLength(e),this.queue.push(e),this.buffered<this.highWaterMark?(this.stream._duplexState|=Qh,!0):(this.stream._duplexState|=6291456,!1)}shift(){const e=this.queue.shift();return this.buffered-=this.byteLength(e),0===this.buffered&&(this.stream._duplexState&=534773759),e}end(e){"function"==typeof e?this.stream.once("finish",e):null!=e&&this.push(e),this.stream._duplexState=535822335&(this.stream._duplexState|kh)}autoBatch(e,t){const n=[],r=this.stream;for(n.push(e);2359296==(r._duplexState&Fh);)n.push(r._writableState.shift());if(15&r._duplexState)return t(null);r._writev(n,t)}update(){const e=this.stream;e._duplexState|=Sh;do{for(;(e._duplexState&Fh)===Qh;){const t=this.shift();e._duplexState|=67371008,e._write(t,this.afterWrite)}!(1310720&e._duplexState)&&this.updateNonPrimary()}while(!0===this.continueUpdate());e._duplexState&=536346623}updateNonPrimary(){const e=this.stream;if((144965647&e._duplexState)===kh)return e._duplexState=402653183&e._duplexState|262144,void e._final(jh.bind(this));4!=(14&e._duplexState)?1==(e._duplexState&Oh)&&(e._duplexState=(e._duplexState|Th)&_h,e._open(ec.bind(this))):!(e._duplexState&Ph)&&(e._duplexState|=Th,e._destroy(Wh.bind(this)))}continueUpdate(){return!!(this.stream._duplexState&Lh)&&(this.stream._duplexState&=Kh,!0)}updateCallback(){(35127311&this.stream._duplexState)===Bh?this.update():this.updateNextTick()}updateNextTick(){!(this.stream._duplexState&Lh)&&(this.stream._duplexState|=Lh,!(this.stream._duplexState&Sh)&&Ah(this.afterUpdateNextTick))}},Gh=class{constructor(e,{highWaterMark:t=16384,map:n=null,mapReadable:r,byteLength:i,byteLengthReadable:s}={}){this.stream=e,this.queue=new gh,this.highWaterMark=0===t?1:t,this.buffered=0,this.readAhead=t>0,this.error=null,this.pipeline=null,this.byteLength=s||i||dc,this.map=r||n,this.pipeTo=null,this.afterRead=Xh.bind(this),this.afterUpdateNextTick=Zh.bind(this)}get ended(){return!!(this.stream._duplexState&bh)}pipe(e,t){if(null!==this.pipeTo)throw new Error("Can only pipe to one destination");if("function"!=typeof t&&(t=null),this.stream._duplexState|=512,this.pipeTo=e,this.pipeline=new qh(this.stream,e,t),t&&this.stream.on("error",fc),lc(e))e._writableState.pipeline=this.pipeline,t&&e.on("error",fc),e.on("finish",this.pipeline.finished.bind(this.pipeline));else{const t=this.pipeline.done.bind(this.pipeline,e),n=this.pipeline.done.bind(this.pipeline,e,null);e.on("error",t),e.on("close",n),e.on("finish",this.pipeline.finished.bind(this.pipeline))}e.on("drain",Jh.bind(this)),this.stream.emit("piping",e),e.emit("pipe",this.stream)}push(e){const t=this.stream;return null===e?(this.highWaterMark=0,t._duplexState=536805311&t._duplexState|1024,!1):(null!==this.map&&null===(e=this.map(e))||(this.buffered+=this.byteLength(e),this.queue.push(e),t._duplexState=536805375&t._duplexState|128),this.buffered<this.highWaterMark)}shift(){const e=this.queue.shift();return this.buffered-=this.byteLength(e),0===this.buffered&&(this.stream._duplexState&=536862591),e}unshift(e){const t=[null!==this.map?this.map(e):e];for(;this.buffered>0;)t.push(this.shift());for(let e=0;e<t.length-1;e++){const n=t[e];this.buffered+=this.byteLength(n),this.queue.push(n)}this.push(t[t.length-1])}read(){const e=this.stream;if(128==(16527&e._duplexState)){const t=this.shift();return null!==this.pipeTo&&!1===this.pipeTo.write(t)&&(e._duplexState&=mh),!!(2048&e._duplexState)&&e.emit("data",t),t}return!1===this.readAhead&&(e._duplexState|=Eh,this.updateNextTick()),null}drain(){const e=this.stream;for(;128==(16527&e._duplexState)&&768&e._duplexState;){const t=this.shift();null!==this.pipeTo&&!1===this.pipeTo.write(t)&&(e._duplexState&=mh),2048&e._duplexState&&e.emit("data",t)}}update(){const e=this.stream;e._duplexState|=32;do{for(this.drain();this.buffered<this.highWaterMark&&(214047&e._duplexState)===Eh;)e._duplexState|=65552,e._read(this.afterRead),this.drain();4224==(12431&e._duplexState)&&(e._duplexState|=8192,e.emit("readable")),!(80&e._duplexState)&&this.updateNonPrimary()}while(!0===this.continueUpdate());e._duplexState&=536870879}updateNonPrimary(){const e=this.stream;1024==(1167&e._duplexState)&&(e._duplexState=536869887&(e._duplexState|bh),e.emit("end"),(e._duplexState&Nh)===Yh&&(e._duplexState|=4),null!==this.pipeTo&&this.pipeTo.end()),4!=(14&e._duplexState)?1==(e._duplexState&Oh)&&(e._duplexState=(e._duplexState|Th)&_h,e._open(ec.bind(this))):!(e._duplexState&Ph)&&(e._duplexState|=Th,e._destroy(Wh.bind(this)))}continueUpdate(){return!!(this.stream._duplexState&Ih)&&(this.stream._duplexState&=wh,!0)}updateCallback(){64==(32879&this.stream._duplexState)?this.update():this.updateNextTick()}updateNextTick(){!(this.stream._duplexState&Ih)&&(this.stream._duplexState|=Ih,!(32&this.stream._duplexState)&&Ah(this.afterUpdateNextTick))}},Vh=class{constructor(e){this.data=null,this.afterTransform=tc.bind(e),this.afterFinal=null}},qh=class{constructor(e,t,n){this.from=e,this.to=t,this.afterPipe=n,this.error=null,this.pipeToFinished=!1}finished(){this.pipeToFinished=!0}done(e,t){t&&(this.error=t),e!==this.to||(this.to=null,null===this.from)?e!==this.from||(this.from=null,null===this.to)?(null!==this.afterPipe&&this.afterPipe(this.error),this.to=this.from=this.afterPipe=null):!(e._duplexState&bh)&&this.to.destroy(this.error||new Error("Readable stream closed before ending")):this.from._duplexState&bh&&this.pipeToFinished||this.from.destroy(this.error||new Error("Writable stream closed prematurely"))}};function Jh(){this.stream._duplexState|=512,this.updateCallback()}function jh(e){const t=this.stream;e&&t.destroy(e),!(14&t._duplexState)&&(t._duplexState|=vh,t.emit("finish")),(t._duplexState&Nh)===Yh&&(t._duplexState|=4),t._duplexState&=Uh,t._duplexState&Sh?this.updateNextTick():this.update()}function Wh(e){const t=this.stream;e||this.error===dh||(e=this.error),e&&t.emit("error",e),t._duplexState|=8,t.emit("close");const n=t._readableState,r=t._writableState;if(null!==n&&null!==n.pipeline&&n.pipeline.done(t,e),null!==r){for(;null!==r.drains&&r.drains.length>0;)r.drains.shift().resolve(!1);null!==r.pipeline&&r.pipeline.done(t,e)}}function zh(e){const t=this.stream;e&&t.destroy(e),t._duplexState&=Uh,null!==this.drains&&function(e){for(let t=0;t<e.length;t++)0==--e[t].writes&&(e.shift().resolve(!0),t--)}(this.drains),4194304==(6553615&t._duplexState)&&(t._duplexState&=532676607,(t._duplexState&xh)===xh&&t.emit("drain")),this.updateCallback()}function Xh(e){e&&this.stream.destroy(e),this.stream._duplexState&=536870895,!1===this.readAhead&&!(256&this.stream._duplexState)&&(this.stream._duplexState&=Ch),this.updateCallback()}function Zh(){!(32&this.stream._duplexState)&&(this.stream._duplexState&=wh,this.update())}function $h(){!(this.stream._duplexState&Sh)&&(this.stream._duplexState&=Kh,this.update())}function ec(e){const t=this.stream;e&&t.destroy(e),!(4&t._duplexState)&&(!(17423&t._duplexState)&&(t._duplexState|=64),!(142606351&t._duplexState)&&(t._duplexState|=Bh),t.emit("open")),t._duplexState&=536608751,null!==t._writableState&&t._writableState.updateCallback(),null!==t._readableState&&t._readableState.updateCallback()}function tc(e,t){null!=t&&this.push(t),this._writableState.afterWrite(e)}function nc(e){null!==this._readableState&&("data"===e&&(this._duplexState|=133376,this._readableState.updateNextTick()),"readable"===e&&(this._duplexState|=4096,this._readableState.updateNextTick())),null!==this._writableState&&"drain"===e&&(this._duplexState|=xh,this._writableState.updateNextTick())}let rc=class extends lh{constructor(e){super(),this._duplexState=0,this._readableState=null,this._writableState=null,e&&(e.open&&(this._open=e.open),e.destroy&&(this._destroy=e.destroy),e.predestroy&&(this._predestroy=e.predestroy),e.signal&&e.signal.addEventListener("abort",Ac.bind(this))),this.on("newListener",nc)}_open(e){e(null)}_destroy(e){e(null)}_predestroy(){}get readable(){return null!==this._readableState||void 0}get writable(){return null!==this._writableState||void 0}get destroyed(){return!!(8&this._duplexState)}get destroying(){return!!(14&this._duplexState)}destroy(e){!(14&this._duplexState)&&(e||(e=dh),this._duplexState=535822271&this._duplexState|4,null!==this._readableState&&(this._readableState.highWaterMark=0,this._readableState.error=e),null!==this._writableState&&(this._writableState.highWaterMark=0,this._writableState.error=e),this._duplexState|=2,this._predestroy(),this._duplexState&=536870909,null!==this._readableState&&this._readableState.updateNextTick(),null!==this._writableState&&this._writableState.updateNextTick())}},ic=class e extends rc{constructor(e){super(e),this._duplexState|=8519681,this._readableState=new Gh(this,e),e&&(!1===this._readableState.readAhead&&(this._duplexState&=Ch),e.read&&(this._read=e.read),e.eagerOpen&&this._readableState.updateNextTick(),e.encoding&&this.setEncoding(e.encoding))}setEncoding(e){const t=new ph(e),n=this._readableState.map||cc;return this._readableState.map=function(e){const r=t.push(e);return""===r?null:n(r)},this}_read(e){e(null)}pipe(e,t){return this._readableState.updateNextTick(),this._readableState.pipe(e,t),e}read(){return this._readableState.updateNextTick(),this._readableState.read()}push(e){return this._readableState.updateNextTick(),this._readableState.push(e)}unshift(e){return this._readableState.updateNextTick(),this._readableState.unshift(e)}resume(){return this._duplexState|=131328,this._readableState.updateNextTick(),this}pause(){return this._duplexState&=!1===this._readableState.readAhead?536739583:536870655,this}static _fromAsyncIterator(t,n){let r;const i=new e({...n,read(e){t.next().then(s).then(e.bind(null,null)).catch(e)},predestroy(){r=t.return()},destroy(e){if(!r)return e(null);r.then(e.bind(null,null)).catch(e)}});return i;function s(e){e.done?i.push(null):i.push(e.value)}}static from(t,n){if(lc(r=t)&&r.readable)return t;var r;if(t[Hh])return this._fromAsyncIterator(t[Hh](),n);Array.isArray(t)||(t=void 0===t?[]:[t]);let i=0;return new e({...n,read(e){this.push(i===t.length?null:t[i++]),e(null)}})}static isBackpressured(e){return!!(17422&e._duplexState)||e._readableState.buffered>=e._readableState.highWaterMark}static isPaused(e){return!(256&e._duplexState)}[Hh](){const e=this;let t=null,n=null,r=null;return this.on("error",(e=>{t=e})),this.on("readable",(function(){null!==n&&i(e.read())})),this.on("close",(function(){null!==n&&i(null)})),{[Hh](){return this},next:()=>new Promise((function(t,s){n=t,r=s;const o=e.read();null!==o?i(o):8&e._duplexState&&i(null)})),return:()=>s(null),throw:e=>s(e)};function i(i){null!==r&&(t?r(t):null!==i||e._duplexState&bh?n({value:i,done:null===i}):r(dh),r=n=null)}function s(t){return e.destroy(t),new Promise(((n,r)=>{if(8&e._duplexState)return n({value:void 0,done:!0});e.once("close",(function(){t?r(t):n({value:void 0,done:!0})}))}))}}},sc=class extends ic{constructor(e){super(e),this._duplexState=1|this._duplexState&Eh,this._writableState=new Rh(this,e),e&&(e.writev&&(this._writev=e.writev),e.write&&(this._write=e.write),e.final&&(this._final=e.final))}cork(){this._duplexState|=Dh}uncork(){this._duplexState&=Mh,this._writableState.updateNextTick()}_writev(e,t){t(null)}_write(e,t){this._writableState.autoBatch(e,t)}_final(e){e(null)}write(e){return this._writableState.updateNextTick(),this._writableState.push(e)}end(e){return this._writableState.updateNextTick(),this._writableState.end(e),this}},oc=class extends sc{constructor(e){super(e),this._transformState=new Vh(this),e&&(e.transform&&(this._transform=e.transform),e.flush&&(this._flush=e.flush))}_write(e,t){this._readableState.buffered>=this._readableState.highWaterMark?this._transformState.data=e:this._transform(e,this._transformState.afterTransform)}_read(e){if(null!==this._transformState.data){const t=this._transformState.data;this._transformState.data=null,e(null),this._transform(t,this._transformState.afterTransform)}else e(null)}destroy(e){super.destroy(e),null!==this._transformState.data&&(this._transformState.data=null,this._transformState.afterTransform())}_transform(e,t){t(null,e)}_flush(e){e(null)}_final(e){this._transformState.afterFinal=e,this._flush(ac.bind(this))}};function ac(e,t){const n=this._transformState.afterFinal;if(e)return n(e);null!=t&&this.push(t),this.push(null),n(null)}function hc(e,...t){const n=Array.isArray(e)?[...e,...t]:[e,...t],r=n.length&&"function"==typeof n[n.length-1]?n.pop():null;if(n.length<2)throw new Error("Pipeline requires at least 2 streams");let i=n[0],s=null,o=null;for(let e=1;e<n.length;e++)s=n[e],lc(i)?i.pipe(s,h):(a(i,!0,e>1,h),i.pipe(s)),i=s;if(r){let e=!1;const t=lc(s)||!(!s._writableState||!s._writableState.autoDestroy);s.on("error",(e=>{null===o&&(o=e)})),s.on("finish",(()=>{e=!0,t||r(o)})),t&&s.on("close",(()=>r(o||(e?null:fh))))}return s;function a(e,t,n,r){e.on("error",r),e.on("close",(function(){return e._readableState&&!e._readableState.ended||n&&e._writableState&&!e._writableState.ended?r(fh):void 0}))}function h(e){if(e&&!o){o=e;for(const t of n)t.destroy(e)}}}function cc(e){return e}function uc(e){return!!e._readableState||!!e._writableState}function lc(e){return"number"==typeof e._duplexState&&uc(e)}function dc(e){return function(e){return"object"==typeof e&&null!==e&&"number"==typeof e.byteLength}(e)?e.byteLength:1024}function fc(){}function Ac(){this.destroy(new Error("Stream aborted."))}var gc={pipeline:hc,pipelinePromise:function(...e){return new Promise(((t,n)=>hc(...e,(e=>{if(e)return n(e);t()}))))},isStream:uc,isStreamx:lc,getStreamError:function(e){const t=e._readableState&&e._readableState.error||e._writableState&&e._writableState.error;return t===dh?null:t},Stream:rc,Writable:class e extends rc{constructor(e){super(e),this._duplexState|=16385,this._writableState=new Rh(this,e),e&&(e.writev&&(this._writev=e.writev),e.write&&(this._write=e.write),e.final&&(this._final=e.final),e.eagerOpen&&this._writableState.updateNextTick())}cork(){this._duplexState|=Dh}uncork(){this._duplexState&=Mh,this._writableState.updateNextTick()}_writev(e,t){t(null)}_write(e,t){this._writableState.autoBatch(e,t)}_final(e){e(null)}static isBackpressured(e){return!!(146800654&e._duplexState)}static drained(t){if(t.destroyed)return Promise.resolve(!1);const n=t._writableState;var r;const i=((r=t)._writev!==e.prototype._writev&&r._writev!==sc.prototype._writev?Math.min(1,n.queue.length):n.queue.length)+(67108864&t._duplexState?1:0);return 0===i?Promise.resolve(!0):(null===n.drains&&(n.drains=[]),new Promise((e=>{n.drains.push({writes:i,resolve:e})})))}write(e){return this._writableState.updateNextTick(),this._writableState.push(e)}end(e){return this._writableState.updateNextTick(),this._writableState.end(e),this}},Readable:ic,Duplex:sc,Transform:oc,PassThrough:class extends oc{}};const{Duplex:pc}=gc,yc=I;function _c(){this._continueOpen()}function bc(e){this.push(yc.from(e.data))}function Ic(e){this.destroy(e)}function Ec(){this._dc.removeEventListener("open",this._onopen),this._dc.removeEventListener("message",this._onmessage),this._dc.removeEventListener("error",this._onerror),this._dc.removeEventListener("close",this._onclose),this.destroy()}function mc(e){return"string"==typeof e?yc.from(e):e}const{RTCPeerConnection:wc,RTCIceCandidate:Cc}=xa,Sc=Ja,Bc=La,Qc=Fo,vc=class extends pc{constructor(e,t,n={}){super({mapWritable:mc}),this._dc=t,this.noiseStream=this,this.isInitiator=e,this.rawStream=this,this.publicKey=n.publicKey||null,this.remotePublicKey=n.remotePublicKey||null,this.handshakeHash=n.handshakeHash||null,this._opening=null,this._openedDone=null,this.opened=new Promise((e=>{this._openedDone=e})),this.userData=null,this._onopen=_c.bind(this),this._onmessage=bc.bind(this),this._onerror=Ic.bind(this),this._onclose=Ec.bind(this),this._dc.addEventListener("open",this._onopen),this._dc.addEventListener("message",this._onmessage),this._dc.addEventListener("error",this._onerror),this._dc.addEventListener("close",this._onclose),this.resume().pause()}_open(e){"closed"!==this._dc.readyState&&"closing"!==this._dc.readyState?"connecting"!==this._dc.readyState?(this._resolveOpened(!0),e(null)):this._opening=e:e(new Error("Stream is closed"))}_continueOpen(e){if(e&&this.destroy(e),null===this._opening)return;const t=this._opening;this._opening=null,this._open(t)}_resolveOpened(e){const t=this._openedDone;t&&(this._openedDone=null,t(e),e&&this.emit("connect"))}_write(e,t){this._dc.send(e),t(null)}_predestroy(){this._continueOpen(new Error("Stream was destroyed"))}_destroy(e){this._dc.close(),this._resolveOpened(!1),e(null)}setKeepAlive(){}},xc=[{urls:"stun:stun.l.google.com:19302"}];var Lc=class{constructor(e,t={}){if(this._rtc=new wc({iceServers:t.iceServers||xc}),this._relay=e,this._mux=Sc.from(e),this._channel=this._mux.createChannel({protocol:"hyper-webrtc/signal"}),null===this._channel)throw new Error("Channel duplicated");this._ice=this._channel.addMessage({encoding:Bc.json,onmessage:this._onice.bind(this)}),this._offer=this._channel.addMessage({encoding:Bc.json,onmessage:this._onoffer.bind(this)}),this._answer=this._channel.addMessage({encoding:Bc.json,onmessage:this._onanswer.bind(this)}),this._channel.open(),this._rtc.onicecandidate=kc.bind(this)}static from(e){const t=new this(e),n=t._rtc.createDataChannel("wire",{negotiated:!0,id:0}),r=new vc(e.isInitiator,n,{publicKey:e.publicKey,remotePublicKey:e.remotePublicKey,handshakeHash:e.handshakeHash});return e.on("close",(()=>{t._rtc.close(),n.close()})),r.on("close",(()=>{t._rtc.close(),e.destroy()})),t.negotiate().catch(Qc),r}async negotiate(){if(!this._relay.isInitiator)return;const e=await this._rtc.createOffer();await this._rtc.setLocalDescription(e),this._offer.send({offer:this._rtc.localDescription})}async _onice({ice:e}){await this._rtc.addIceCandidate(new Cc(e))}async _onoffer({offer:e}){await this._rtc.setRemoteDescription(e);const t=await this._rtc.createAnswer();await this._rtc.setLocalDescription(t),this._answer.send({answer:this._rtc.localDescription})}async _onanswer({answer:e}){await this._rtc.setRemoteDescription(e)}};function kc(e){e.candidate&&this._ice.send({ice:e.candidate})}var Dc={},Uc={};const Kc=Uc.LE=255===new Uint8Array(new Uint16Array([255]).buffer)[0];Uc.BE=!Kc;var Mc={exports:{}};!function(e,t){const n=P,{BE:r}=Uc;t=e.exports={preencode(e,t){e.end+=t.byteLength},encode(e,t){e.buffer.set(t,e.start),e.start+=t.byteLength},decode(e){const t=e.buffer.subarray(e.start,e.end);return e.start=e.end,t}};const i=t.buffer={preencode(e,t){t?o.preencode(e,t):e.end++},encode(e,t){t?o.encode(e,t):e.buffer[e.start++]=0},decode(e){const t=e.buffer.subarray(e.start);return 0===t.byteLength?null:(e.start=e.end,t)}};function s(e,t){const n=e.BYTES_PER_ELEMENT;return{preencode(e,t){e.end+=t.byteLength},encode(e,n){const i=new Uint8Array(n.buffer,n.byteOffset,n.byteLength);r&&t&&t(i),e.buffer.set(i,e.start),e.start+=n.byteLength},decode(i){let s=i.buffer.subarray(i.start);return s.byteOffset%n!=0&&(s=new Uint8Array(s)),r&&t&&t(s),i.start=i.end,new e(s.buffer,s.byteOffset,s.byteLength/n)}}}t.binary={...i,preencode(e,t){"string"==typeof t?h.preencode(e,t):i.preencode(e,t)},encode(e,t){"string"==typeof t?h.encode(e,t):i.encode(e,t)}};const o=t.uint8array=s(Uint8Array);function a(e){return{preencode(t,r){t.end+=n.byteLength(r,e)},encode(t,r){t.start+=n.write(t.buffer,r,t.start,e)},decode(t){const r=n.toString(t.buffer,e,t.start);return t.start=t.end,r}}}t.uint16array=s(Uint16Array,n.swap16),t.uint32array=s(Uint32Array,n.swap32),t.int8array=s(Int8Array),t.int16array=s(Int16Array,n.swap16),t.int32array=s(Int32Array,n.swap32),t.float32array=s(Float32Array,n.swap32),t.float64array=s(Float64Array,n.swap64);const h=t.string=t.utf8=a("utf-8");t.ascii=a("ascii"),t.hex=a("hex"),t.base64=a("base64"),t.ucs2=t.utf16le=a("utf16le"),t.array=function(e){return{preencode(t,n){for(const r of n)e.preencode(t,r)},encode(t,n){for(const r of n)e.encode(t,r)},decode(t){const n=[];for(;t.start<t.end;)n.push(e.decode(t));return n}}},t.json={preencode(e,t){h.preencode(e,JSON.stringify(t))},encode(e,t){h.encode(e,JSON.stringify(t))},decode:e=>JSON.parse(h.decode(e))},t.ndjson={preencode(e,t){h.preencode(e,JSON.stringify(t)+"\n")},encode(e,t){h.encode(e,JSON.stringify(t)+"\n")},decode:e=>JSON.parse(h.decode(e))}}(Mc,Mc.exports);var Tc={preencode:function e(t,n){if(n<251)t.end++;else if(n<256)t.end+=2;else if(n<65536)t.end+=3;else if(n<16777216)t.end+=4;else if(n<4294967296)t.end+=5;else{t.end++;e(t,Math.floor(Math.log(n)/Math.log(2))-32),t.end+=6}},encode:function e(t,n){const r=n-251;if(n<251)t.buffer[t.start++]=n;else if(n<256)t.buffer[t.start++]=251,t.buffer[t.start++]=r;else if(n<65536)t.buffer[t.start++]=252,t.buffer[t.start++]=r>>8&255,t.buffer[t.start++]=255&r;else if(n<16777216)t.buffer[t.start++]=253,t.buffer[t.start++]=r>>16,t.buffer[t.start++]=r>>8&255,t.buffer[t.start++]=255&r;else if(n<4294967296)t.buffer[t.start++]=254,t.buffer[t.start++]=r>>24,t.buffer[t.start++]=r>>16&255,t.buffer[t.start++]=r>>8&255,t.buffer[t.start++]=255&r;else{const n=Math.floor(Math.log(r)/Math.log(2))-32;t.buffer[t.start++]=255,e(t,n);const i=r/Math.pow(2,n-11);for(let e=5;e>=0;e--)t.buffer[t.start++]=i/Math.pow(2,8*e)&255}},decode:function e(t){const n=251;if(t.end-t.start<1)throw new Error("Out of bounds");const r=t.buffer[t.start++];if(r<n)return r;if(t.end-t.start<r-n+1)throw new Error("Out of bounds.");if(r<252)return t.buffer[t.start++]+n;if(r<253)return(t.buffer[t.start++]<<8)+t.buffer[t.start++]+n;if(r<254)return(t.buffer[t.start++]<<16)+(t.buffer[t.start++]<<8)+t.buffer[t.start++]+n;if(r<255)return 16777216*t.buffer[t.start++]+(t.buffer[t.start++]<<16)+(t.buffer[t.start++]<<8)+t.buffer[t.start++]+n;const i=e(t);if(t.end-t.start<6)throw new Error("Out of bounds");let s=0;for(let e=5;e>=0;e--)s+=t.buffer[t.start++]*Math.pow(2,8*e);return s*Math.pow(2,i-11)+n}};!function(e){const t=P,{BE:n}=Uc;e.state=function(e=0,t=0,n=null){return{start:e,end:t,buffer:n,cache:null}};const r=e.raw=Mc.exports,i=e.uint={preencode(e,t){e.end+=t<=252?1:t<=65535?3:t<=4294967295?5:9},encode(e,t){t<=252?s.encode(e,t):t<=65535?(e.buffer[e.start++]=253,o.encode(e,t)):t<=4294967295?(e.buffer[e.start++]=254,h.encode(e,t)):(e.buffer[e.start++]=255,d.encode(e,t))},decode(e){const t=s.decode(e);return t<=252?t:253===t?o.decode(e):254===t?h.decode(e):d.decode(e)}},s=e.uint8={preencode(e,t){e.end+=1},encode(e,t){e.buffer[e.start++]=t},decode(e){if(e.start>=e.end)throw new Error("Out of bounds");return e.buffer[e.start++]}},o=e.uint16={preencode(e,t){e.end+=2},encode(e,t){e.buffer[e.start++]=t,e.buffer[e.start++]=t>>>8},decode(e){if(e.end-e.start<2)throw new Error("Out of bounds");return e.buffer[e.start++]+256*e.buffer[e.start++]}},a=e.uint24={preencode(e,t){e.end+=3},encode(e,t){e.buffer[e.start++]=t,e.buffer[e.start++]=t>>>8,e.buffer[e.start++]=t>>>16},decode(e){if(e.end-e.start<3)throw new Error("Out of bounds");return e.buffer[e.start++]+256*e.buffer[e.start++]+65536*e.buffer[e.start++]}},h=e.uint32={preencode(e,t){e.end+=4},encode(e,t){e.buffer[e.start++]=t,e.buffer[e.start++]=t>>>8,e.buffer[e.start++]=t>>>16,e.buffer[e.start++]=t>>>24},decode(e){if(e.end-e.start<4)throw new Error("Out of bounds");return e.buffer[e.start++]+256*e.buffer[e.start++]+65536*e.buffer[e.start++]+16777216*e.buffer[e.start++]}},c=e.uint40={preencode(e,t){e.end+=5},encode(e,t){const n=Math.floor(t/256);s.encode(e,t),h.encode(e,n)},decode(e){if(e.end-e.start<5)throw new Error("Out of bounds");return s.decode(e)+256*h.decode(e)}},u=e.uint48={preencode(e,t){e.end+=6},encode(e,t){const n=Math.floor(t/65536);o.encode(e,t),h.encode(e,n)},decode(e){if(e.end-e.start<6)throw new Error("Out of bounds");return o.decode(e)+65536*h.decode(e)}},l=e.uint56={preencode(e,t){e.end+=7},encode(e,t){const n=Math.floor(t/16777216);a.encode(e,t),h.encode(e,n)},decode(e){if(e.end-e.start<7)throw new Error("Out of bounds");return a.decode(e)+16777216*h.decode(e)}},d=e.uint64={preencode(e,t){e.end+=8},encode(e,t){const n=Math.floor(t/4294967296);h.encode(e,t),h.encode(e,n)},decode(e){if(e.end-e.start<8)throw new Error("Out of bounds");return h.decode(e)+4294967296*h.decode(e)}};e.int=C(i),e.int8=C(s),e.int16=C(o),e.int24=C(a),e.int32=C(h),e.int40=C(c),e.int48=C(u),e.int56=C(l),e.int64=C(d),e.lexint=Tc,e.float32={preencode(e,t){e.end+=4},encode(e,t){new DataView(e.buffer.buffer,e.start+e.buffer.byteOffset,4).setFloat32(0,t,!0),e.start+=4},decode(e){if(e.end-e.start<4)throw new Error("Out of bounds");const t=new DataView(e.buffer.buffer,e.start+e.buffer.byteOffset,4).getFloat32(0,!0);return e.start+=4,t}},e.float64={preencode(e,t){e.end+=8},encode(e,t){new DataView(e.buffer.buffer,e.start+e.buffer.byteOffset,8).setFloat64(0,t,!0),e.start+=8},decode(e){if(e.end-e.start<8)throw new Error("Out of bounds");const t=new DataView(e.buffer.buffer,e.start+e.buffer.byteOffset,8).getFloat64(0,!0);return e.start+=8,t}};const f=e.buffer={preencode(e,t){t?g.preencode(e,t):e.end++},encode(e,t){t?g.encode(e,t):e.buffer[e.start++]=0},decode(e){const t=i.decode(e);if(0===t)return null;if(e.end-e.start<t)throw new Error("Out of bounds");return e.buffer.subarray(e.start,e.start+=t)}};function A(e,t){const r=e.BYTES_PER_ELEMENT;return{preencode(e,t){i.preencode(e,t.length),e.end+=t.byteLength},encode(e,r){i.encode(e,r.length);const s=new Uint8Array(r.buffer,r.byteOffset,r.byteLength);n&&t&&t(s),e.buffer.set(s,e.start),e.start+=r.byteLength},decode(s){const o=i.decode(s);let a=s.buffer.subarray(s.start,s.start+=o*r);if(a.byteLength!==o*r)throw new Error("Out of bounds");return a.byteOffset%r!=0&&(a=new Uint8Array(a)),n&&t&&t(a),new e(a.buffer,a.byteOffset,a.byteLength/r)}}}e.binary={...f,preencode(e,t){"string"==typeof t?y.preencode(e,t):f.preencode(e,t)},encode(e,t){"string"==typeof t?y.encode(e,t):f.encode(e,t)}};const g=e.uint8array=A(Uint8Array);function p(e){return{preencode(n,r){const s=t.byteLength(r,e);i.preencode(n,s),n.end+=s},encode(n,r){const s=t.byteLength(r,e);i.encode(n,s),t.write(n.buffer,r,n.start,e),n.start+=s},decode(n){const r=i.decode(n);if(n.end-n.start<r)throw new Error("Out of bounds");return t.toString(n.buffer,e,n.start,n.start+=r)},fixed:n=>({preencode(e){e.end+=n},encode(r,i){t.write(r.buffer,i,r.start,n,e),r.start+=n},decode(r){if(r.end-r.start<n)throw new Error("Out of bounds");return t.toString(r.buffer,e,r.start,r.start+=n)}})}}e.uint16array=A(Uint16Array,t.swap16),e.uint32array=A(Uint32Array,t.swap32),e.int8array=A(Int8Array),e.int16array=A(Int16Array,t.swap16),e.int32array=A(Int32Array,t.swap32),e.float32array=A(Float32Array,t.swap32),e.float64array=A(Float64Array,t.swap64);const y=e.string=e.utf8=p("utf-8");e.ascii=p("ascii"),e.hex=p("hex"),e.base64=p("base64"),e.ucs2=e.utf16le=p("utf16le"),e.bool={preencode(e,t){e.end++},encode(e,t){e.buffer[e.start++]=t?1:0},decode(e){if(e.start>=e.end)throw Error("Out of bounds");return 1===e.buffer[e.start++]}};const _=e.fixed=function(e){return{preencode(t,n){t.end+=e},encode(t,n){t.buffer.set(n,t.start),t.start+=e},decode(t){if(t.end-t.start<e)throw new Error("Out of bounds");return t.buffer.subarray(t.start,t.start+=e)}}};e.fixed32=_(32),e.fixed64=_(64),e.array=function(e){return{preencode(t,n){i.preencode(t,n.length);for(let r=0;r<n.length;r++)e.preencode(t,n[r])},encode(t,n){i.encode(t,n.length);for(let r=0;r<n.length;r++)e.encode(t,n[r])},decode(t){const n=i.decode(t);if(n>1048576)throw new Error("Array is too big");const r=new Array(n);for(let i=0;i<n;i++)r[i]=e.decode(t);return r}}},e.frame=function(t){const n=e.state();return{preencode(e,n){const r=e.end;t.preencode(e,n),i.preencode(e,e.end-r)},encode(e,r){n.end=0,t.preencode(n,r),i.encode(e,n.end),t.encode(e,r)},decode(e){const n=e.end,r=i.decode(e);e.end=e.start+r;const s=t.decode(e);return e.start=e.end,e.end=n,s}}},e.json={preencode(e,t){y.preencode(e,JSON.stringify(t))},encode(e,t){y.encode(e,JSON.stringify(t))},decode:e=>JSON.parse(y.decode(e))},e.ndjson={preencode(e,t){y.preencode(e,JSON.stringify(t)+"\n")},encode(e,t){y.encode(e,JSON.stringify(t)+"\n")},decode:e=>JSON.parse(y.decode(e))},e.none={preencode(e,t){},encode(e,t){},decode:e=>null};const b={preencode(e,t){i.preencode(e,t.length);for(let n=0;n<t.length;n++)m.preencode(e,t[n])},encode(e,t){i.encode(e,t.length);for(let n=0;n<t.length;n++)m.encode(e,t[n])},decode(e){const t=[];let n=i.decode(e);for(;n-- >0;)t.push(m.decode(e));return t}},I={preencode(e,t){const n=Object.keys(t);i.preencode(e,n.length);for(const r of n)y.preencode(e,r),m.preencode(e,t[r])},encode(e,t){const n=Object.keys(t);i.encode(e,n.length);for(const r of n)y.encode(e,r),m.encode(e,t[r])},decode(e){let t=i.decode(e);const n={};for(;t-- >0;)n[y.decode(e)]=m.decode(e);return n}},E=[e.none,e.bool,e.string,e.buffer,e.uint,e.int,e.float64,b,I],m=e.any={preencode(e,t){const n=w(t);i.preencode(e,n),E[n].preencode(e,t)},encode(e,t){const n=w(t);i.encode(e,n),E[n].encode(e,t)},decode(e){const t=i.decode(e);if(t>=E.length)throw new Error("Unknown type: "+t);return E[t].decode(e)}};function w(e){if(null==e)return 0;if("boolean"==typeof e)return 1;if("string"==typeof e)return 2;if(t.isBuffer(e))return 3;if("number"==typeof e)return Number.isInteger(e)?e>=0?4:5:6;if(Array.isArray(e))return 7;if("object"==typeof e)return 8;throw new Error("Unsupported type for "+e)}function C(e){return{preencode(t,n){e.preencode(t,S(n))},encode(t,n){e.encode(t,S(n))},decode(t){return 0===(n=e.decode(t))?n:1&n?-(n+1)/2:n/2;var n}}}function S(e){return e<0?2*-e-1:0===e?0:2*e}e.from=function(e){return"string"==typeof e?function(e){switch(e){case"ascii":return r.ascii;case"utf-8":case"utf8":return r.utf8;case"hex":return r.hex;case"base64":return r.base64;case"utf16-le":case"utf16le":case"ucs-2":case"ucs2":return r.ucs2;case"ndjson":return r.ndjson;case"json":return r.json;default:return r.binary}}(e):e.preencode?e:e.encodingLength?function(e){return{preencode(t,n){t.end+=e.encodingLength(n)},encode(t,n){e.encode(n,t.buffer,t.start),t.start+=e.encode.bytes},decode(t){const n=e.decode(t.buffer,t.start,t.end);return t.start+=e.decode.bytes,n}}}(e):function(e){let t=null,n=null;return{preencode(r,i){t=i,n=e.encode(i),r.end+=n.byteLength},encode(i,s){r.encode(i,s===t?n:e.encode(s)),t=n=null},decode:t=>e.decode(r.decode(t))}}(e)},e.encode=function(n,r){const i=e.state();return n.preencode(i,r),i.buffer=t.allocUnsafe(i.end),n.encode(i,r),i.buffer},e.decode=function(t,n){return t.decode(e.state(0,n.byteLength,n))}}(Dc);const Yc=P,Nc=Dc,Pc=Ma,Oc=Fo;let Fc=class{constructor(e,t,n,r,i,s,o,a,h,c,u,l){this.userData=n,this.protocol=r,this.aliases=i,this.id=s,this.handshake=null,this.messages=[],this.opened=!1,this.closed=!1,this.destroyed=!1,this.onopen=h,this.onclose=c,this.ondestroy=u,this.ondrain=l,this._handshake=o,this._mux=e,this._info=t,this._localId=0,this._remoteId=0,this._active=0,this._extensions=null,this._decBound=this._dec.bind(this),this._decAndDestroyBound=this._decAndDestroy.bind(this);for(const e of a)this.addMessage(e)}get drained(){return this._mux.drained}open(e){const t=this._mux._free.length>0?this._mux._free.pop():this._mux._local.push(null)-1;this._info.opened++,this._localId=t+1,this._mux._local[t]=this,0===this._remoteId&&this._info.outgoing.push(this._localId);const n={buffer:null,start:2,end:2};Nc.uint.preencode(n,this._localId),Nc.string.preencode(n,this.protocol),Nc.buffer.preencode(n,this.id),this._handshake&&this._handshake.preencode(n,e),n.buffer=this._mux._alloc(n.end),n.buffer[0]=0,n.buffer[1]=1,Nc.uint.encode(n,this._localId),Nc.string.encode(n,this.protocol),Nc.buffer.encode(n,this.id),this._handshake&&this._handshake.encode(n,e),this._mux._write0(n.buffer)}_dec(){0==--this._active&&!0===this.closed&&this._destroy()}_decAndDestroy(e){this._dec(),this._mux._safeDestroy(e)}_fullyOpenSoon(){this._mux._remote[this._remoteId-1].session=this,Pc(this._fullyOpen.bind(this))}_fullyOpen(){if(!0===this.opened||!0===this.closed)return;const e=this._mux._remote[this._remoteId-1];this.opened=!0,this.handshake=this._handshake?this._handshake.decode(e.state):null,this._track(this.onopen(this.handshake,this)),e.session=this,e.state=null,null!==e.pending&&this._drain(e)}_drain(e){for(let t=0;t<e.pending.length;t++){const n=e.pending[t];this._mux._buffered-=Vc(n.state),this._recv(n.type,n.state)}e.pending=null,this._mux._resumeMaybe()}_track(e){!0===function(e){return!(!e||"function"!=typeof e.then)}(e)&&(this._active++,e.then(this._decBound,this._decAndDestroyBound))}_close(e){!0!==this.closed&&(this.closed=!0,this._info.opened--,this._remoteId>0&&(this._mux._remote[this._remoteId-1]=null,this._remoteId=0,this._mux._free.push(this._localId-1)),this._mux._local[this._localId-1]=null,this._localId=0,this._mux._gc(this._info),this._track(this.onclose(e,this)),0===this._active&&this._destroy())}_destroy(){!0!==this.destroyed&&(this.destroyed=!0,this._track(this.ondestroy(this)))}_recv(e,t){e<this.messages.length&&this.messages[e].recv(t,this)}cork(){this._mux.cork()}uncork(){this._mux.uncork()}close(){if(!0===this.closed)return;const e={buffer:null,start:2,end:2};Nc.uint.preencode(e,this._localId),e.buffer=this._mux._alloc(e.end),e.buffer[0]=0,e.buffer[1]=3,Nc.uint.encode(e,this._localId),this._close(!1),this._mux._write0(e.buffer)}addMessage(e){if(!e)return this._skipMessage();const t=this.messages.length,n=e.encoding||Nc.raw,r=e.onmessage||Rc,i=this,s=function(e,t){const n={buffer:null,start:0,end:0};return e.preencode(n,t),n.end}(Nc.uint,t),o={type:t,encoding:n,onmessage:r,recv(e,t){t._track(o.onmessage(n.decode(e),t))},send(e,r=i){if(!0===r.closed)return!1;const o=r._mux,a={buffer:null,start:0,end:s};return null!==o._batch?(n.preencode(a,e),a.buffer=o._alloc(a.end),Nc.uint.encode(a,t),n.encode(a,e),o._pushBatch(r._localId,a.buffer),!0):(Nc.uint.preencode(a,r._localId),n.preencode(a,e),a.buffer=o._alloc(a.end),Nc.uint.encode(a,r._localId),Nc.uint.encode(a,t),n.encode(a,e),o.drained=o.stream.write(a.buffer),o.drained)}};return this.messages.push(o),o}_skipMessage(){const e={type:this.messages.length,encoding:Nc.raw,onmessage:Rc,recv(e,t){},send(e,t){}};return this.messages.push(e),e}};var Hc=class{constructor(e,{alloc:t}={}){null===e.userData&&(e.userData=this),this.isProtomux=!0,this.stream=e,this.corked=0,this.drained=!0,this._alloc=t||("function"==typeof e.alloc?e.alloc.bind(e):Yc.allocUnsafe),this._safeDestroyBound=this._safeDestroy.bind(this),this._remoteBacklog=0,this._buffered=0,this._paused=!1,this._remote=[],this._local=[],this._free=[],this._batch=null,this._batchState=null,this._infos=new Map,this._notify=new Map,this.stream.on("data",this._ondata.bind(this)),this.stream.on("drain",this._ondrain.bind(this)),this.stream.on("end",this._onend.bind(this)),this.stream.on("error",Rc),this.stream.on("close",this._shutdown.bind(this))}static from(e,t){return e.userData&&e.userData.isProtomux?e.userData:e.isProtomux?e:new this(e,t)}static isProtomux(e){return"object"==typeof e&&!0===e.isProtomux}*[Symbol.iterator](){for(const e of this._local)null!==e&&(yield e)}cork(){1==++this.corked&&(this._batch=[],this._batchState={buffer:null,start:0,end:1})}uncork(){0==--this.corked&&(this._sendBatch(this._batch,this._batchState),this._batch=null,this._batchState=null)}pair({protocol:e,id:t=null},n){this._notify.set(Gc(e,t),n)}unpair({protocol:e,id:t=null}){this._notify.delete(Gc(e,t))}opened({protocol:e,id:t=null}){const n=Gc(e,t),r=this._infos.get(n);return!!r&&r.opened>0}createChannel({userData:e=null,protocol:t,aliases:n=[],id:r=null,unique:i=!0,handshake:s=null,messages:o=[],onopen:a=Rc,onclose:h=Rc,ondestroy:c=Rc,ondrain:u=Rc}){if(this.stream.destroyed)return null;const l=this._get(t,r,n);if(i&&l.opened>0)return null;if(0===l.incoming.length)return new Fc(this,l,e,t,n,r,s,o,a,h,c,u);this._remoteBacklog--;const d=l.incoming.shift();if(null===this._remote[d-1])return null;const f=new Fc(this,l,e,t,n,r,s,o,a,h,c,u);return f._remoteId=d,f._fullyOpenSoon(),f}_pushBatch(e,t){this._batchState.end>=8388608&&(this._sendBatch(this._batch,this._batchState),this._batch=[],this._batchState={buffer:null,start:0,end:1}),0!==this._batch.length&&this._batch[this._batch.length-1].localId===e||(this._batchState.end++,Nc.uint.preencode(this._batchState,e)),Nc.buffer.preencode(this._batchState,t),this._batch.push({localId:e,buffer:t})}_sendBatch(e,t){if(0===e.length)return;let n=e[0].localId;t.buffer=this._alloc(t.end),t.buffer[t.start++]=0,t.buffer[t.start++]=0,Nc.uint.encode(t,n);for(let r=0;r<e.length;r++){const i=e[r];n!==i.localId&&(t.buffer[t.start++]=0,Nc.uint.encode(t,n=i.localId)),Nc.buffer.encode(t,i.buffer)}this.drained=this.stream.write(t.buffer)}_get(e,t,n=[]){const r=Gc(e,t);let i=this._infos.get(r);if(i)return i;i={key:r,protocol:e,aliases:[],id:t,pairing:0,opened:0,incoming:[],outgoing:[]},this._infos.set(r,i);for(const e of n){const n=Gc(e,t);i.aliases.push(n),this._infos.set(n,i)}return i}_gc(e){if(0===e.opened&&0===e.outgoing.length&&0===e.incoming.length){this._infos.delete(e.key);for(const t of e.aliases)this._infos.delete(t)}}_ondata(e){if(0!==e.byteLength)try{const t={buffer:e,start:0,end:e.byteLength};this._decode(Nc.uint.decode(t),t)}catch(e){this._safeDestroy(e)}}_ondrain(){this.drained=!0;for(const e of this._local)null!==e&&e._track(e.ondrain(e))}_onend(){this.stream.end()}_decode(e,t){const n=Nc.uint.decode(t);if(0===e)return void this._oncontrolsession(n,t);const r=e<=this._remote.length?this._remote[e-1]:null;null!==r&&(null===r.pending?r.session._recv(n,t):this._bufferMessage(r,n,t))}_oncontrolsession(e,t){switch(e){case 0:this._onbatch(t);break;case 1:this._onopensession(t);break;case 2:this._onrejectsession(t);break;case 3:this._onclosesession(t)}}_bufferMessage(e,t,{buffer:n,start:r,end:i}){const s={buffer:n,start:r,end:i};e.pending.push({type:t,state:s}),this._buffered+=Vc(s),this._pauseMaybe()}_pauseMaybe(){!0===this._paused||this._buffered<=32768||(this._paused=!0,this.stream.pause())}_resumeMaybe(){!1===this._paused||this._buffered>32768||(this._paused=!1,this.stream.resume())}_onbatch(e){const t=e.end;let n=Nc.uint.decode(e);for(;e.end>e.start;){const r=Nc.uint.decode(e);0!==r?(e.end=e.start+r,this._decode(n,e),e.start=e.end,e.end=t):n=Nc.uint.decode(e)}}_onopensession(e){const t=Nc.uint.decode(e),n=Nc.string.decode(e),r=Nc.buffer.decode(e);if(0===t)return void this._rejectSession(0);const i=t-1,s=this._get(n,r);if(this._remote.length===i&&this._remote.push(null),i>=this._remote.length||null!==this._remote[i])throw new Error("Invalid open message");if(s.outgoing.length>0){const n=s.outgoing.shift(),r=this._local[n-1];return null===r?void this._free.push(n-1):(this._remote[i]={state:e,pending:null,session:null},r._remoteId=t,void r._fullyOpen())}const o={buffer:e.buffer,start:e.start,end:e.end};if(this._remote[i]={state:o,pending:[],session:null},++this._remoteBacklog>1/0)throw new Error("Remote exceeded backlog");s.pairing++,s.incoming.push(t),this._requestSession(n,r,s).catch(this._safeDestroyBound)}_onrejectsession(e){const t=Nc.uint.decode(e);for(const e of this._infos.values()){const n=e.outgoing.indexOf(t);if(-1===n)continue;e.outgoing.splice(n,1);const r=this._local[t-1];return this._free.push(t-1),null!==r&&r._close(!0),void this._gc(e)}throw new Error("Invalid reject message")}_onclosesession(e){const t=Nc.uint.decode(e);if(0===t)return;const n=t-1,r=n<this._remote.length?this._remote[n]:null;null!==r&&null!==r.session&&r.session._close(!0)}async _requestSession(e,t,n){const r=this._notify.get(Gc(e,t))||this._notify.get(Gc(e,null));if(r&&await r(t),!(--n.pairing>0)){for(;n.incoming.length>0;)this._rejectSession(n,n.incoming.shift());this._gc(n)}}_rejectSession(e,t){if(t>0){const e=this._remote[t-1];if(null!==e.pending)for(let t=0;t<e.pending.length;t++)this._buffered-=Vc(e.pending[t].state);this._remote[t-1]=null,this._resumeMaybe()}const n={buffer:null,start:2,end:2};Nc.uint.preencode(n,t),n.buffer=this._alloc(n.end),n.buffer[0]=0,n.buffer[1]=2,Nc.uint.encode(n,t),this._write0(n.buffer)}_write0(e){null===this._batch?this.drained=this.stream.write(e):this._pushBatch(0,e.subarray(1))}destroy(e){this.stream.destroy(e)}_safeDestroy(e){Oc(e),this.stream.destroy(e)}_shutdown(){for(const e of this._local)null!==e&&e._close(!0)}};function Rc(){}function Gc(e,t){return e+"##"+(t?Yc.toString(t,"hex"):"")}function Vc(e){return e.end-e.start+512}const qc=La,Jc=qc.uint16,jc=(e,t)=>({preencode(t,n){e.preencode(t,n.host),Jc.preencode(t,n.port)},encode(t,n){e.encode(t,n.host),Jc.encode(t,n.port)},decode:n=>({host:e.decode(n),family:t,port:Jc.decode(n)})}),Wc={preencode(e){e.end+=4},encode(e,t){const n=e.start+4;let r=0;for(;r<t.length;){let n,i=0;for(;r<t.length&&46!==(n=t.charCodeAt(r++));)i=10*i+(n-48);e.buffer[e.start++]=i}e.start=n},decode(e){if(e.end-e.start<4)throw new Error("Out of bounds");return e.buffer[e.start++]+"."+e.buffer[e.start++]+"."+e.buffer[e.start++]+"."+e.buffer[e.start++]}},zc=jc(Wc,4),Xc={preencode(e){e.end+=16},encode(e,t){const n=e.start+16;let r=0,i=null;for(;r<t.length;){let n,s=0;for(;r<t.length&&58!==(n=t.charCodeAt(r++));)n>=48&&n<=57?s=16*s+(n-48):n>=65&&n<=70?s=16*s+(n-65+10):n>=97&&n<=102&&(s=16*s+(n-97+10));e.buffer[e.start++]=s>>>8,e.buffer[e.start++]=s,r<t.length&&58===t.charCodeAt(r)&&(r++,i=e.start)}if(null!==i){const t=n-e.start;e.buffer.copyWithin(i+t,i).fill(0,i,i+t)}e.start=n},decode(e){if(e.end-e.start<16)throw new Error("Out of bounds");return(256*e.buffer[e.start++]+e.buffer[e.start++]).toString(16)+":"+(256*e.buffer[e.start++]+e.buffer[e.start++]).toString(16)+":"+(256*e.buffer[e.start++]+e.buffer[e.start++]).toString(16)+":"+(256*e.buffer[e.start++]+e.buffer[e.start++]).toString(16)+":"+(256*e.buffer[e.start++]+e.buffer[e.start++]).toString(16)+":"+(256*e.buffer[e.start++]+e.buffer[e.start++]).toString(16)+":"+(256*e.buffer[e.start++]+e.buffer[e.start++]).toString(16)+":"+(256*e.buffer[e.start++]+e.buffer[e.start++]).toString(16)}},Zc=jc(Xc,6),$c={preencode(e,t){const n=t.includes(":")?6:4;qc.uint8.preencode(e,n),4===n?Wc.preencode(e):Xc.preencode(e)},encode(e,t){const n=t.includes(":")?6:4;qc.uint8.encode(e,n),4===n?Wc.encode(e,t):Xc.encode(e,t)},decode:e=>4===qc.uint8.decode(e)?Wc.decode(e):Xc.decode(e)},eu={preencode(e,t){$c.preencode(e,t.host),Jc.preencode(e,t.port)},encode(e,t){$c.encode(e,t.host),Jc.encode(e,t.port)},decode(e){const t=qc.uint8.decode(e);return{host:4===t?Wc.decode(e):Xc.decode(e),family:t,port:Jc.decode(e)}}};var tu={port:Jc,ipv4:Wc,ipv4Address:zc,ipv6:Xc,ipv6Address:Zc,ip:$c,ipAddress:eu};const nu=oo,ru=I,iu=nu.crypto_secretstream_xchacha20poly1305_ABYTES,su=nu.crypto_secretstream_xchacha20poly1305_TAG_MESSAGE,ou=nu.crypto_secretstream_xchacha20poly1305_TAG_FINAL,au=nu.crypto_secretstream_xchacha20poly1305_STATEBYTES,hu=nu.crypto_secretstream_xchacha20poly1305_HEADERBYTES,cu=nu.crypto_secretstream_xchacha20poly1305_KEYBYTES,uu=ru.isBuffer(ou)?ou[0]:ou,lu=ru.alloc(0),du=ru.alloc(1);var fu={keygen:function(e=ru.alloc(cu)){return nu.crypto_secretstream_xchacha20poly1305_keygen(e),e},KEYBYTES:cu,ABYTES:iu,STATEBYTES:au,HEADERBYTES:hu,Push:class{constructor(e,t=ru.allocUnsafe(au),n=ru.allocUnsafe(hu)){if(!ou)throw new Error("JavaScript sodium version needs to support crypto_secretstream_xchacha20poly");this.key=e,this.state=t,this.header=n,nu.crypto_secretstream_xchacha20poly1305_init_push(this.state,this.header,this.key)}next(e,t=ru.allocUnsafe(e.byteLength+iu)){return nu.crypto_secretstream_xchacha20poly1305_push(this.state,t,e,null,su),t}final(e=lu,t=ru.allocUnsafe(iu)){return nu.crypto_secretstream_xchacha20poly1305_push(this.state,t,e,null,ou),t}},Pull:class{constructor(e,t=ru.allocUnsafe(au)){if(!ou)throw new Error("JavaScript sodium version needs to support crypto_secretstream_xchacha20poly");this.key=e,this.state=t,this.final=!1}init(e){nu.crypto_secretstream_xchacha20poly1305_init_pull(this.state,e,this.key)}next(e,t=ru.allocUnsafe(e.byteLength-iu)){return nu.crypto_secretstream_xchacha20poly1305_pull(this.state,t,du,e,null),this.final=du[0]===uu,t}}},Au={};const gu=oo,pu=La,yu=I,_u=yu.from([0]),bu=yu.from([1]),Iu=yu.from([2]),Eu=yu.from("hypercore");function mu(){}function wu(){wu.init.call(this)}function Cu(e){return void 0===e._maxListeners?wu.defaultMaxListeners:e._maxListeners}function Su(e,t,n,r){var i,s,o,a;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if((s=e._events)?(s.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),s=e._events),o=s[t]):(s=e._events=new mu,e._eventsCount=0),o){if("function"==typeof o?o=s[t]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),!o.warned&&(i=Cu(e))&&i>0&&o.length>i){o.warned=!0;var h=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");h.name="MaxListenersExceededWarning",h.emitter=e,h.type=t,h.count=o.length,a=h,"function"==typeof console.warn?console.warn(a):console.log(a)}}else o=s[t]=n,++e._eventsCount;return e}function Bu(e,t,n){var r=!1;function i(){e.removeListener(t,i),r||(r=!0,n.apply(e,arguments))}return i.listener=n,i}function Qu(e){var t=this._events;if(t){var n=t[e];if("function"==typeof n)return 1;if(n)return n.length}return 0}function vu(e,t){for(var n=new Array(t);t--;)n[t]=e[t];return n}Au.keyPair=function(e){const t=yu.allocUnsafe(gu.crypto_sign_PUBLICKEYBYTES),n=yu.allocUnsafe(gu.crypto_sign_SECRETKEYBYTES);return e?gu.crypto_sign_seed_keypair(t,n,e):gu.crypto_sign_keypair(t,n),{publicKey:t,secretKey:n}},Au.validateKeyPair=function(e){const t=yu.allocUnsafe(gu.crypto_sign_PUBLICKEYBYTES);return gu.crypto_sign_ed25519_sk_to_pk(t,e.secretKey),yu.equals(t,e.publicKey)},Au.sign=function(e,t){const n=yu.allocUnsafe(gu.crypto_sign_BYTES);return gu.crypto_sign_detached(n,e,t),n},Au.verify=function(e,t,n){return gu.crypto_sign_verify_detached(t,e,n)},Au.data=function(e){const t=yu.allocUnsafe(32);return gu.crypto_generichash_batch(t,[_u,pu.encode(pu.uint64,e.byteLength),e]),t},Au.parent=function(e,t){if(e.index>t.index){const n=e;e=t,t=n}const n=yu.allocUnsafe(32);return gu.crypto_generichash_batch(n,[bu,pu.encode(pu.uint64,e.size+t.size),e.hash,t.hash]),n},Au.tree=function(e,t){const n=new Array(3*e.length+1);let r=0;n[r++]=Iu;for(let t=0;t<e.length;t++){const i=e[t];n[r++]=i.hash,n[r++]=pu.encode(pu.uint64,i.index),n[r++]=pu.encode(pu.uint64,i.size)}return t||(t=yu.allocUnsafe(32)),gu.crypto_generichash_batch(t,n),t},Au.hash=function(e,t){return t||(t=yu.allocUnsafe(32)),Array.isArray(e)||(e=[e]),gu.crypto_generichash_batch(t,e),t},Au.randomBytes=function(e){const t=yu.allocUnsafe(e);return gu.randombytes_buf(t),t},Au.discoveryKey=function(e){const t=yu.allocUnsafe(32);return gu.crypto_generichash(t,Eu,e),t},gu.sodium_free?Au.free=function(e){e.secure&&gu.sodium_free(e)}:Au.free=function(){},Au.namespace=function(e,t){const n="number"==typeof t?function(e){const t=new Array(e);for(let n=0;n<e;n++)t[n]=n;return t}(t):t,r=yu.allocUnsafe(32*n.length),i=new Array(n.length),s=yu.allocUnsafe(33);gu.crypto_generichash(s.subarray(0,32),"string"==typeof e?yu.from(e):e);for(let e=0;e<i.length;e++)i[e]=r.subarray(32*e,32*e+32),s[32]=n[e],gu.crypto_generichash(i[e],s);return i},mu.prototype=Object.create(null),wu.EventEmitter=wu,wu.usingDomains=!1,wu.prototype.domain=void 0,wu.prototype._events=void 0,wu.prototype._maxListeners=void 0,wu.defaultMaxListeners=10,wu.init=function(){this.domain=null,wu.usingDomains&&(void 0).active,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new mu,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},wu.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},wu.prototype.getMaxListeners=function(){return Cu(this)},wu.prototype.emit=function(e){var t,n,r,i,s,o,a,h="error"===e;if(o=this._events)h=h&&null==o.error;else if(!h)return!1;if(a=this.domain,h){if(t=arguments[1],!a){if(t instanceof Error)throw t;var c=new Error('Uncaught, unspecified "error" event. ('+t+")");throw c.context=t,c}return t||(t=new Error('Uncaught, unspecified "error" event')),t.domainEmitter=this,t.domain=a,t.domainThrown=!1,a.emit("error",t),!1}if(!(n=o[e]))return!1;var u="function"==typeof n;switch(r=arguments.length){case 1:!function(e,t,n){if(t)e.call(n);else for(var r=e.length,i=vu(e,r),s=0;s<r;++s)i[s].call(n)}(n,u,this);break;case 2:!function(e,t,n,r){if(t)e.call(n,r);else for(var i=e.length,s=vu(e,i),o=0;o<i;++o)s[o].call(n,r)}(n,u,this,arguments[1]);break;case 3:!function(e,t,n,r,i){if(t)e.call(n,r,i);else for(var s=e.length,o=vu(e,s),a=0;a<s;++a)o[a].call(n,r,i)}(n,u,this,arguments[1],arguments[2]);break;case 4:!function(e,t,n,r,i,s){if(t)e.call(n,r,i,s);else for(var o=e.length,a=vu(e,o),h=0;h<o;++h)a[h].call(n,r,i,s)}(n,u,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(r-1),s=1;s<r;s++)i[s-1]=arguments[s];!function(e,t,n,r){if(t)e.apply(n,r);else for(var i=e.length,s=vu(e,i),o=0;o<i;++o)s[o].apply(n,r)}(n,u,this,i)}return!0},wu.prototype.addListener=function(e,t){return Su(this,e,t,!1)},wu.prototype.on=wu.prototype.addListener,wu.prototype.prependListener=function(e,t){return Su(this,e,t,!0)},wu.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,Bu(this,e,t)),this},wu.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,Bu(this,e,t)),this},wu.prototype.removeListener=function(e,t){var n,r,i,s,o;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(r=this._events))return this;if(!(n=r[e]))return this;if(n===t||n.listener&&n.listener===t)0==--this._eventsCount?this._events=new mu:(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,s=n.length;s-- >0;)if(n[s]===t||n[s].listener&&n[s].listener===t){o=n[s].listener,i=s;break}if(i<0)return this;if(1===n.length){if(n[0]=void 0,0==--this._eventsCount)return this._events=new mu,this;delete r[e]}else!function(e,t){for(var n=t,r=n+1,i=e.length;r<i;n+=1,r+=1)e[n]=e[r];e.pop()}(n,i);r.removeListener&&this.emit("removeListener",e,o||t)}return this},wu.prototype.off=function(e,t){return this.removeListener(e,t)},wu.prototype.removeAllListeners=function(e){var t,n;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=new mu,this._eventsCount=0):n[e]&&(0==--this._eventsCount?this._events=new mu:delete n[e]),this;if(0===arguments.length){for(var r,i=Object.keys(n),s=0;s<i.length;++s)"removeListener"!==(r=i[s])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=new mu,this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(t)do{this.removeListener(e,t[t.length-1])}while(t[0]);return this},wu.prototype.listeners=function(e){var t,n=this._events;return n&&(t=n[e])?"function"==typeof t?[t.listener||t]:function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(t):[]},wu.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):Qu.call(e,t)},wu.prototype.listenerCount=Qu,wu.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var xu=function(e){return e&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}(Object.freeze({__proto__:null,default:wu,EventEmitter:wu}));const{EventEmitter:Lu}=xu,ku=new Error("Stream was destroyed"),Du=new Error("Premature close"),Uu=Ma,Ku=Za,Mu=268435455,Tu=1^Mu,Yu=16384,Nu=32768,Pu=131072,Ou=768^Mu,Fu=268402687,Hu=268304383,Ru=2<<18,Gu=4<<18,Vu=8<<18,qu=32<<18,Ju=64<<18,ju=128<<18,Wu=512<<18,zu=201064447,Xu=234881023,Zu=262160,$u=8404992,el=8405006,tl=33587200,nl=33587215,rl=2359311,il=Symbol.asyncIterator||Symbol("asyncIterator");let sl=class{constructor(e,{highWaterMark:t=16384,map:n=null,mapWritable:r,byteLength:i,byteLengthWritable:s}={}){this.stream=e,this.queue=new Ku,this.highWaterMark=t,this.buffered=0,this.error=null,this.pipeline=null,this.drains=null,this.byteLength=s||i||Ql,this.map=r||n,this.afterWrite=dl.bind(this),this.afterUpdateNextTick=gl.bind(this)}get ended(){return!!(this.stream._duplexState&qu)}push(e){return null!==this.map&&(e=this.map(e)),this.buffered+=this.byteLength(e),this.queue.push(e),this.buffered<this.highWaterMark?(this.stream._duplexState|=Vu,!0):(this.stream._duplexState|=6291456,!1)}shift(){const e=this.queue.shift();return this.buffered-=this.byteLength(e),0===this.buffered&&(this.stream._duplexState&=266338303),e}end(e){"function"==typeof e?this.stream.once("finish",e):null!=e&&this.push(e),this.stream._duplexState=267386879&(this.stream._duplexState|Wu)}autoBatch(e,t){const n=[],r=this.stream;for(n.push(e);2359296==(r._duplexState&rl);)n.push(r._writableState.shift());if(15&r._duplexState)return t(null);r._writev(n,t)}update(){const e=this.stream;e._duplexState|=Ru;do{for(;(e._duplexState&rl)===Vu;){const t=this.shift();e._duplexState|=67371008,e._write(t,this.afterWrite)}!(1310720&e._duplexState)&&this.updateNonPrimary()}while(!0===this.continueUpdate());e._duplexState&=267911167}updateNonPrimary(){const e=this.stream;if((144965647&e._duplexState)===Wu)return e._duplexState=134217727&e._duplexState|262144,void e._final(ul.bind(this));4!=(14&e._duplexState)?1==(e._duplexState&nl)&&(e._duplexState=(e._duplexState|Zu)&Tu,e._open(pl.bind(this))):!(e._duplexState&tl)&&(e._duplexState|=Zu,e._destroy(ll.bind(this)))}continueUpdate(){return!!(this.stream._duplexState&ju)&&(this.stream._duplexState&=Xu,!0)}updateCallback(){(35127311&this.stream._duplexState)===Gu?this.update():this.updateNextTick()}updateNextTick(){!(this.stream._duplexState&ju)&&(this.stream._duplexState|=ju,!(this.stream._duplexState&Ru)&&Uu(this.afterUpdateNextTick))}},ol=class{constructor(e,{highWaterMark:t=16384,map:n=null,mapReadable:r,byteLength:i,byteLengthReadable:s}={}){this.stream=e,this.queue=new Ku,this.highWaterMark=0===t?1:t,this.buffered=0,this.readAhead=t>0,this.error=null,this.pipeline=null,this.byteLength=s||i||Ql,this.map=r||n,this.pipeTo=null,this.afterRead=fl.bind(this),this.afterUpdateNextTick=Al.bind(this)}get ended(){return!!(this.stream._duplexState&Yu)}pipe(e,t){if(null!==this.pipeTo)throw new Error("Can only pipe to one destination");if("function"!=typeof t&&(t=null),this.stream._duplexState|=512,this.pipeTo=e,this.pipeline=new hl(this.stream,e,t),t&&this.stream.on("error",vl),Bl(e))e._writableState.pipeline=this.pipeline,t&&e.on("error",vl),e.on("finish",this.pipeline.finished.bind(this.pipeline));else{const t=this.pipeline.done.bind(this.pipeline,e),n=this.pipeline.done.bind(this.pipeline,e,null);e.on("error",t),e.on("close",n),e.on("finish",this.pipeline.finished.bind(this.pipeline))}e.on("drain",cl.bind(this)),this.stream.emit("piping",e),e.emit("pipe",this.stream)}push(e){const t=this.stream;return null===e?(this.highWaterMark=0,t._duplexState=268369855&t._duplexState|1024,!1):(null!==this.map&&(e=this.map(e)),this.buffered+=this.byteLength(e),this.queue.push(e),t._duplexState=268369919&t._duplexState|128,this.buffered<this.highWaterMark)}shift(){const e=this.queue.shift();return this.buffered-=this.byteLength(e),0===this.buffered&&(this.stream._duplexState&=268427135),e}unshift(e){const t=[null!==this.map?this.map(e):e];for(;this.buffered>0;)t.push(this.shift());for(let e=0;e<t.length-1;e++){const n=t[e];this.buffered+=this.byteLength(n),this.queue.push(n)}this.push(t[t.length-1])}read(){const e=this.stream;if(128==(16527&e._duplexState)){const t=this.shift();return null!==this.pipeTo&&!1===this.pipeTo.write(t)&&(e._duplexState&=Ou),!!(2048&e._duplexState)&&e.emit("data",t),t}return!1===this.readAhead&&(e._duplexState|=Pu,this.updateNextTick()),null}drain(){const e=this.stream;for(;128==(16527&e._duplexState)&&768&e._duplexState;){const t=this.shift();null!==this.pipeTo&&!1===this.pipeTo.write(t)&&(e._duplexState&=Ou),2048&e._duplexState&&e.emit("data",t)}}update(){const e=this.stream;e._duplexState|=32;do{for(this.drain();this.buffered<this.highWaterMark&&(214047&e._duplexState)===Pu;)e._duplexState|=65552,e._read(this.afterRead),this.drain();4224==(12431&e._duplexState)&&(e._duplexState|=8192,e.emit("readable")),!(80&e._duplexState)&&this.updateNonPrimary()}while(!0===this.continueUpdate());e._duplexState&=268435423}updateNonPrimary(){const e=this.stream;1024==(1167&e._duplexState)&&(e._duplexState=268434431&(e._duplexState|Yu),e.emit("end"),(e._duplexState&el)===$u&&(e._duplexState|=4),null!==this.pipeTo&&this.pipeTo.end()),4!=(14&e._duplexState)?1==(e._duplexState&nl)&&(e._duplexState=(e._duplexState|Zu)&Tu,e._open(pl.bind(this))):!(e._duplexState&tl)&&(e._duplexState|=Zu,e._destroy(ll.bind(this)))}continueUpdate(){return!!(this.stream._duplexState&Nu)&&(this.stream._duplexState&=Fu,!0)}updateCallback(){64==(32879&this.stream._duplexState)?this.update():this.updateNextTick()}updateNextTick(){!(this.stream._duplexState&Nu)&&(this.stream._duplexState|=Nu,!(32&this.stream._duplexState)&&Uu(this.afterUpdateNextTick))}},al=class{constructor(e){this.data=null,this.afterTransform=yl.bind(e),this.afterFinal=null}},hl=class{constructor(e,t,n){this.from=e,this.to=t,this.afterPipe=n,this.error=null,this.pipeToFinished=!1}finished(){this.pipeToFinished=!0}done(e,t){t&&(this.error=t),e!==this.to||(this.to=null,null===this.from)?e!==this.from||(this.from=null,null===this.to)?(null!==this.afterPipe&&this.afterPipe(this.error),this.to=this.from=this.afterPipe=null):!(e._duplexState&Yu)&&this.to.destroy(this.error||new Error("Readable stream closed before ending")):this.from._duplexState&Yu&&this.pipeToFinished||this.from.destroy(this.error||new Error("Writable stream closed prematurely"))}};function cl(){this.stream._duplexState|=512,this.updateCallback()}function ul(e){const t=this.stream;e&&t.destroy(e),!(14&t._duplexState)&&(t._duplexState|=qu,t.emit("finish")),(t._duplexState&el)===$u&&(t._duplexState|=4),t._duplexState&=zu,t._duplexState&Ru?this.updateNextTick():this.update()}function ll(e){const t=this.stream;e||this.error===ku||(e=this.error),e&&t.emit("error",e),t._duplexState|=8,t.emit("close");const n=t._readableState,r=t._writableState;if(null!==n&&null!==n.pipeline&&n.pipeline.done(t,e),null!==r){for(;null!==r.drains&&r.drains.length>0;)r.drains.shift().resolve(!1);null!==r.pipeline&&r.pipeline.done(t,e)}}function dl(e){const t=this.stream;e&&t.destroy(e),t._duplexState&=zu,null!==this.drains&&function(e){for(let t=0;t<e.length;t++)0==--e[t].writes&&(e.shift().resolve(!0),t--)}(this.drains),4194304==(6553615&t._duplexState)&&(t._duplexState&=264241151,(t._duplexState&Ju)===Ju&&t.emit("drain")),this.updateCallback()}function fl(e){e&&this.stream.destroy(e),this.stream._duplexState&=268435439,!1===this.readAhead&&!(256&this.stream._duplexState)&&(this.stream._duplexState&=Hu),this.updateCallback()}function Al(){!(32&this.stream._duplexState)&&(this.stream._duplexState&=Fu,this.update())}function gl(){!(this.stream._duplexState&Ru)&&(this.stream._duplexState&=Xu,this.update())}function pl(e){const t=this.stream;e&&t.destroy(e),!(4&t._duplexState)&&(!(17423&t._duplexState)&&(t._duplexState|=64),!(142606351&t._duplexState)&&(t._duplexState|=Gu),t.emit("open")),t._duplexState&=268173295,null!==t._writableState&&t._writableState.updateCallback(),null!==t._readableState&&t._readableState.updateCallback()}function yl(e,t){null!=t&&this.push(t),this._writableState.afterWrite(e)}function _l(e){null!==this._readableState&&("data"===e&&(this._duplexState|=133376,this._readableState.updateNextTick()),"readable"===e&&(this._duplexState|=4096,this._readableState.updateNextTick())),null!==this._writableState&&"drain"===e&&(this._duplexState|=Ju,this._writableState.updateNextTick())}let bl=class extends Lu{constructor(e){super(),this._duplexState=0,this._readableState=null,this._writableState=null,e&&(e.open&&(this._open=e.open),e.destroy&&(this._destroy=e.destroy),e.predestroy&&(this._predestroy=e.predestroy),e.signal&&e.signal.addEventListener("abort",xl.bind(this))),this.on("newListener",_l)}_open(e){e(null)}_destroy(e){e(null)}_predestroy(){}get readable(){return null!==this._readableState||void 0}get writable(){return null!==this._writableState||void 0}get destroyed(){return!!(8&this._duplexState)}get destroying(){return!!(14&this._duplexState)}destroy(e){!(14&this._duplexState)&&(e||(e=ku),this._duplexState=267386815&this._duplexState|4,null!==this._readableState&&(this._readableState.highWaterMark=0,this._readableState.error=e),null!==this._writableState&&(this._writableState.highWaterMark=0,this._writableState.error=e),this._duplexState|=2,this._predestroy(),this._duplexState&=268435453,null!==this._readableState&&this._readableState.updateNextTick(),null!==this._writableState&&this._writableState.updateNextTick())}},Il=class e extends bl{constructor(e){super(e),this._duplexState|=8519681,this._readableState=new ol(this,e),e&&(!1===this._readableState.readAhead&&(this._duplexState&=Hu),e.read&&(this._read=e.read),e.eagerOpen&&this._readableState.updateNextTick())}_read(e){e(null)}pipe(e,t){return this._readableState.updateNextTick(),this._readableState.pipe(e,t),e}read(){return this._readableState.updateNextTick(),this._readableState.read()}push(e){return this._readableState.updateNextTick(),this._readableState.push(e)}unshift(e){return this._readableState.updateNextTick(),this._readableState.unshift(e)}resume(){return this._duplexState|=131328,this._readableState.updateNextTick(),this}pause(){return this._duplexState&=!1===this._readableState.readAhead?268304127:268435199,this}static _fromAsyncIterator(t,n){let r;const i=new e({...n,read(e){t.next().then(s).then(e.bind(null,null)).catch(e)},predestroy(){r=t.return()},destroy(e){if(!r)return e(null);r.then(e.bind(null,null)).catch(e)}});return i;function s(e){e.done?i.push(null):i.push(e.value)}}static from(t,n){if(Bl(r=t)&&r.readable)return t;var r;if(t[il])return this._fromAsyncIterator(t[il](),n);Array.isArray(t)||(t=void 0===t?[]:[t]);let i=0;return new e({...n,read(e){this.push(i===t.length?null:t[i++]),e(null)}})}static isBackpressured(e){return!!(17422&e._duplexState)||e._readableState.buffered>=e._readableState.highWaterMark}static isPaused(e){return!(256&e._duplexState)}[il](){const e=this;let t=null,n=null,r=null;return this.on("error",(e=>{t=e})),this.on("readable",(function(){null!==n&&i(e.read())})),this.on("close",(function(){null!==n&&i(null)})),{[il](){return this},next:()=>new Promise((function(t,s){n=t,r=s;const o=e.read();null!==o?i(o):8&e._duplexState&&i(null)})),return:()=>s(null),throw:e=>s(e)};function i(i){null!==r&&(t?r(t):null!==i||e._duplexState&Yu?n({value:i,done:null===i}):r(ku),r=n=null)}function s(t){return e.destroy(t),new Promise(((n,r)=>{if(8&e._duplexState)return n({value:void 0,done:!0});e.once("close",(function(){t?r(t):n({value:void 0,done:!0})}))}))}}},El=class extends Il{constructor(e){super(e),this._duplexState=1|this._duplexState&Pu,this._writableState=new sl(this,e),e&&(e.writev&&(this._writev=e.writev),e.write&&(this._write=e.write),e.final&&(this._final=e.final))}_writev(e,t){t(null)}_write(e,t){this._writableState.autoBatch(e,t)}_final(e){e(null)}write(e){return this._writableState.updateNextTick(),this._writableState.push(e)}end(e){return this._writableState.updateNextTick(),this._writableState.end(e),this}},ml=class extends El{constructor(e){super(e),this._transformState=new al(this),e&&(e.transform&&(this._transform=e.transform),e.flush&&(this._flush=e.flush))}_write(e,t){this._readableState.buffered>=this._readableState.highWaterMark?this._transformState.data=e:this._transform(e,this._transformState.afterTransform)}_read(e){if(null!==this._transformState.data){const t=this._transformState.data;this._transformState.data=null,e(null),this._transform(t,this._transformState.afterTransform)}else e(null)}destroy(e){super.destroy(e),null!==this._transformState.data&&(this._transformState.data=null,this._transformState.afterTransform())}_transform(e,t){t(null,e)}_flush(e){e(null)}_final(e){this._transformState.afterFinal=e,this._flush(wl.bind(this))}};function wl(e,t){const n=this._transformState.afterFinal;if(e)return n(e);null!=t&&this.push(t),this.push(null),n(null)}function Cl(e,...t){const n=Array.isArray(e)?[...e,...t]:[e,...t],r=n.length&&"function"==typeof n[n.length-1]?n.pop():null;if(n.length<2)throw new Error("Pipeline requires at least 2 streams");let i=n[0],s=null,o=null;for(let e=1;e<n.length;e++)s=n[e],Bl(i)?i.pipe(s,h):(a(i,!0,e>1,h),i.pipe(s)),i=s;if(r){let e=!1;const t=Bl(s)||!(!s._writableState||!s._writableState.autoDestroy);s.on("error",(e=>{null===o&&(o=e)})),s.on("finish",(()=>{e=!0,t||r(o)})),t&&s.on("close",(()=>r(o||(e?null:Du))))}return s;function a(e,t,n,r){e.on("error",r),e.on("close",(function(){return e._readableState&&!e._readableState.ended||n&&e._writableState&&!e._writableState.ended?r(Du):void 0}))}function h(e){if(e&&!o){o=e;for(const t of n)t.destroy(e)}}}function Sl(e){return!!e._readableState||!!e._writableState}function Bl(e){return"number"==typeof e._duplexState&&Sl(e)}function Ql(e){return function(e){return"object"==typeof e&&null!==e&&"number"==typeof e.byteLength}(e)?e.byteLength:1024}function vl(){}function xl(){this.destroy(new Error("Stream aborted."))}var Ll={pipeline:Cl,pipelinePromise:function(...e){return new Promise(((t,n)=>Cl(...e,(e=>{if(e)return n(e);t()}))))},isStream:Sl,isStreamx:Bl,getStreamError:function(e){const t=e._readableState&&e._readableState.error||e._writableState&&e._writableState.error;return t===ku?null:t},Stream:bl,Writable:class e extends bl{constructor(e){super(e),this._duplexState|=16385,this._writableState=new sl(this,e),e&&(e.writev&&(this._writev=e.writev),e.write&&(this._write=e.write),e.final&&(this._final=e.final),e.eagerOpen&&this._writableState.updateNextTick())}_writev(e,t){t(null)}_write(e,t){this._writableState.autoBatch(e,t)}_final(e){e(null)}static isBackpressured(e){return!!(146800654&e._duplexState)}static drained(t){if(t.destroyed)return Promise.resolve(!1);const n=t._writableState;var r;const i=((r=t)._writev!==e.prototype._writev&&r._writev!==El.prototype._writev?Math.min(1,n.queue.length):n.queue.length)+(67108864&t._duplexState?1:0);return 0===i?Promise.resolve(!0):(null===n.drains&&(n.drains=[]),new Promise((e=>{n.drains.push({writes:i,resolve:e})})))}write(e){return this._writableState.updateNextTick(),this._writableState.push(e)}end(e){return this._writableState.updateNextTick(),this._writableState.end(e),this}},Readable:Il,Duplex:El,Transform:ml,PassThrough:class extends ml{}},kl=class{constructor(e,t,n=null,r=!1){this.ms=e,this.ontimeout=t,this.context=n||null,this.interval=r,this.done=!1,this._timer=r?setInterval(Ul,e,this):setTimeout(Dl,e,this)}unref(){}ref(){}refresh(){this.done||(this.interval?(clearInterval(this._timer),this._timer=setInterval(Ul,this.ms,this)):(clearTimeout(this._timer),this._timer=setTimeout(Dl,this.ms,this)))}destroy(){this.done=!0,this.ontimeout=null,this.interval?clearInterval(this._timer):clearTimeout(this._timer)}static once(e,t,n){return new this(e,t,n,!1)}static on(e,t,n){return new this(e,t,n,!0)}};function Dl(e){e.done=!0,e.ontimeout.call(e.context)}function Ul(e){e.ontimeout.call(e.context)}var Kl=so;const Ml=Kl,Tl=e,Yl=P,Nl=Ml.crypto_scalarmult_ed25519_BYTES,Pl=Ml.crypto_scalarmult_ed25519_BYTES,Ol=Ml.crypto_scalarmult_ed25519_BYTES,Fl=Ml.crypto_sign_SECRETKEYBYTES,Hl="Ed25519";var Rl={DHLEN:Nl,PKLEN:Pl,SCALARLEN:Ol,SKLEN:Fl,ALG:Hl,name:Hl,generateKeyPair:function(e){if(e)return function(e){const t={};return t.secretKey=Yl.alloc(Fl),t.publicKey=Yl.alloc(Pl),Ml.crypto_sign_seed_keypair(t.publicKey,t.secretKey,e),t}(e.subarray(0,32));const t={};return t.secretKey=Yl.alloc(Fl),t.publicKey=Yl.alloc(Pl),Ml.crypto_sign_keypair(t.publicKey,t.secretKey),t},dh:function(e,{scalar:t,secretKey:n}){if(!t){Tl(n.byteLength===Fl);const e=Yl.alloc(64);Ml.crypto_hash_sha512(e,n.subarray(0,32)),e[0]&=248,e[31]&=127,e[31]|=64,t=e.subarray(0,32)}Tl(t.byteLength===Ol),Tl(e.byteLength===Pl);const r=Yl.alloc(Nl);return Ml.crypto_scalarmult_ed25519_noclamp(r,t,e),r}};const Gl=Kl,Vl=P,{crypto_kx_SEEDBYTES:ql,crypto_kx_keypair:Jl,crypto_kx_seed_keypair:jl,crypto_scalarmult_BYTES:Wl,crypto_scalarmult_SCALARBYTES:zl,crypto_scalarmult:Xl,crypto_scalarmult_base:Zl}=Kl,$l=e,ed=P,td=Wl,nd=Wl,rd=zl;var id={DHLEN:td,PKLEN:nd,SKLEN:rd,SEEDLEN:ql,ALG:"25519",generateKeyPair:function(e){const t={};return t.secretKey=e||ed.alloc(rd),t.publicKey=ed.alloc(nd),e?Zl(t.publicKey,t.secretKey):Jl(t.publicKey,t.secretKey),t},generateSeedKeyPair:function(e){$l(e.byteLength===rd);const t={};return t.secretKey=ed.alloc(rd),t.publicKey=ed.alloc(nd),jl(t.publicKey,t.secretKey,e),t},dh:function(e,{secretKey:t}){$l(t.byteLength===rd),$l(e.byteLength===nd);const n=ed.alloc(td);return Xl(n,t,e),n}},sd={exports:{}};const od=P,{sodium_memzero:ad,crypto_generichash:hd,crypto_generichash_batch:cd}=Kl,ud=od.alloc(384),ld=ud.subarray(0,128),dd=ud.subarray(128,256),fd=ud.subarray(256,384);sd.exports=function(e,t,n){n.byteLength>128?(hd(ld.subarray(0,64),n),ad(ld.subarray(64))):(ld.set(n),ad(ld.subarray(n.byteLength)));for(let e=0;e<ld.byteLength;e++)dd[e]=92^ld[e],fd[e]=54^ld[e];ad(ld),cd(e,[fd].concat(t)),ad(fd),cd(e,[dd].concat(e)),ad(dd)},sd.exports.BYTES=64,sd.exports.KEYBYTES=128;const Ad=sd.exports,gd=e,pd=P,yd=64;var _d={hkdf:function(e,t,n="",r=128){const i=function(e,t,n){const r=[pd.from(t)],i=n/yd;for(let n=0;n<i;n++){const i=pd.from(t),s=pd.concat([r[n],i,pd.from([n+1])]);r[n+1]=bd(e,s)}const s=pd.concat(r.slice(1));return gd(s.byteLength===n,"key expansion failed, length not as expected"),s}(function(e,t){return bd(e,t)}(e,t),n,r),s=[];let o=0;for(;o<i.length;)s.push(i.subarray(o,o+yd)),o+=yd;return s},HASHLEN:yd};function bd(e,t){const n=pd.alloc(yd);return Ad(n,t,e),n}const Id=Kl,Ed=e,md=P,wd=class{constructor(e){this.key=e||null,this.nonce=0,this.CIPHER_ALG="ChaChaPoly"}initialiseKey(e){this.key=e,this.nonce=0}setNonce(e){this.nonce=e}encrypt(e,t){if(!this.hasKey)return e;t||(t=Vl.alloc(0));const n=function(e,t,n,r){Vl.isBuffer(n)||(n=Vl.from(n,"hex")),Vl.isBuffer(r)||(r=Vl.from(r,"hex"));const i=Vl.alloc(Gl.crypto_aead_chacha20poly1305_ietf_NPUBBYTES);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint32(4,t,!0);const s=Vl.alloc(r.byteLength+Gl.crypto_aead_chacha20poly1305_ietf_ABYTES);return Gl.crypto_aead_chacha20poly1305_ietf_encrypt(s,r,n,null,i,e),s}(this.key,this.nonce,t,e);return this.nonce++,n}decrypt(e,t){if(!this.hasKey)return e;t||(t=Vl.alloc(0));const n=function(e,t,n,r){Vl.isBuffer(n)||(n=Vl.from(n,"hex")),Vl.isBuffer(r)||(r=Vl.from(r,"hex"));const i=Vl.alloc(Gl.crypto_aead_chacha20poly1305_ietf_NPUBBYTES);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint32(4,t,!0);const s=Vl.alloc(r.byteLength-Gl.crypto_aead_chacha20poly1305_ietf_ABYTES);return Gl.crypto_aead_chacha20poly1305_ietf_decrypt(s,null,r,n,i,e),s}(this.key,this.nonce,t,e);return this.nonce++,n}get hasKey(){return null!==this.key}_clear(){Gl.sodium_memzero(this.key),this.key=null,this.nonce=null}static get MACBYTES(){return 16}static get NONCEBYTES(){return 8}static get KEYBYTES(){return 32}},Cd=id,{HASHLEN:Sd,hkdf:Bd}=_d;function Qd(e,t){const n=md.concat([e,t]);Id.crypto_generichash(e,n)}const vd=e,xd=P,Ld=class extends wd{constructor(e={}){super(),this.curve=e.curve||Cd,this.digest=md.alloc(Sd),this.chainingKey=null,this.offset=0,this.DH_ALG=this.curve.ALG}mixHash(e){Qd(this.digest,e)}mixKeyAndHash(e){const[t,n,r]=Bd(this.chainingKey,e,"",3*Sd);this.chainingKey=t,this.mixHash(n),this.initialiseKey(r.subarray(0,32))}mixKeyNormal(e){const[t,n]=Bd(this.chainingKey,e);this.chainingKey=t,this.initialiseKey(n.subarray(0,32))}mixKey(e,t){const n=this.curve.dh(e,t),r=Bd(this.chainingKey,n);this.chainingKey=r[0],this.initialiseKey(r[1].subarray(0,32))}encryptAndHash(e){const t=this.encrypt(e,this.digest);return Qd(this.digest,t),t}decryptAndHash(e){const t=this.decrypt(e,this.digest);return Qd(this.digest,e),t}getHandshakeHash(e){return e?(Ed(e.byteLength===Sd,`output must be ${Sd} bytes`),e.set(this.digest),e):this.getHandshakeHash(md.alloc(Sd))}split(){return Bd(this.chainingKey,md.alloc(0)).map((e=>e.subarray(0,32)))}_clear(){super._clear(),Id.sodium_memzero(this.digest),Id.sodium_memzero(this.chainingKey),this.digest=null,this.chainingKey=null,this.offset=null,this.curve=null}static get alg(){return wd.alg+"_BLAKE2b"}},{HASHLEN:kd}=_d,Dd=Symbol("initiator static key preshared"),Ud=Symbol("responder static key preshared"),Kd=Symbol("psk"),Md=Symbol("s"),Td=Symbol("e"),Yd=Symbol("es"),Nd=Symbol("se"),Pd=Symbol("ee"),Od=Symbol("ss"),Fd=Object.freeze({NN:[[Td],[Td,Pd]],NNpsk0:[[Kd,Td],[Td,Pd]],XX:[[Td],[Td,Pd,Md,Yd],[Md,Nd]],XXpsk0:[[Kd,Td],[Td,Pd,Md,Yd],[Md,Nd]],IK:[Ud,[Td,Yd,Md,Od],[Td,Pd,Nd]]});let Hd=class{constructor(){this.size=0,this.buffers=[]}push(e){this.size+=e.byteLength,this.buffers.push(e)}end(){const e=xd.alloc(this.size);let t=0;for(const n of this.buffers)e.set(n,t),t+=n.byteLength;return e}},Rd=class{constructor(e){this.offset=0,this.buffer=e}shift(e){const t=this.offset,n=this.offset+=e;if(n>this.buffer.byteLength)throw new Error("Insufficient bytes");return this.buffer.subarray(t,n)}end(){return this.shift(this.buffer.byteLength-this.offset)}};var Gd=class extends Ld{constructor(e,t,n,r={}){super(r),this.s=n||this.curve.generateKeyPair(),this.e=null,this.psk=null,r&&r.psk&&(this.psk=r.psk),this.re=null,this.rs=null,this.pattern=e,this.handshake=Fd[this.pattern].slice(),this.isPskHandshake=!!this.psk&&this.handshake.some((e=>Array.isArray(e)&&-1!==e.indexOf(Kd))),this.protocol=xd.from(["Noise",this.pattern,this.DH_ALG,this.CIPHER_ALG,"BLAKE2b"].join("_")),this.initiator=t,this.complete=!1,this.rx=null,this.tx=null,this.hash=null}initialise(e,t){for(this.protocol.byteLength<=kd?this.digest.set(this.protocol):this.mixHash(this.protocol),this.chainingKey=xd.from(this.digest),this.mixHash(e);!Array.isArray(this.handshake[0]);){const e=this.handshake.shift();vd(e===Ud||e===Dd,"Unexpected pattern");const n=this.initiator?e===Ud:e===Dd;n&&(this.rs=t);const r=n?this.rs:this.s.publicKey;vd(null!=r,"Remote pubkey required"),this.mixHash(r)}}final(){const[e,t]=this.split();this.tx=this.initiator?e:t,this.rx=this.initiator?t:e,this.complete=!0,this.hash=this.getHandshakeHash(),this._clear()}recv(e){const t=new Rd(e);for(const e of this.handshake.shift())switch(e){case Kd:this.mixKeyAndHash(this.psk);break;case Td:this.re=t.shift(this.curve.PKLEN),this.mixHash(this.re),this.isPskHandshake&&this.mixKeyNormal(this.re);break;case Md:{const e=this.hasKey?this.curve.PKLEN+16:this.curve.PKLEN;this.rs=this.decryptAndHash(t.shift(e));break}case Pd:case Yd:case Nd:case Od:{const t=Vd(e,this.initiator),n=t.local?this.s:this.e,r=t.remote?this.rs:this.re;this.mixKey(r,n);break}default:throw new Error("Unexpected message")}const n=this.decryptAndHash(t.end());return this.handshake.length||this.final(),n}send(e=xd.alloc(0)){const t=new Hd;for(const e of this.handshake.shift())switch(e){case Kd:this.mixKeyAndHash(this.psk);break;case Td:null===this.e&&(this.e=this.curve.generateKeyPair()),this.mixHash(this.e.publicKey),this.isPskHandshake&&this.mixKeyNormal(this.e.publicKey),t.push(this.e.publicKey);break;case Md:t.push(this.encryptAndHash(this.s.publicKey));break;case Yd:case Nd:case Pd:case Od:{const t=Vd(e,this.initiator),n=t.local?this.s:this.e,r=t.remote?this.rs:this.re;this.mixKey(r,n);break}default:throw new Error("Unexpected message")}t.push(this.encryptAndHash(e));const n=t.end();return this.handshake.length||this.final(),n}_clear(){super._clear(),this.e.secretKey.fill(0),this.e.publicKey.fill(0),this.re.fill(0),this.e=null,this.re=null}};function Vd(e,t){const n={local:!1,remote:!1};switch(e){case Pd:return n;case Yd:return n.local^=!t,n.remote^=t,n;case Nd:return n.local^=t,n.remote^=!t,n;case Od:return n.local^=1,n.remote^=1,n}}const{Duplex:qd,Writable:Jd}=Ll;let jd=class extends qd{constructor(e){super(),this._stream=e,this._ondrain=null}_write(e,t){!1===this._stream.push(e)?this._stream._ondrain=t:t(null)}_final(e){this._stream.push(null),e(null)}_read(e){const t=this._ondrain;this._ondrain=null,t&&t(),e(null)}};const Wd=oo,zd=Rl,Xd=Gd,Zd=I,$d=Zd.alloc(0),{Pull:ef,Push:tf,HEADERBYTES:nf,KEYBYTES:rf,ABYTES:sf}=fu,of=oo,af=Au,{Duplex:hf,Writable:cf,getStreamError:uf}=Ll,lf=I,df=kl,ff=class extends qd{constructor(e){super(),this.noiseStream=e,this._ondrain=null,this.reverse=new jd(this)}get publicKey(){return this.noiseStream.publicKey}get remotePublicKey(){return this.noiseStream.remotePublicKey}get handshakeHash(){return this.noiseStream.handshakeHash}flush(){return Jd.drained(this)}_read(e){const t=this._ondrain;this._ondrain=null,t&&t(),e(null)}_write(e,t){!1===this.reverse.push(e)?this.reverse._ondrain=t:t(null)}_final(e){this.reverse.push(null),e(null)}},Af=class{constructor(e,t,n,r){this.isInitiator=e,this.keyPair=t,this.noise=new Xd(r,e,t,{curve:zd}),this.noise.initialise($d,n),this.destroyed=!1}static keyPair(e){const t=Zd.alloc(32),n=Zd.alloc(64);return e?Wd.crypto_sign_seed_keypair(t,n,e):Wd.crypto_sign_keypair(t,n),{publicKey:t,secretKey:n}}recv(e){try{return this.noise.recv(e),this.noise.complete?this._return(null):this.send()}catch{return this.destroy(),null}}send(){try{const n=this.noise.send(),r=Zd.allocUnsafe(n.byteLength+3);return e=n.byteLength,(t=r)[0]=255&e,t[1]=e>>>8&255,t[2]=e>>>16&255,r.set(n,3),this._return(r)}catch{return this.destroy(),null}var e,t}destroy(){this.destroyed||(this.destroyed=!0)}_return(e){const t=this.noise.complete?Zd.toBuffer(this.noise.tx):null,n=this.noise.complete?Zd.toBuffer(this.noise.rx):null,r=this.noise.complete?Zd.toBuffer(this.noise.hash):null;return{data:e,remotePublicKey:this.noise.complete?Zd.toBuffer(this.noise.rs):null,hash:r,tx:t,rx:n}}},gf=nf+32,[pf,yf]=af.namespace("hyperswarm/secret-stream",2),_f=16777215;var bf=class extends hf{constructor(e,t,n={}){if(super({mapWritable:mf}),"boolean"!=typeof e)throw new Error("isInitiator should be a boolean");this.noiseStream=this,this.isInitiator=e,this.rawStream=null,this.publicKey=n.publicKey||null,this.remotePublicKey=n.remotePublicKey||null,this.handshakeHash=null,this.connected=!1,this.keepAlive=n.keepAlive||0,this.timeout=0,this.userData=null;let r=null;this.opened=new Promise((e=>{r=e})),this._rawStream=null,this._handshake=null,this._handshakePattern=n.pattern||null,this._handshakeDone=null,this._state=0,this._len=0,this._tmp=1,this._message=null,this._openedDone=r,this._startDone=null,this._drainDone=null,this._outgoingPlain=null,this._outgoingWrapped=null,this._utp=null,this._setup=!0,this._ended=2,this._encrypt=null,this._decrypt=null,this._timeoutTimer=null,this._keepAliveTimer=null,!1!==n.autoStart&&this.start(t,n),this.resume(),this.pause()}static keyPair(e){return Af.keyPair(e)}static id(e,t,n){return Ef(e,t,n)}setTimeout(e){e||(e=0),this._clearTimeout(),this.timeout=e,e&&null!==this.rawStream&&(this._timeoutTimer=df.once(e,wf,this),this._timeoutTimer.unref())}setKeepAlive(e){e||(e=0),this.keepAlive=e,e&&null!==this.rawStream&&(this._keepAliveTimer=df.on(e,Cf,this),this._keepAliveTimer.unref())}start(e,t={}){e?(this.rawStream=e,this._rawStream=e,"function"==typeof this.rawStream.setContentSize&&(this._utp=e)):(this.rawStream=new ff(this),this._rawStream=this.rawStream.reverse),this.rawStream.on("error",this._onrawerror.bind(this)),this.rawStream.on("close",this._onrawclose.bind(this)),this._startHandshake(t.handshake,t.keyPair||null),this._continueOpen(null),this.destroying||(t.data&&this._onrawdata(t.data),t.ended&&this._onrawend(),this.keepAlive>0&&null===this._keepAliveTimer&&this.setKeepAlive(this.keepAlive),this.timeout>0&&null===this._timeoutTimer&&this.setTimeout(this.timeout))}async flush(){return!1!==await this.opened&&!1!==await cf.drained(this)&&!this.destroying&&(null===this.rawStream||!this.rawStream.flush||await this.rawStream.flush())}_continueOpen(e){if(e&&this.destroy(e),null===this._startDone)return;const t=this._startDone;this._startDone=null,this._open(t)}_onkeypairpromise(e){const t=this,n=this._continueOpen.bind(this);e.then((function(e){t._onkeypair(e),n(null)}),n)}_onkeypair(e){const t=this._handshakePattern||"XX",n=this.remotePublicKey;this._handshake=new Af(this.isInitiator,e,n,t),this.publicKey=this._handshake.keyPair.publicKey}_startHandshake(e,t){if(e){const{tx:t,rx:n,hash:r,publicKey:i,remotePublicKey:s}=e;this._setupSecretStream(t,n,r,i,s)}else t||(t=Af.keyPair()),"function"==typeof t.then?this._onkeypairpromise(t):this._onkeypair(t)}_onrawerror(e){this.destroy(e)}_onrawclose(){0!==this._ended&&this.destroy()}_onrawdata(e){let t=0;null!==this._timeoutTimer&&this._timeoutTimer.refresh();do{switch(this._state){case 0:for(;16777216!==this._tmp&&t<e.length;){const n=e[t++];this._len+=this._tmp*n,this._tmp*=256}if(16777216===this._tmp){this._tmp=0,this._state=1;const n=e.length-t;n<this._len&&null!==this._utp&&this._utp.setContentSize(this._len-n)}break;case 1:{const n=this._len-this._tmp,r=n+t;if(null===this._message&&r<=e.length){this._message=e.subarray(t,r),t+=n,this._incoming();break}const i=e.length-t;null===this._message&&(this._message=lf.allocUnsafe(this._len)),lf.copy(e,this._message,this._tmp,t),this._tmp+=i,r<=e.length?(t+=n,this._incoming()):t+=i;break}}}while(t<e.length&&!this.destroying)}_onrawend(){this._ended--,this.push(null)}_onrawdrain(){const e=this._drainDone;null!==e&&(this._drainDone=null,e())}_read(e){this.rawStream.resume(),e(null)}_incoming(){const e=this._message;if(this._state=0,this._len=0,this._tmp=1,this._message=null,!0===this._setup){if(this._handshake)this._onhandshakert(this._handshake.recv(e));else{if(e.byteLength!==gf)return void this.destroy(new Error("Invalid header message received"));const t=e.subarray(0,32),n=Ef(this.handshakeHash,!this.isInitiator),r=e.subarray(32);if(!lf.equals(n,t))return void this.destroy(new Error("Invalid header received"));this._decrypt.init(r),this._setup=!1}return}if(e.length<sf)return void this.destroy(new Error("Invalid message received"));const t=e.subarray(1,e.byteLength-sf+1);try{this._decrypt.next(e,t)}catch(e){return void this.destroy(e)}0===t.byteLength&&0!==this.keepAlive||!1===this.push(t)&&this.rawStream.pause()}_onhandshakert(e){if(null===this._handshakeDone)return;if(null!==e&&(e.data&&this._rawStream.write(e.data),!e.tx))return;const t=this._handshakeDone,n=this._handshake.keyPair.publicKey;if(this._handshakeDone=null,this._handshake=null,null===e)return t(new Error("Noise handshake failed"));this._setupSecretStream(e.tx,e.rx,e.hash,n,e.remotePublicKey),this._resolveOpened(!0),t(null)}_setupSecretStream(e,t,n,r,i){const s=lf.allocUnsafe(3+gf);If(gf,s),this._encrypt=new tf(e.subarray(0,rf),void 0,s.subarray(35)),this._decrypt=new ef(t.subarray(0,rf)),this.publicKey=r,this.remotePublicKey=i,this.handshakeHash=n;const o=s.subarray(3,35);Ef(n,this.isInitiator,o),this.emit("handshake"),this.rawStream!==this._rawStream&&this.rawStream.emit("handshake"),this.destroying||this._rawStream.write(s)}_open(e){if(null===this._rawStream||null===this._handshake&&null===this._encrypt)this._startDone=e;else{if(this._rawStream.on("data",this._onrawdata.bind(this)),this._rawStream.on("end",this._onrawend.bind(this)),this._rawStream.on("drain",this._onrawdrain.bind(this)),null!==this._encrypt)return this._resolveOpened(!0),e(null);this._handshakeDone=e,this.isInitiator&&this._onhandshakert(this._handshake.send())}}_predestroy(){if(this.rawStream){const e=uf(this);this.rawStream.destroy(e)}if(null!==this._startDone){const e=this._startDone;this._startDone=null,e(new Error("Stream destroyed"))}if(null!==this._handshakeDone){const e=this._handshakeDone;this._handshakeDone=null,e(new Error("Stream destroyed"))}if(null!==this._drainDone){const e=this._drainDone;this._drainDone=null,e(new Error("Stream destroyed"))}}_write(e,t){let n=this._outgoingWrapped;if(e!==this._outgoingPlain?(n=lf.allocUnsafe(e.byteLength+3+sf),n.set(e,4)):this._outgoingWrapped=this._outgoingPlain=null,n.byteLength-3>_f)return t(new Error("Message is too large for an atomic write. Max size is "+_f+" bytes."));If(n.byteLength-3,n),this._encrypt.next(n.subarray(4,4+e.byteLength),n.subarray(3)),null!==this._keepAliveTimer&&this._keepAliveTimer.refresh(),!1===this._rawStream.write(n)?this._drainDone=t:t(null)}_final(e){this._clearKeepAlive(),this._ended--,this._rawStream.end(),e(null)}_resolveOpened(e){if(null===this._openedDone)return;const t=this._openedDone;this._openedDone=null,t(e),e&&(this.connected=!0,this.emit("connect"))}_clearTimeout(){null!==this._timeoutTimer&&(this._timeoutTimer.destroy(),this._timeoutTimer=null,this.timeout=0)}_clearKeepAlive(){null!==this._keepAliveTimer&&(this._keepAliveTimer.destroy(),this._keepAliveTimer=null,this.keepAlive=0)}_destroy(e){this._clearKeepAlive(),this._clearTimeout(),this._resolveOpened(!1),e(null)}alloc(e){const t=lf.allocUnsafe(e+3+sf);return this._outgoingWrapped=t,this._outgoingPlain=t.subarray(4,t.byteLength-sf+1),this._outgoingPlain}toJSON(){return{isInitiator:this.isInitiator,publicKey:this.publicKey&&lf.toString(this.publicKey,"hex"),remotePublicKey:this.remotePublicKey&&lf.toString(this.remotePublicKey,"hex"),connected:this.connected,destroying:this.destroying,destroyed:this.destroyed,rawStream:this.rawStream&&this.rawStream.toJSON?this.rawStream.toJSON():null}}};function If(e,t){t[0]=255&e,t[1]=e>>>8&255,t[2]=e>>>16&255}function Ef(e,t,n=lf.allocUnsafe(32)){return of.crypto_generichash(n,t?pf:yf,e),n}function mf(e){return"string"==typeof e?lf.from(e):e}function wf(){this.destroy(new Error("Stream timed out"))}function Cf(){const e=this.alloc(0);this.write(e)}var Sf={};const Bf=Au,Qf=Sf.COMMANDS={PEER_HANDSHAKE:0,PEER_HOLEPUNCH:1,FIND_PEER:2,LOOKUP:3,ANNOUNCE:4,UNANNOUNCE:5,MUTABLE_PUT:6,MUTABLE_GET:7,IMMUTABLE_PUT:8,IMMUTABLE_GET:9};Sf.BOOTSTRAP_NODES=[{host:"node1.hyperdht.org",port:49737},{host:"node2.hyperdht.org",port:49737},{host:"node3.hyperdht.org",port:49737}],Sf.FIREWALL={UNKNOWN:0,OPEN:1,CONSISTENT:2,RANDOM:3},Sf.ERROR={NONE:0,ABORTED:1,VERSION_MISMATCH:2,TRY_LATER:3,SEQ_REUSED:16,SEQ_TOO_LOW:17};const[vf,xf,Lf,kf,Df]=Bf.namespace("hyperswarm/dht",[Qf.ANNOUNCE,Qf.UNANNOUNCE,Qf.MUTABLE_PUT,Qf.PEER_HANDSHAKE,Qf.PEER_HOLEPUNCH]);Sf.NS={ANNOUNCE:vf,UNANNOUNCE:xf,MUTABLE_PUT:Lf,PEER_HANDSHAKE:kf,PEER_HOLEPUNCH:Df};const Uf=Kl,Kf=e,Mf=P,Tf=Uf.crypto_scalarmult_ed25519_BYTES,Yf=Uf.crypto_scalarmult_ed25519_BYTES,Nf=Uf.crypto_scalarmult_ed25519_BYTES,Pf=Uf.crypto_sign_SECRETKEYBYTES,Of="Ed25519";var Ff={DHLEN:Tf,PKLEN:Yf,SCALARLEN:Nf,SKLEN:Pf,ALG:Of,name:Of,generateKeyPair:function(e){if(e)return function(e){const t={};return t.secretKey=Mf.alloc(Pf),t.publicKey=Mf.alloc(Yf),Uf.crypto_sign_seed_keypair(t.publicKey,t.secretKey,e),t}(e.subarray(0,32));const t={};return t.secretKey=Mf.alloc(Pf),t.publicKey=Mf.alloc(Yf),Uf.crypto_sign_keypair(t.publicKey,t.secretKey),t},dh:function(e,{scalar:t,secretKey:n}){if(!t){Kf(n.byteLength===Pf);const e=Mf.alloc(64);Uf.crypto_hash_sha512(e,n.subarray(0,32)),e[0]&=248,e[31]&=127,e[31]|=64,t=e.subarray(0,32)}Kf(t.byteLength===Nf),Kf(e.byteLength===Yf);const r=Mf.alloc(Tf);return Uf.crypto_scalarmult_ed25519_noclamp(r,t,e),r}},Hf={};const Rf=La,Gf=tu,Vf={...Gf.ipv4Address,decode(e){const t=Gf.ipv4Address.decode(e);return{host:t.host,port:t.port}}},qf=Rf.array(Vf),Jf={...Gf.ipv6Address,decode(e){const t=Gf.ipv6Address.decode(e);return{host:t.host,port:t.port}}},jf=Rf.array(Jf);Hf.handshake={preencode(e,t){e.end+=2+(t.peerAddress?6:0)+(t.relayAddress?6:0),Rf.buffer.preencode(e,t.noise)},encode(e,t){const n=(t.peerAddress?1:0)|(t.relayAddress?2:0);Rf.uint.encode(e,n),Rf.uint.encode(e,t.mode),Rf.buffer.encode(e,t.noise),t.peerAddress&&Vf.encode(e,t.peerAddress),t.relayAddress&&Vf.encode(e,t.relayAddress)},decode(e){const t=Rf.uint.decode(e);return{mode:Rf.uint.decode(e),noise:Rf.buffer.decode(e),peerAddress:1&t?Vf.decode(e):null,relayAddress:2&t?Vf.decode(e):null}}};const Wf={preencode(e,t){e.end+=12},encode(e,t){Vf.encode(e,t.relayAddress),Vf.encode(e,t.peerAddress)},decode:e=>({relayAddress:Vf.decode(e),peerAddress:Vf.decode(e)})},zf=Rf.array(Wf),Xf={preencode(e,t){Rf.uint.preencode(e,t.id),zf.preencode(e,t.relays)},encode(e,t){Rf.uint.encode(e,t.id),zf.encode(e,t.relays)},decode:e=>({id:Rf.uint.decode(e),relays:zf.decode(e)})},Zf={preencode(e,t){e.end+=2,Rf.uint.preencode(e,t.id),Rf.uint.preencode(e,t.seq)},encode(e,t){Rf.uint.encode(e,1),Rf.uint.encode(e,t.reusableSocket?1:0),Rf.uint.encode(e,t.id),Rf.uint.encode(e,t.seq)},decode:e=>({version:Rf.uint.decode(e),reusableSocket:!!(1&Rf.uint.decode(e)),id:Rf.uint.decode(e),seq:Rf.uint.decode(e)})},$f={preencode(e,t){Rf.uint.preencode(e,1)},encode(e,t){Rf.uint.encode(e,1)},decode:e=>({version:Rf.uint.decode(e)})},eA={preencode(e,t){Rf.uint.preencode(e,1),Rf.uint.preencode(e,0),Rf.fixed32.preencode(e,t.publicKey),Rf.fixed32.preencode(e,t.token)},encode(e,t){Rf.uint.encode(e,1),Rf.uint.encode(e,0),Rf.fixed32.encode(e,t.publicKey),Rf.fixed32.encode(e,t.token)},decode(e){const t=Rf.uint.decode(e);return Rf.uint.decode(e),{version:t,publicKey:Rf.fixed32.decode(e),token:Rf.fixed32.decode(e)}}};Hf.noisePayload={preencode(e,t){e.end+=4,t.holepunch&&Xf.preencode(e,t.holepunch),t.addresses4&&t.addresses4.length&&qf.preencode(e,t.addresses4),t.addresses6&&t.addresses6.length&&jf.preencode(e,t.addresses6),t.udx&&Zf.preencode(e,t.udx),t.secretStream&&$f.preencode(e,t.secretStream),t.relayThrough&&eA.preencode(e,t.relayThrough)},encode(e,t){let n=0;t.holepunch&&(n|=1),t.addresses4&&t.addresses4.length&&(n|=2),t.addresses6&&t.addresses6.length&&(n|=4),t.udx&&(n|=8),t.secretStream&&(n|=16),t.relayThrough&&(n|=32),Rf.uint.encode(e,1),Rf.uint.encode(e,n),Rf.uint.encode(e,t.error),Rf.uint.encode(e,t.firewall),t.holepunch&&Xf.encode(e,t.holepunch),t.addresses4&&t.addresses4.length&&qf.encode(e,t.addresses4),t.addresses6&&t.addresses6.length&&jf.encode(e,t.addresses6),t.udx&&Zf.encode(e,t.udx),t.secretStream&&$f.encode(e,t.secretStream),t.relayThrough&&eA.encode(e,t.relayThrough)},decode(e){const t=Rf.uint.decode(e);if(1!==t)return{version:t,error:0,firewall:0,holepunch:null,addresses4:[],addresses6:[],udx:null,secretStream:null,relayThrough:null};const n=Rf.uint.decode(e);return{version:t,error:Rf.uint.decode(e),firewall:Rf.uint.decode(e),holepunch:1&n?Xf.decode(e):null,addresses4:2&n?qf.decode(e):[],addresses6:4&n?jf.decode(e):[],udx:8&n?Zf.decode(e):null,secretStream:16&n?$f.decode(e):null,relayThrough:32&n?eA.decode(e):null}}},Hf.holepunch={preencode(e,t){e.end+=2,Rf.uint.preencode(e,t.id),Rf.buffer.preencode(e,t.payload),t.peerAddress&&Vf.preencode(e,t.peerAddress)},encode(e,t){const n=t.peerAddress?1:0;Rf.uint.encode(e,n),Rf.uint.encode(e,t.mode),Rf.uint.encode(e,t.id),Rf.buffer.encode(e,t.payload),t.peerAddress&&Vf.encode(e,t.peerAddress)},decode(e){const t=Rf.uint.decode(e);return{mode:Rf.uint.decode(e),id:Rf.uint.decode(e),payload:Rf.buffer.decode(e),peerAddress:1&t?Vf.decode(e):null}}},Hf.holepunchPayload={preencode(e,t){e.end+=4,t.addresses&&qf.preencode(e,t.addresses),t.remoteAddress&&(e.end+=6),t.token&&(e.end+=32),t.remoteToken&&(e.end+=32)},encode(e,t){const n=(t.connected?1:0)|(t.punching?2:0)|(t.addresses?4:0)|(t.remoteAddress?8:0)|(t.token?16:0)|(t.remoteToken?32:0);Rf.uint.encode(e,n),Rf.uint.encode(e,t.error),Rf.uint.encode(e,t.firewall),Rf.uint.encode(e,t.round),t.addresses&&qf.encode(e,t.addresses),t.remoteAddress&&Vf.encode(e,t.remoteAddress),t.token&&Rf.fixed32.encode(e,t.token),t.remoteToken&&Rf.fixed32.encode(e,t.remoteToken)},decode(e){const t=Rf.uint.decode(e);return{error:Rf.uint.decode(e),firewall:Rf.uint.decode(e),round:Rf.uint.decode(e),connected:!!(1&t),punching:!!(2&t),addresses:4&t?qf.decode(e):null,remoteAddress:8&t?Vf.decode(e):null,token:16&t?Rf.fixed32.decode(e):null,remoteToken:32&t?Rf.fixed32.decode(e):null}}};const tA=Hf.peer={preencode(e,t){e.end+=32,qf.preencode(e,t.relayAddresses)},encode(e,t){Rf.fixed32.encode(e,t.publicKey),qf.encode(e,t.relayAddresses)},decode:e=>({publicKey:Rf.fixed32.decode(e),relayAddresses:qf.decode(e)})};Hf.peers=Rf.array(tA),Hf.announce={preencode(e,t){e.end++,t.peer&&tA.preencode(e,t.peer),t.refresh&&(e.end+=32),t.signature&&(e.end+=64)},encode(e,t){const n=(t.peer?1:0)|(t.refresh?2:0)|(t.signature?4:0);Rf.uint.encode(e,n),t.peer&&tA.encode(e,t.peer),t.refresh&&Rf.fixed32.encode(e,t.refresh),t.signature&&Rf.fixed64.encode(e,t.signature)},decode(e){const t=Rf.uint.decode(e);return{peer:1&t?tA.decode(e):null,refresh:2&t?Rf.fixed32.decode(e):null,signature:4&t?Rf.fixed64.decode(e):null}}},Hf.mutableSignable={preencode(e,t){Rf.uint.preencode(e,t.seq),Rf.buffer.preencode(e,t.value)},encode(e,t){Rf.uint.encode(e,t.seq),Rf.buffer.encode(e,t.value)},decode:e=>({seq:Rf.uint.decode(e),value:Rf.buffer.decode(e)})},Hf.mutablePutRequest={preencode(e,t){Rf.fixed32.preencode(e,t.publicKey),Rf.uint.preencode(e,t.seq),Rf.buffer.preencode(e,t.value),Rf.fixed64.preencode(e,t.signature)},encode(e,t){Rf.fixed32.encode(e,t.publicKey),Rf.uint.encode(e,t.seq),Rf.buffer.encode(e,t.value),Rf.fixed64.encode(e,t.signature)},decode:e=>({publicKey:Rf.fixed32.decode(e),seq:Rf.uint.decode(e),value:Rf.buffer.decode(e),signature:Rf.fixed64.decode(e)})},Hf.mutableGetResponse={preencode(e,t){Rf.uint.preencode(e,t.seq),Rf.buffer.preencode(e,t.value),Rf.fixed64.preencode(e,t.signature)},encode(e,t){Rf.uint.encode(e,t.seq),Rf.buffer.encode(e,t.value),Rf.fixed64.encode(e,t.signature)},decode:e=>({seq:Rf.uint.decode(e),value:Rf.buffer.decode(e),signature:Rf.fixed64.decode(e)})};var nA={exports:{}};function rA(){}function iA(){iA.init.call(this)}function sA(e){return void 0===e._maxListeners?iA.defaultMaxListeners:e._maxListeners}function oA(e,t,n,r){var i,s,o,a;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if((s=e._events)?(s.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),s=e._events),o=s[t]):(s=e._events=new rA,e._eventsCount=0),o){if("function"==typeof o?o=s[t]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),!o.warned&&(i=sA(e))&&i>0&&o.length>i){o.warned=!0;var h=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");h.name="MaxListenersExceededWarning",h.emitter=e,h.type=t,h.count=o.length,a=h,"function"==typeof console.warn?console.warn(a):console.log(a)}}else o=s[t]=n,++e._eventsCount;return e}function aA(e,t,n){var r=!1;function i(){e.removeListener(t,i),r||(r=!0,n.apply(e,arguments))}return i.listener=n,i}function hA(e){var t=this._events;if(t){var n=t[e];if("function"==typeof n)return 1;if(n)return n.length}return 0}function cA(e,t){for(var n=new Array(t);t--;)n[t]=e[t];return n}rA.prototype=Object.create(null),iA.EventEmitter=iA,iA.usingDomains=!1,iA.prototype.domain=void 0,iA.prototype._events=void 0,iA.prototype._maxListeners=void 0,iA.defaultMaxListeners=10,iA.init=function(){this.domain=null,iA.usingDomains&&(void 0).active,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new rA,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},iA.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},iA.prototype.getMaxListeners=function(){return sA(this)},iA.prototype.emit=function(e){var t,n,r,i,s,o,a,h="error"===e;if(o=this._events)h=h&&null==o.error;else if(!h)return!1;if(a=this.domain,h){if(t=arguments[1],!a){if(t instanceof Error)throw t;var c=new Error('Uncaught, unspecified "error" event. ('+t+")");throw c.context=t,c}return t||(t=new Error('Uncaught, unspecified "error" event')),t.domainEmitter=this,t.domain=a,t.domainThrown=!1,a.emit("error",t),!1}if(!(n=o[e]))return!1;var u="function"==typeof n;switch(r=arguments.length){case 1:!function(e,t,n){if(t)e.call(n);else for(var r=e.length,i=cA(e,r),s=0;s<r;++s)i[s].call(n)}(n,u,this);break;case 2:!function(e,t,n,r){if(t)e.call(n,r);else for(var i=e.length,s=cA(e,i),o=0;o<i;++o)s[o].call(n,r)}(n,u,this,arguments[1]);break;case 3:!function(e,t,n,r,i){if(t)e.call(n,r,i);else for(var s=e.length,o=cA(e,s),a=0;a<s;++a)o[a].call(n,r,i)}(n,u,this,arguments[1],arguments[2]);break;case 4:!function(e,t,n,r,i,s){if(t)e.call(n,r,i,s);else for(var o=e.length,a=cA(e,o),h=0;h<o;++h)a[h].call(n,r,i,s)}(n,u,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(r-1),s=1;s<r;s++)i[s-1]=arguments[s];!function(e,t,n,r){if(t)e.apply(n,r);else for(var i=e.length,s=cA(e,i),o=0;o<i;++o)s[o].apply(n,r)}(n,u,this,i)}return!0},iA.prototype.addListener=function(e,t){return oA(this,e,t,!1)},iA.prototype.on=iA.prototype.addListener,iA.prototype.prependListener=function(e,t){return oA(this,e,t,!0)},iA.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,aA(this,e,t)),this},iA.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,aA(this,e,t)),this},iA.prototype.removeListener=function(e,t){var n,r,i,s,o;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(r=this._events))return this;if(!(n=r[e]))return this;if(n===t||n.listener&&n.listener===t)0==--this._eventsCount?this._events=new rA:(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,s=n.length;s-- >0;)if(n[s]===t||n[s].listener&&n[s].listener===t){o=n[s].listener,i=s;break}if(i<0)return this;if(1===n.length){if(n[0]=void 0,0==--this._eventsCount)return this._events=new rA,this;delete r[e]}else!function(e,t){for(var n=t,r=n+1,i=e.length;r<i;n+=1,r+=1)e[n]=e[r];e.pop()}(n,i);r.removeListener&&this.emit("removeListener",e,o||t)}return this},iA.prototype.off=function(e,t){return this.removeListener(e,t)},iA.prototype.removeAllListeners=function(e){var t,n;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=new rA,this._eventsCount=0):n[e]&&(0==--this._eventsCount?this._events=new rA:delete n[e]),this;if(0===arguments.length){for(var r,i=Object.keys(n),s=0;s<i.length;++s)"removeListener"!==(r=i[s])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=new rA,this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(t)do{this.removeListener(e,t[t.length-1])}while(t[0]);return this},iA.prototype.listeners=function(e){var t,n=this._events;return n&&(t=n[e])?"function"==typeof t?[t.listener||t]:function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(t):[]},iA.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):hA.call(e,t)},iA.prototype.listenerCount=hA,iA.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var uA=function(e){return e&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}(Object.freeze({__proto__:null,default:iA,EventEmitter:iA}));const{fixed32:lA,fixed64:dA,uint32:fA,buffer:AA,array:gA}=La,{ipv4Address:pA}=tu,{alloc:yA}=I,_A={...AA,decode(e){const t=AA.decode(e);return null===t?yA(0):t}},bA=lA,IA=dA,EA=lA,mA=AA,wA=fA,CA=gA(_A),SA=lA,BA={preencode(e,t){mA.preencode(e,t.id),pA.preencode(e,t)},encode(e,t){mA.encode(e,t.id),pA.encode(e,t)},decode:e=>({id:mA.decode(e),...pA.decode(e)})},QA=gA(pA),vA={preencode(e,t){bA.preencode(e,t.publicKey),QA.preencode(e,t.relayAddresses)},encode(e,t){bA.encode(e,t.publicKey),QA.encode(e,t.relayAddresses)},decode:e=>({publicKey:bA.decode(e),relayAddresses:QA.decode(e)})},xA=gA(vA),LA={preencode(e,t){SA.preencode(e,t.token),BA.preencode(e,t.from),BA.preencode(e,t.to),xA.preencode(e,t.peers)},encode(e,t){SA.encode(e,t.token),BA.encode(e,t.from),BA.encode(e,t.to),xA.encode(e,t.peers)},decode:e=>({token:SA.decode(e),from:BA.decode(e),to:BA.decode(e),peers:xA.decode(e)})};var kA={buffer:_A,publicKey:bA,secretKey:IA,topic:EA,peerId:mA,id:wA,batch:CA,token:SA,node:BA,relayAddresses:QA,peer:vA,peers:xA,announcers:LA};const{fixed32:DA,fixed64:UA,none:KA,string:MA}=La,{ipv4Address:TA}=tu,{buffer:YA,publicKey:NA,secretKey:PA,id:OA,batch:FA,topic:HA,peerId:RA,token:GA,relayAddresses:VA}=kA,qA={preencode(e,t){e.end++,NA.preencode(e,t.publicKey),t.custodial&&PA.preencode(e,t.secretKey)},encode(e,t){const n=e.start++;let r=0;NA.encode(e,t.publicKey),t.custodial&&(r|=1,PA.encode(e,t.secretKey)),e.buffer[n]=r},decode(e){const t=!!(1&e.buffer[e.start++]);return{custodial:t,publicKey:NA.decode(e),secretKey:t?PA.decode(e):null}}},JA={preencode(e,t){e.end++,OA.preencode(e,t.alias),NA.preencode(e,t.publicKey),t.custodial&&PA.preencode(e,t.secretKey),NA.preencode(e,t.remotePublicKey)},encode(e,t){const n=e.start++;let r=0;OA.encode(e,t.alias),NA.encode(e,t.publicKey),t.custodial&&(r|=1,PA.encode(e,t.secretKey)),e.buffer[n]=r,NA.encode(e,t.remotePublicKey)},decode(e){const t=!!(1&e.buffer[e.start++]);return{custodial:t,alias:OA.decode(e),publicKey:NA.decode(e),secretKey:t?PA.decode(e):null,remotePublicKey:NA.decode(e)}}},jA={preencode(e,t){e.end++,OA.preencode(e,t.alias),OA.preencode(e,t.serverAlias),NA.preencode(e,t.remotePublicKey),t.custodial?UA.preencode(e,t.handshakeHash):OA.preencode(e,t.handshakeId)},encode(e,t){const n=e.start++;let r=0;OA.encode(e,t.alias),OA.encode(e,t.serverAlias),NA.encode(e,t.remotePublicKey),t.custodial?(r|=1,UA.encode(e,t.handshakeHash)):OA.encode(e,t.handshakeId),e.buffer[n]=r},decode(e){const t=!!(1&e.buffer[e.start++]);return{custodial:t,alias:OA.decode(e),serverAlias:OA.decode(e),remotePublicKey:NA.decode(e),handshakeHash:t?UA.decode(e):null,handshakeId:t?null:OA.decode(e)}}},WA={preencode(e,t){OA.preencode(e,t.alias),OA.preencode(e,t.remoteAlias)},encode(e,t){OA.encode(e,t.alias),OA.encode(e,t.remoteAlias)},decode:e=>({alias:OA.decode(e),remoteAlias:OA.decode(e)})},zA={preencode(e,t){OA.preencode(e,t.id),OA.preencode(e,t.serverAlias),NA.preencode(e,t.remotePublicKey),YA.preencode(e,t.payload)},encode(e,t){OA.encode(e,t.id),OA.encode(e,t.serverAlias),NA.encode(e,t.remotePublicKey),YA.encode(e,t.payload)},decode:e=>({id:OA.decode(e),serverAlias:OA.decode(e),remotePublicKey:NA.decode(e),payload:YA.decode(e)})},XA={preencode(e,t){OA.preencode(e,t.id)},encode(e,t){OA.encode(e,t.id)},decode:e=>({id:OA.decode(e)})},ZA={preencode(e,t){e.end++,t.paired?OA.preencode(e,t.alias):OA.preencode(e,t.remoteAlias),t.error&&MA.preencode(e,t.error)},encode(e,t){const n=e.start++;let r=0;t.paired?(r|=1,OA.encode(e,t.alias)):OA.encode(e,t.remoteAlias),t.error&&(r|=2,MA.encode(e,t.error)),e.buffer[n]=r},decode(e){const t=e.buffer[e.start++],n=!!(1&t);return{paired:n,alias:n?OA.decode(e):null,remoteAlias:n?null:OA.decode(e),error:2&t?MA.decode(e):null}}},$A={preencode(e,t){e.end++,OA.preencode(e,t.server),NA.preencode(e,t.publicKey),t.custodial&&PA.preencode(e,t.secretKey)},encode(e,t){const n=e.start++;let r=0;OA.encode(e,t.alias),NA.encode(e,t.publicKey),t.custodial&&(r|=1,PA.encode(e,t.secretKey)),e.buffer[n]=r},decode(e){const t=!!(1&e.buffer[e.start++]);return{custodial:t,alias:OA.decode(e),publicKey:NA.decode(e),secretKey:t?PA.decode(e):null}}},eg={preencode(e,t){OA.preencode(e,t.alias),OA.preencode(e,t.remoteAlias),TA.preencode(e,t)},encode(e,t){OA.encode(e,t.alias),OA.encode(e,t.remoteAlias),TA.encode(e,t)},decode:e=>({alias:OA.decode(e),remoteAlias:OA.decode(e),...TA.decode(e)})},tg={preencode(e,t){OA.preencode(e,t.alias)},encode(e,t){OA.encode(e,t.alias)},decode:e=>({alias:OA.decode(e)})},ng={preencode(e,t){e.end++,OA.preencode(e,t.alias),OA.preencode(e,t.remoteAlias),t.custodial?UA.preencode(e,t.handshakeHash):OA.preencode(e,t.handshakeId)},encode(e,t){const n=e.start++;let r=0;OA.encode(e,t.alias),OA.encode(e,t.remoteAlias),t.custodial?(r|=1,UA.encode(e,t.handshakeHash)):OA.encode(e,t.handshakeId),e.buffer[n]=r},decode(e){const t=!!(1&e.buffer[e.start++]);return{custodial:t,alias:OA.decode(e),remoteAlias:OA.decode(e),handshakeHash:t?UA.decode(e):null,handshakeId:t?null:OA.decode(e)}}},rg={preencode(e,t){OA.preencode(e,t.alias)},encode(e,t){OA.encode(e,t.alias)},decode:e=>({alias:OA.decode(e)})},ig={preencode(e,t){OA.preencode(e,t.alias),FA.preencode(e,t.data)},encode(e,t){OA.encode(e,t.alias),FA.encode(e,t.data)},decode:e=>({alias:OA.decode(e),data:FA.decode(e)})},sg={preencode(e,t){OA.preencode(e,t.id),YA.preencode(e,t.data)},encode(e,t){OA.encode(e,t.id),YA.encode(e,t.data)},decode:e=>({id:OA.decode(e),data:YA.decode(e)})},og={preencode(e,t){OA.preencode(e,t.id)},encode(e,t){OA.encode(e,t.id)},decode:e=>({id:OA.decode(e)})},ag={preencode(e,t){OA.preencode(e,t.id),HA.preencode(e,t.topic)},encode(e,t){OA.encode(e,t.id),HA.encode(e,t.topic)},decode:e=>({id:OA.decode(e),topic:HA.decode(e)})},hg={preencode(e,t){e.end++,OA.preencode(e,t.id),HA.preencode(e,t.topic),NA.preencode(e,t.publicKey),t.custodial&&PA.preencode(e,t.secretKey)},encode(e,t){const n=e.start++;let r=0;OA.encode(e,t.id),HA.encode(e,t.topic),NA.encode(e,t.publicKey),t.custodial&&(r|=1,PA.encode(e,t.secretKey)),e.buffer[n]=r},decode(e){const t=!!(1&e.buffer[e.start++]);return{custodial:t,id:OA.decode(e),topic:HA.decode(e),publicKey:NA.decode(e),secretKey:t?PA.decode(e):null}}},cg={preencode(e,t){OA.preencode(e,t.id),OA.preencode(e,t.signee),GA.preencode(e,t.token),RA.preencode(e,t.peerId),VA.preencode(e,t.relayAddresses)},encode(e,t){OA.encode(e,t.id),OA.encode(e,t.signee),GA.encode(e,t.token),RA.encode(e,t.peerId),VA.encode(e,t.relayAddresses)},decode:e=>({id:OA.decode(e),signee:OA.decode(e),token:GA.decode(e),peerId:RA.decode(e),relayAddresses:VA.decode(e)})},ug={preencode(e,t){OA.preencode(e,t.id),YA.preencode(e,t.signature)},encode(e,t){OA.encode(e,t.id),YA.encode(e,t.signature)},decode:e=>({id:OA.decode(e),signature:YA.decode(e)})},lg={preencode(e,t){e.end++,OA.preencode(e,t.id),t.isInitiator&&OA.preencode(e,t.remoteStreamAlias),YA.preencode(e,t.payload)},encode(e,t){const n=e.start++;let r=0;OA.encode(e,t.id),t.isInitiator&&(r|=1,OA.encode(e,t.remoteStreamAlias)),YA.encode(e,t.payload),e.buffer[n]=r},decode(e){const t=!!(1&e.buffer[e.start++]);return{isInitiator:t,id:OA.decode(e),remoteStreamAlias:t?OA.decode(e):null,payload:YA.decode(e)}}},dg={preencode(e,t){e.end++,OA.preencode(e,t.id),t.isInitiator||OA.preencode(e,t.serverAlias),YA.preencode(e,t.payload)},encode(e,t){const n=e.start++;let r=0;OA.encode(e,t.id),t.isInitiator?r|=1:OA.encode(e,t.serverAlias),YA.encode(e,t.payload),e.buffer[n]=r},decode(e){const t=!!(1&e.buffer[e.start++]);return{isInitiator:t,id:OA.decode(e),serverAlias:t?null:OA.decode(e),payload:YA.decode(e)}}},fg={preencode(e,t){e.end++,OA.preencode(e,t.id),YA.preencode(e,t.payload),t.isInitiator||t.complete||NA.preencode(e,t.remotePublicKey),t.complete&&(DA.preencode(e,t.remoteId),DA.preencode(e,t.holepunchSecret))},encode(e,t){const n=e.start++;let r=0;OA.encode(e,t.id),YA.encode(e,t.payload),t.isInitiator&&(r|=1),t.isInitiator||t.complete||NA.encode(e,t.remotePublicKey),t.complete&&(r|=2,DA.encode(e,t.remoteId),DA.encode(e,t.holepunchSecret)),e.buffer[n]=r},decode(e){const t=e.buffer[e.start++],n=!!(1&t),r=!!(2&t);return{isInitiator:n,complete:r,id:OA.decode(e),payload:YA.decode(e),remotePublicKey:n||r?null:NA.decode(e),remoteId:r?DA.decode(e):null,holepunchSecret:r?DA.decode(e):null}}},Ag=uA,gg=Hc,pg={handshake:qA,ping:KA,pong:KA,connect:JA,connection:jA,connected:WA,incoming:zA,deny:XA,accept:XA,destroy:ZA,listen:$A,listening:eg,close:tg,closed:tg,open:ng,end:rg,data:ig,result:sg,finished:og,lookup:ag,announce:hg,unannounce:hg,signAnnounce:cg,signUnannounce:cg,signature:ug,noiseSend:lg,noiseReceive:dg,noiseReply:fg};var yg={Protocol:class extends Ag{constructor(e){super();const t=gg.from(e);this._stream=t.stream.setMaxListeners(0),this._heartbeat=null,this._failsafe=null,this._onStreamClose=_g.bind(this),this._stream.once("close",this._onStreamClose);const n=new Promise(((e,t)=>{const n=()=>{this._stream.off("error",r),e()},r=e=>{this._stream.off("open",n),t(e)};this._stream.once("open",n).once("error",r)}));this.ready=async function(){await n};const r=t.createChannel({protocol:"@hyperswarm/dht-relay"});this.handshake=r.addMessage({encoding:pg.handshake,onmessage:this.emit.bind(this,"handshake")}),this.ping=r.addMessage({encoding:pg.ping,onmessage:()=>{this.pong.send(),this.alive()}}),this.pong=r.addMessage({encoding:pg.pong,onmessage:()=>{this.alive()}}),this.connect=r.addMessage({encoding:pg.connect,onmessage:this.emit.bind(this,"connect")}),this.connection=r.addMessage({encoding:pg.connection,onmessage:this.emit.bind(this,"connection")}),this.connected=r.addMessage({encoding:pg.connected,onmessage:this.emit.bind(this,"connected")}),this.incoming=r.addMessage({encoding:pg.incoming,onmessage:this.emit.bind(this,"incoming")}),this.deny=r.addMessage({encoding:pg.deny,onmessage:this.emit.bind(this,"deny")}),this.accept=r.addMessage({encoding:pg.accept,onmessage:this.emit.bind(this,"accept")}),this.destroy=r.addMessage({encoding:pg.destroy,onmessage:this.emit.bind(this,"destroy")}),this.listen=r.addMessage({encoding:pg.listen,onmessage:this.emit.bind(this,"listen")}),this.listening=r.addMessage({encoding:pg.listening,onmessage:this.emit.bind(this,"listening")}),this.close=r.addMessage({encoding:pg.close,onmessage:this.emit.bind(this,"close")}),this.closed=r.addMessage({encoding:pg.closed,onmessage:this.emit.bind(this,"closed")}),this.open=r.addMessage({encoding:pg.open,onmessage:this.emit.bind(this,"open")}),this.end=r.addMessage({encoding:pg.end,onmessage:this.emit.bind(this,"end")}),this.data=r.addMessage({encoding:pg.data,onmessage:this.emit.bind(this,"data")}),this.result=r.addMessage({encoding:pg.result,onmessage:this.emit.bind(this,"result")}),this.finished=r.addMessage({encoding:pg.finished,onmessage:this.emit.bind(this,"finished")}),this.lookup=r.addMessage({encoding:pg.lookup,onmessage:this.emit.bind(this,"lookup")}),this.announce=r.addMessage({encoding:pg.announce,onmessage:this.emit.bind(this,"announce")}),this.unannounce=r.addMessage({encoding:pg.unannounce,onmessage:this.emit.bind(this,"unannounce")}),this.signAnnounce=r.addMessage({encoding:pg.signAnnounce,onmessage:this.emit.bind(this,"signAnnounce")}),this.signUnannounce=r.addMessage({encoding:pg.signUnannounce,onmessage:this.emit.bind(this,"signUnannounce")}),this.signature=r.addMessage({encoding:pg.signature,onmessage:this.emit.bind(this,"signature")}),this.noiseSend=r.addMessage({encoding:pg.noiseSend,onmessage:this.emit.bind(this,"noiseSend")}),this.noiseReceive=r.addMessage({encoding:pg.noiseReceive,onmessage:this.emit.bind(this,"noiseReceive")}),this.noiseReply=r.addMessage({encoding:pg.noiseReply,onmessage:this.emit.bind(this,"noiseReply")}),r.open()}heartbeat(){return this._heartbeat||(this._heartbeat=setInterval((()=>this.ping.send()),15e3)),this}alive(){return this._failsafe&&clearTimeout(this._failsafe),this._failsafe=setTimeout((()=>this._stream.destroy()),45e3),this}}};function _g(){clearInterval(this._heartbeat),this._failsafe&&clearTimeout(this._failsafe)}const bg=I,Ig=Gd,Eg=bf,{NS:mg}=Sf,wg=Ff,Cg=oo,{decode:Sg}=La,{noisePayload:Bg}=Hf,Qg=Fo,vg=mg.PEER_HANDSHAKE;var xg={Handshake:class{constructor(e,t,n,r,i,s,o){this._node=e,this._protocol=t,this._firewall=n,this._id=r,this.isInitiator=i,this.keyPair=s,this.remotePublicKey=o,this.remoteId=null,this.holepunchSecret=null,this.complete=!1,this._handshake=new Ig("IK",i,s,{curve:wg}),this._handshake.initialise(vg,o),this._onComplete=Lg.bind(this),this._onNoise=kg.bind(this),this._onNoiseSend=Dg.bind(this),this._onNoiseReceive=Ug.bind(this)}get hash(){return this._handshake.hash}get tx(){return this._handshake.tx}get rx(){return this._handshake.rx}}};function Lg(){this.complete=!0;const e=this._handshake.hash;this.remoteId=Eg.id(e,!0),this.holepunchSecret=bg.allocUnsafe(32),Cg.crypto_generichash(this.holepunchSecret,mg.PEER_HOLEPUNCH,e)}function kg(e){if(this._handshake.complete)this._onComplete();else if(this.remotePublicKey=this._handshake.rs,this._firewall){const t=Sg(Bg,e);let n=!0;try{n=this._firewall._deny(this.remotePublicKey,t)}catch(e){Qg(e)}if(n)return this._node._handshakes.delete(this._id),this._protocol.noiseReply.send({id:this._id,payload:null,remotePublicKey:this.remotePublicKey})}this._protocol.noiseReply.send({id:this._id,payload:e,isInitiator:this.isInitiator,complete:this.complete,remoteId:this.remoteId,holepunchSecret:this.holepunchSecret,remotePublicKey:this.remotePublicKey})}function Dg(e){this._onNoise(this._handshake.send(e.payload))}function Ug(e){this._onNoise(this._handshake.recv(e.payload))}var Kg={nextId:function(e,t=1,n=2**32){let r=e;return function(){const i=r;return r+=t,r>=n&&(r=e),i}}(1)};const{Readable:Mg}=Ll,{nextId:Tg}=Kg;var Yg={Query:class extends Mg{constructor(e,t,n){super({map:Ng(n)}),this._protocol=e,this.target=t,this.id=Tg(),this._onStreamClose=Pg.bind(this),this._protocol._stream.once("close",this._onStreamClose),this._onResult=Og.bind(this),this._onFinished=Fg.bind(this);const r=new Promise(((e,t)=>{const n=()=>{this.off("error",r),e()},r=e=>{this.off("close",n),t(e)};this.once("close",n).once("error",r)}));this.finished=async function(){await r}}}};function Ng(e){return function(t){return e.decode({start:0,end:t.byteLength,buffer:t})}}function Pg(){this.destroy()}function Og(e){this.push(e.data)}function Fg(){this.push(null)}const{noisePayload:Hg}=Hf,{decode:Rg}=La,Gg=Fo;var Vg={Firewall:class{constructor(e,t,n){this._node=e,this._protocol=t,this._deny=n,this._onIncoming=qg.bind(this)}}};async function qg(e){const t=Rg(Hg,e.payload);let n=!0;try{n=await this._deny(e.remotePublicKey,t)}catch(e){Gg(e)}n?this._protocol.deny.send({id:e.id}):this._protocol.accept.send({id:e.id})}const Jg=I,jg=oo,{NS:Wg}=Sf,{encode:zg}=La,{peer:Xg}=kA;var Zg={Signee:class{constructor(e,t,n){this._protocol=e,this._target=t,this._keyPair=n,this._onSignAnnounce=$g.bind(this),this._onSignUnannounce=ep.bind(this)}}};function $g(e){const t=tp(this._keyPair.publicKey,this._target,e.token,e.peerId,e.relayAddresses,Wg.ANNOUNCE),n=Jg.allocUnsafe(64);jg.crypto_sign_detached(n,t,this._keyPair.secretKey),this._protocol.signature.send({id:e.id,signature:n})}function ep(e){const t=tp(this._keyPair.publicKey,this._target,e.token,e.peerId,e.relayAddresses,Wg.UNANNOUNCE),n=Jg.allocUnsafe(64);jg.crypto_sign_detached(n,t,this._keyPair.secretKey),this._protocol.signature.send({id:e.id,signature:n})}function tp(e,t,n,r,i,s){const o=Jg.allocUnsafe(64),a=o.subarray(32);return o.set(s),jg.crypto_generichash_batch(a,[t,r,n,zg(Xg,{publicKey:e,relayAddresses:i})]),o}const{Duplex:np}=Ll,rp=I,ip=kl;var sp={Stream:class extends np{constructor(e,t,n,r,i,s,o,a){super({mapWritable:cp}),this._node=e,this._protocol=t,this._alias=n,this._remoteAlias=r,this._keyPair=s,this._opening=null,this._openedDone=null,this._timeout=null,this._timeoutMs=0,this._keepAlive=null,this._keepAliveMs=0,this.opened=new Promise((e=>{this._openedDone=e})),this.noiseStream=this,this.rawStream=this,this.isInitiator=i,this.remotePublicKey=o||null,this.handshakeHash=a||null,this._onStreamClose=op.bind(this),this._protocol._stream.once("close",this._onStreamClose),this._onOpen=ap.bind(this),this._onDestroy=hp.bind(this),this.resume().pause()}get publicKey(){return this._keyPair.publicKey}alloc(e){return rp.allocUnsafe(e)}setTimeout(e){e||(e=0),this._clearTimeout(),this._timeoutMs=e,e&&(this._timeout=ip.once(e,this._destroyTimeout,this),this._timeout.unref())}setKeepAlive(e){e||(e=0),this._keepAliveMs=e,e&&(this._keepAlive=ip.on(e,this._sendKeepAlive,this),this._keepAlive.unref())}_open(e){null===this._remoteAlias?this._opening=e:(this._resolveOpened(!0),e(null))}_continueOpen(e){const t=this._opening;t?(this._opening=null,e?t(e):this._open(t)):e&&this.destroy(e)}_resolveOpened(e){const t=this._openedDone;t&&(this._openedDone=null,t(e),e&&this.emit("connect"))}_writev(e,t){null!==this._keepAlive&&this._keepAlive.refresh(),this._protocol.data.send({alias:this._alias,data:e}),t(null)}_final(e){this._clearKeepAlive(),this._protocol.end.send({alias:this._alias}),e(null)}_predestroy(){const e=null!==this._remoteAlias;e&&this._protocol.destroy.send({paired:e,alias:this._alias});const t=new Error("Stream was destroyed");this._continueOpen(t)}_destroy(e){this._clearKeepAlive(),this._clearTimeout(),this._resolveOpened(!1),e(null)}_destroyTimeout(){this.destroy(new Error("Stream timed out"))}_clearTimeout(){null!==this._timeout&&(this._timeout.destroy(),this._timeout=null,this._timeoutMs=0)}_clearKeepAlive(){null!==this._keepAlive&&(this._keepAlive.destroy(),this._keepAlive=null,this._keepAliveMs=0)}_sendKeepAlive(){this.write(this.alloc(0))}}};function op(){this.destroy()}function ap(e){if(this._remoteAlias=e.alias,e.handshakeHash)this.handshakeHash=e.handshakeHash;else{const t=this._node._handshakes.get(e.handshakeId);this._node._handshakes.delete(e.handshakeId),this.handshakeHash=t.hash,this.noiseStream.start(this,{publicKey:this.publicKey,remotePublicKey:this.remotePublicKey,handshake:{publicKey:this.publicKey,remotePublicKey:this.remotePublicKey,hash:t.hash,tx:t.tx,rx:t.rx}})}this._continueOpen()}function hp(e){this.noiseStream.destroy(e.error&&new Error(e.error))}function cp(e){return"string"==typeof e?rp.from(e):e}const up=oo,lp=I;var dp={keyPair:function(e){const t=lp.alloc(up.crypto_sign_PUBLICKEYBYTES),n=lp.alloc(up.crypto_sign_SECRETKEYBYTES);return e?up.crypto_sign_seed_keypair(t,n,e):up.crypto_sign_keypair(t,n),{publicKey:t,secretKey:n}},hash:function(e){const t=lp.allocUnsafe(32);return up.crypto_generichash(t,e),t}};const fp=uA,Ap=bf,{Firewall:gp}=Vg,{Signee:pp}=Zg,{Stream:yp}=sp,_p=dp,{nextId:bp}=Kg;var Ip={Server:class extends fp{constructor(e,t,n,r={}){super(),this._node=e,this._protocol=t,this._alias=n,this._custodial=!1!==r.custodial,this._firewall=new gp(e,t,r.firewall||Sp),this._remoteAlias=null,this._keyPair=null,this._address=null,this._listening=null,this._closing=null,this._closed=!1,this._onStreamClose=Ep.bind(this),this._protocol._stream.once("close",this._onStreamClose),this._onClosed=mp.bind(this),this._onListening=wp.bind(this),this._onConnection=Cp.bind(this),this.ready=async function(){await this._protocol.ready()}}get closed(){return null!==this._closing}get publicKey(){return this._keyPair&&this._keyPair.publicKey}listen(e=this._node.defaultKeyPair){return this._listening||(this._keyPair=e,this._node._signees.set(this._alias,new pp(this._protocol,_p.hash(e.publicKey),e)),this._protocol.listen.send({custodial:this._custodial,alias:this._alias,publicKey:e.publicKey,secretKey:e.secretKey}),this._listening=new Promise((e=>{this.once("listening",(()=>e()))}))),this._listening}address(){return this._address}async close(){return this._closing?this._closing:this._listening?(await this._listening,this._protocol.close.send({alias:this._alias}),this._closing=new Promise((e=>{this.once("close",(()=>e()))})),this._closing):(this._closing=Promise.resolve(),this._closing)}}};function Ep(){this._closed||this._onClosed()}function mp(){this._closed=!0,this._closing=Promise.resolve(),this.emit("close")}function wp(e){this._remoteAlias=e.alias,this._address={publicKey:this.publicKey,host:e.host,port:e.port},this.emit("listening")}function Cp(e){const t=e.alias,n=bp(),r=new yp(this._node,this._protocol,n,t,!1,{publicKey:this.publicKey},e.remotePublicKey,e.handshakeHash);if(this._node._connections.set(t,r),r.once("close",(()=>{this._node._connections.delete(t)})),this._protocol.connected.send({alias:n,remoteAlias:t}),!this._custodial){const t=this._node._handshakes.get(e.handshakeId);this._node._handshakes.delete(e.handshakeId);const n=new Ap(!1,r,{publicKey:r.publicKey,remotePublicKey:r.remotePublicKey,handshake:{publicKey:r.publicKey,remotePublicKey:r.remotePublicKey,hash:t.hash,tx:t.tx,rx:t.rx}});r.noiseStream=n}this.emit("connection",r.noiseStream)}function Sp(){return!1}const Bp=uA,Qp=bf,{Handshake:vp}=xg,{Protocol:xp}=yg,{Query:Lp}=Yg,{Server:kp}=Ip,{Signee:Dp}=Zg,{Stream:Up}=sp,{announcers:Kp}=kA,{keyPair:Mp}=dp,{nextId:Tp}=Kg;var Yp={Node:class extends Bp{constructor(e,t={}){super(),this._protocol=new xp(e),this._custodial=!1!==t.custodial,this.defaultKeyPair=t.keyPair||Mp(),this._opening=new Map,this._servers=new Map,this._queries=new Map,this._connecting=new Map,this._connections=new Map,this._handshakes=new Map,this._signees=new Map,this._destroyed=!1,this._onStreamClose=Np.bind(this),this._protocol._stream.once("close",this._onStreamClose),this._onListening=Hp.bind(this),this._onClosed=Rp.bind(this),this._onConnection=Pp.bind(this),this._onIncoming=Op.bind(this),this._onDestroy=Fp.bind(this),this._onOpen=Gp.bind(this),this._onEnd=Vp.bind(this),this._onData=qp.bind(this),this._onResult=Jp.bind(this),this._onFinished=jp.bind(this),this._onSignAnnounce=Wp.bind(this),this._onSignUnannounce=zp.bind(this),this._onNoiseSend=Xp.bind(this),this._onNoiseReceive=Zp.bind(this),this._protocol.on("listening",this._onListening).on("closed",this._onClosed).on("connection",this._onConnection).on("incoming",this._onIncoming).on("destroy",this._onDestroy).on("open",this._onOpen).on("end",this._onEnd).on("data",this._onData).on("result",this._onResult).on("finished",this._onFinished).on("signAnnounce",this._onSignAnnounce).on("signUnannounce",this._onSignUnannounce).on("noiseSend",this._onNoiseSend).on("noiseReceive",this._onNoiseReceive).alive().handshake.send({custodial:this._custodial,publicKey:this.defaultKeyPair.publicKey,secretKey:this.defaultKeyPair.secretKey}),this.ready=async function(){await this._protocol.ready()}}get destroyed(){return null!==this._destroyed}connect(e,t={}){const{keyPair:n=this.defaultKeyPair}=t,r=Tp(),i=new Up(this,this._protocol,r,null,!0,n,e);this._connecting.set(r,i);const s=()=>{i.off("open",o),this._connecting.delete(i._alias),this._connections.delete(i._remoteAlias)},o=()=>{this._connecting.delete(i._alias),this._connections.set(i._remoteAlias,i)};if(i.once("close",s).once("open",o),this._protocol.connect.send({custodial:this._custodial,alias:r,publicKey:n.publicKey,secretKey:n.secretKey,remotePublicKey:e}),this._custodial)return i;const a=new Qp(!0,null,{publicKey:n.publicKey,remotePublicKey:e,autoStart:!1});return a.once("close",s),i.noiseStream=a,a}createServer(e={},t){"function"==typeof e&&(t=e,e={}),e={...e,custodial:this._custodial};const n=Tp(),r=new kp(this,this._protocol,n,e);this._opening.set(n,r);const i=()=>{this._opening.delete(r._alias),this._servers.set(r._remoteAlias,r)};return r.once("close",(()=>{r.off("listening",i),this._opening.delete(r._alias),this._servers.delete(r._remoteAlias),this._signees.delete(r._alias)})).once("listening",i),t&&r.on("connection",t),r}lookup(e){const t=new Lp(this._protocol,e,Kp);return this._queries.set(t.id,t),t.once("close",(()=>{this._queries.delete(t.id)})),this._protocol.lookup.send({id:t.id,topic:e}),t}announce(e,t){const n=new Lp(this._protocol,e,Kp);return this._queries.set(n.id,n),this._signees.set(n.id,new Dp(this._protocol,e,t)),n.once("close",(()=>{this._queries.delete(n.id),this._signees.delete(n.id)})),this._protocol.announce.send({custodial:this._custodial,id:n.id,topic:e,publicKey:t.publicKey,secretKey:t.secretKey}),n}unannounce(e,t){const n=new Lp(this._protocol,e,Kp);return this._queries.set(n.id,n),this._signees.set(n.id,new Dp(this._protocol,e,t)),n.once("close",(()=>{this._queries.delete(n.id),this._signees.delete(n.id)})),this._protocol.unannounce.send({custodial:this._custodial,id:n.id,topic:e,publicKey:t.publicKey,secretKey:t.secretKey}),n.resume().finished()}async destroy(e={}){if(!0!==e.force){const e=[];for(const t of this._servers.values())e.push(t.close());await Promise.allSettled(e)}this._destroyed||(this._destroyed=!0,this._protocol._stream.destroy())}static keyPair(e){return Mp(e)}}};function Np(){this._protocol.off("listening",this._onListening).off("closed",this._onClosed).off("connection",this._onConnection).off("incoming",this._onIncoming).off("destroy",this._onDestroy).off("open",this._onOpen).off("end",this._onEnd).off("data",this._onData).off("result",this._onResult).off("finished",this._onFinished).off("signAnnounce",this._onSignAnnounce).off("signUnannounce",this._onSignUnannounce).off("noiseSend",this._onNoiseSend).off("noiseReceive",this._onNoiseReceive)}function Pp(e){const t=this._servers.get(e.serverAlias);t&&t._onConnection(e)}function Op(e){const t=this._servers.get(e.serverAlias);t&&t._firewall._onIncoming(e)}function Fp(e){let t;t=e.paired?this._connections.get(e.alias):this._connecting.get(e.remoteAlias),t&&t._onDestroy(e)}function Hp(e){const t=this._opening.get(e.remoteAlias);t&&t._onListening(e)}function Rp(e){const t=this._servers.get(e.alias);t&&t._onClosed(e)}function Gp(e){const t=this._connecting.get(e.remoteAlias);t&&t._onOpen(e)}function Vp(e){const t=this._connections.get(e.alias);t&&t.push(null)}function qp(e){const t=this._connections.get(e.alias);if(t){null!==t._timeout&&t._timeout.refresh();for(const n of e.data)(null===t._keepAlive||n.length>0)&&t.push(n)}}function Jp(e){const t=this._queries.get(e.id);t&&t._onResult(e)}function jp(e){const t=this._queries.get(e.id);t&&t._onFinished(e)}function Wp(e){const t=this._signees.get(e.signee);t&&t._onSignAnnounce(e)}function zp(e){const t=this._signees.get(e.signee);t&&t._onSignUnannounce(e)}function Xp(e){if(e.isInitiator){const t=this._connecting.get(e.remoteStreamAlias);if(t){const n=new vp(this,this._protocol,null,e.id,!0,t._keyPair,t.remotePublicKey);this._handshakes.set(e.id,n),n._onNoiseSend(e)}}else{const t=this._handshakes.get(e.id);t&&t._onNoiseSend(e)}}function Zp(e){if(e.isInitiator){const t=this._handshakes.get(e.id);t&&t._onNoiseReceive(e)}else{const t=this._servers.get(e.serverAlias);if(t){const n=new vp(this,this._protocol,t._firewall,e.id,e.isInitiator,t._keyPair,null);this._handshakes.set(e.id,n),n._onNoiseReceive(e)}}}const{noisePayload:$p}=Hf,{encode:ey,decode:ty}=La;var ny={HandshakeProxy:class{constructor(e,t,n,r,i,s,o,a){this._node=e,this._protocol=t,this._id=n,this._remoteStreamAlias=r,this._serverAlias=i,this._isInitiator=s,this._keyPair=o,this._remotePublicKey=a,this._remoteId=null,this._holepunchSecret=null,this._onNoiseReply=null}send(e){return this._protocol.noiseSend.send({isInitiator:this._isInitiator,id:this._id,remoteStreamAlias:this._remoteStreamAlias,payload:ey($p,e)}),new Promise(((e,t)=>{this._onNoiseReply=ry.bind(this,e,t)}))}recv(e){return this._protocol.noiseReceive.send({isInitiator:this._isInitiator,id:this._id,serverAlias:this._serverAlias,payload:e}),new Promise(((e,t)=>{this._onNoiseReply=iy.bind(this,e,t)}))}final(){return{id:this._id,isInitiator:this._isInitiator,publicKey:this._keyPair.publicKey,remoteId:this._remoteId,remotePublicKey:this._remotePublicKey,holepunchSecret:this._holepunchSecret}}}};function ry(e,t,n){this._onNoiseReply=null,n.remotePublicKey&&(this._remotePublicKey=n.remotePublicKey),n.complete&&(this._remoteId=n.remoteId,this._holepunchSecret=n.holepunchSecret),e(n.payload)}function iy(e,t,n){this._onNoiseReply=null,n.remotePublicKey&&(this._remotePublicKey=n.remotePublicKey),n.complete&&(this._remoteId=n.remoteId,this._holepunchSecret=n.holepunchSecret),0===n.payload.length?(this._node._handshakes.delete(this._id),t(new Error("Handshake denied"))):e({id:n.id,...ty($p,n.payload)})}const{noisePayload:sy}=Hf,{encode:oy}=La,{nextId:ay}=Kg;var hy={FirewallProxy:class{constructor(e,t,n){this._node=e,this._protocol=t,this._serverAlias=n,this._deny=cy.bind(this),this._requests=new Map,this._onDeny=ly.bind(this),this._onAccept=dy.bind(this)}}};function cy(e,t){const n=ay();return this._protocol.incoming.send({id:n,serverAlias:this._serverAlias,remotePublicKey:e,payload:oy(sy,t)}),new Promise((e=>{this._requests.set(n,uy.bind(this,e,n))}))}function uy(e,t,n){this._requests.delete(t),e(n)}function ly(e){const t=this._requests.get(e.id);t&&t(!0)}function dy(e){const t=this._requests.get(e.id);t&&t(!1)}const{nextId:fy}=Kg;var Ay={SigneeProxy:class{constructor(e,t,n,r){this._node=e,this._protocol=t,this._target=n,this._signee=r,this._signAnnounce=gy.bind(this),this._signUnannounce=py.bind(this)}}};function gy(e,t,n,{peer:r}){const i=fy();return this._protocol.signAnnounce.send({id:i,signee:this._signee,token:t,peerId:n,relayAddresses:r}),new Promise((e=>{this._node._signatures.set(i,{resolve:e})}))}function py(e,t,n,{peer:r}){const i=fy();return this._protocol.signUnannounce.send({id:i,signee:this._signee,token:t,peerId:n,relayAddresses:r}),new Promise((e=>{this._node._signatures.set(i,{resolve:e})}))}const{Duplex:yy}=Ll;var _y={StreamProxy:class extends yy{constructor(e,t,n,r,i,s={}){super(),this._protocol=e,this._alias=t,this._remoteAlias=n,this._opening=null,this._draining=null,this._ended=2,this.noiseStream=this,this.isInitiator=r,this.publicKey=s.publicKey,this.remotePublicKey=s.remotePublicKey,this.handshakeId=null,this.rawStream=null,!1!==s.autoStart&&this.start(i,s),this.resume().pause()}start(e,t){this.rawStream=e,t.handshake&&(this.publicKey=t.handshake.publicKey,this.remotePublicKey=t.handshake.remotePublicKey,this.handshakeId=t.handshake.id);const n=e=>{this.destroy(e)},r=()=>{this._ended--,this.push(null)},i=e=>{this.push(e)},s=()=>{this._continueWrite()};this.rawStream.once("error",n).once("close",(()=>{this.rawStream.off("error",n).off("end",r).off("data",i).off("drain",s),0!==this._ended&&this.destroy()})).once("end",r).on("data",i).on("drain",s),t.data&&this.push(t.data),t.ended&&this.push(null),this._continueOpen()}_open(e){this.rawStream?e(null):this._opening=e}_continueOpen(e){const t=this._opening;t?(this._opening=null,e?t(e):this._open(t)):e&&this.destroy(e)}_read(e){this.rawStream.resume(),e(null)}_write(e,t){this.rawStream.write(e,t)?t(null):this._draining=t}_continueWrite(e){const t=this._draining;t&&(this._draining=null,t(e))}_final(e){this._ended--,this.rawStream.end(),e(null)}_predestroy(){const e=new Error("Stream was destroyed");this._continueOpen(e),this._continueWrite(e),this.rawStream&&this.rawStream.destroy(this._readableState.error||this._writableState.error)}}};const{FirewallProxy:by}=hy,{HandshakeProxy:Iy}=ny,{SigneeProxy:Ey}=Ay,{StreamProxy:my}=_y,wy=dp,{nextId:Cy}=Kg;var Sy={ServerProxy:class{constructor(e,t,n,r,i){this._node=e,this._protocol=t,this._alias=n,this._remoteAlias=r,this._keyPair=i,this._custodial=null!==i.secretKey,this._firewall=new by(e,t,n),this._signee=new Ey(e,t,wy.hash(i.publicKey),r),this._server=e._dht.createServer({firewall:this._custodial?this._firewall._deny:null,createHandshake:this._custodial?null:ky.bind(this),createSecretStream:this._custodial?null:Dy.bind(this)}),this._onStreamClose=By.bind(this),this._protocol._stream.once("close",this._onStreamClose),this._onServerClose=Qy.bind(this),this._onServerListening=vy.bind(this),this._onServerConnection=xy.bind(this),this._server.once("close",this._onServerClose).once("listening",this._onServerListening).on("connection",this._onServerConnection).listen({publicKey:i.publicKey,secretKey:i.secretKey},{signAnnounce:this._custodial?null:this._signee._signAnnounce,signUnannounce:this._custodial?null:this._signee._signUnannounce}),this._onClose=Ly.bind(this)}}};function By(){this._server.close()}function Qy(){this._protocol.closed.send({alias:this._alias}),this._server.off("listening",this._onServerListening).off("connection",this._onServerConnection),this._node._servers.delete(this._remoteAlias)}function vy(){const e=this._server.address();this._protocol.listening.send({alias:this._alias,remoteAlias:this._remoteAlias,host:e.host,port:e.port})}function xy(e){const t=Cy();this._node._connecting.set(t,e);const n=e=>{this._protocol.destroy.send({alias:t,error:e.message})},r=()=>{this._protocol.end.send({alias:t})},i=e=>{this._protocol.data.send({alias:t,data:[e]})};e.once("error",n).once("close",(()=>{e.off("error",n).off("end",r).off("data",i),this._node._connecting.delete(t,e)})).once("end",r).on("data",i),this._protocol.connection.send({custodial:this._custodial,alias:t,serverAlias:this._alias,remotePublicKey:e.remotePublicKey,handshakeHash:e.handshakeHash,handshakeId:e.handshakeId})}function Ly(){this._server.close()}function ky(e,t){const n=!!t,r=Cy(),i=new Iy(this._node,this._protocol,r,null,this._alias,n,e,t);return this._node._handshakes.set(r,i),i}function Dy(e,t,n){return new my(this._protocol,null,null,e,t,n)}const{encode:Uy}=La,{HandshakeProxy:Ky}=ny,{ServerProxy:My}=Sy,{SigneeProxy:Ty}=Ay,{StreamProxy:Yy}=_y,{announcers:Ny}=kA,{nextId:Py}=Kg;var Oy={NodeProxy:class{constructor(e,t,n){this._dht=e,this._protocol=t,this._defaultKeyPair=n,this._servers=new Map,this._queries=new Map,this._connecting=new Map,this._connections=new Map,this._handshakes=new Map,this._signatures=new Map,this._onStreamClose=Fy.bind(this),this._protocol._stream.once("close",this._onStreamClose),this._onConnect=Hy.bind(this),this._onConnected=Ry.bind(this),this._onDeny=Gy.bind(this),this._onAccept=Vy.bind(this),this._onListen=qy.bind(this),this._onDestroy=Jy.bind(this),this._onEnd=jy.bind(this),this._onData=Wy.bind(this),this._onQuery=zy.bind(this),this._onLookup=Xy.bind(this),this._onAnnounce=Zy.bind(this),this._onUnannounce=$y.bind(this),this._onClose=e_.bind(this),this._onSignature=t_.bind(this),this._onNoiseReply=n_.bind(this),this._protocol.on("connect",this._onConnect).on("connected",this._onConnected).on("deny",this._onDeny).on("accept",this._onAccept).on("listen",this._onListen).on("destroy",this._onDestroy).on("end",this._onEnd).on("data",this._onData).on("lookup",this._onLookup).on("announce",this._onAnnounce).on("unannounce",this._onUnannounce).on("close",this._onClose).on("signature",this._onSignature).on("noiseReply",this._onNoiseReply)}}};function Fy(){this._protocol.off("connect",this._onConnect).off("connected",this._onConnected).off("deny",this._onDeny).off("accept",this._onAccept).off("listen",this._onListen).off("destroy",this._onDestroy).off("end",this._onEnd).off("data",this._onData).off("lookup",this._onLookup).off("announce",this._onAnnounce).off("unannounce",this._onUnannounce).off("close",this._onClose).off("signature",this._onSignature).off("noiseReply",this._onNoiseReply);for(const e of this._connections.values())e.destroy()}function Hy(e){const t=e.alias,n=Py(),r=null!==e.secretKey,i=this._dht.connect(e.remotePublicKey,{keyPair:{publicKey:e.publicKey,secretKey:e.secretKey},createHandshake:r?null:r_.bind(this,t),createSecretStream:r?null:i_.bind(this,n,t)});this._connections.set(t,i);let s=!1;const o=e=>{this._protocol.destroy.send({paired:s,alias:n,remoteAlias:t,error:e.message})},a=()=>{s=!0,this._protocol.open.send({custodial:r,alias:n,remoteAlias:t,handshakeHash:i.handshakeHash,handshakeId:i.handshakeId})},h=()=>{this._protocol.end.send({alias:n})},c=e=>{this._protocol.data.send({alias:n,data:[e]})};i.once("error",o).once("close",(()=>{i.off("error",o).off("open",a).off("end",h).off("data",c),this._connections.delete(t)})).once("open",a).once("end",h).on("data",c)}function Ry(e){const t=this._connecting.get(e.remoteAlias);if(t){this._connecting.delete(e.remoteAlias),this._connections.set(e.alias,t);const n=()=>{this._connections.delete(e.alias)};t.once("close",n)}}function Gy(e){for(const t of this._servers.values())if(t._firewall._requests.get(e.id))return t._firewall._onDeny(e)}function Vy(e){for(const t of this._servers.values())if(t._firewall._requests.get(e.id))return t._firewall._onAccept(e)}function qy(e){const t=e.alias,n=Py(),r=new My(this,this._protocol,n,t,e);this._servers.set(t,r)}function Jy(e){const t=this._connections.get(e.alias);t&&t.destroy(e.error&&new Error(e.error))}function jy(e){const t=this._connections.get(e.alias);t&&t.end()}function Wy(e){const t=this._connections.get(e.alias);if(t)for(const n of e.data)t.write(n)}function zy(e,t,n){this._queries.set(e.id,t);const r=()=>{},i=t=>{this._protocol.result.send({id:e.id,data:Uy(n,t)})};t.once("error",r).once("close",(()=>{t.off("error",r).off("data",i),this._queries.delete(e.id),this._protocol.finished.send(e)})).on("data",i)}function Xy(e){this._onQuery(e,this._dht.lookup(e.topic),Ny)}function Zy(e){const t=null!==e.secretKey,n=new Ty(this,this._protocol,e.topic,e.id);this._onQuery(e,this._dht.announce(e.topic,{publicKey:e.publicKey,secretKey:e.secretKey},[],{signAnnounce:t?null:n._signAnnounce,signUnannounce:t?null:n._signUnannounce}),Ny)}function $y(e){const t=null!==e.secretKey,n=new Ty(this,this._protocol,e.topic,e.id);this._onQuery(e,this._dht.lookupAndUnannounce(e.topic,{publicKey:e.publicKey,secretKey:e.secretKey},{signAnnounce:t?null:n._signAnnounce,signUnannounce:t?null:n._signUnannounce}),Ny)}function e_(e){const t=this._servers.get(e.alias);t&&t._onClose(e)}function t_(e){const t=this._signatures.get(e.id);t&&t.resolve(e.signature)}function n_(e){const t=this._handshakes.get(e.id);t&&t._onNoiseReply(e)}function r_(e,t,n){const r=!!n,i=Py(),s=new Ky(this,this._protocol,i,e,null,r,t,n);return this._handshakes.set(i,s),s}function i_(e,t,n,r,i){return new Yy(this._protocol,e,t,n,r,i)}const{Protocol:s_}=yg,{Node:o_}=Yp,{NodeProxy:a_}=Oy;nA.exports=o_,nA.exports.relay=function(e,t){const n=new s_(t);return new Promise((t=>{n.once("handshake",(r=>{const i=new a_(e,n,{publicKey:r.publicKey,secretKey:r.secretKey});t(i)})).heartbeat()}))};var h_=nA.exports;const{Duplex:c_}=Ll,u_=I;function l_(e){this.destroy(e)}function d_(){this._socket.removeEventListener("error",this._onError),this._socket.removeEventListener("close",this._onClose),this._socket.removeEventListener("open",this._onOpen),this._socket.removeEventListener("message",this._onMessage),this.destroy()}function f_(){this._continueOpen()}function A_(e){this.push(u_.from(e.data))}var g_=class extends c_{constructor(e,t){super(),this._socket=t,this._socket.binaryType="arraybuffer",this._opening=null,this._onError=l_.bind(this),this._onClose=d_.bind(this),this._onOpen=f_.bind(this),this._onMessage=A_.bind(this),this._socket.addEventListener("error",this._onError),this._socket.addEventListener("close",this._onClose),this._socket.addEventListener("open",this._onOpen),this._socket.addEventListener("message",this._onMessage)}_open(e){this._socket.readyState>1?e(new Error("Socket is closed")):this._socket.readyState<1?this._opening=e:e(null)}_continueOpen(e){e&&this.destroy(e);const t=this._opening;t&&(this._opening=null,this._open(t))}_write(e,t){this._socket.send(e),t(null)}_predestroy(){this._continueOpen(new Error("Socket was destroyed"))}_destroy(e){this._socket.close(),e(null)}},p_={};const y_=oo,__=La,b_=I,I_=b_.from([0]),E_=b_.from([1]),m_=b_.from([2]),w_=b_.from("hypercore");p_.keyPair=function(e){const t=b_.allocUnsafeSlow(y_.crypto_sign_PUBLICKEYBYTES+y_.crypto_sign_SECRETKEYBYTES),n=t.subarray(0,y_.crypto_sign_PUBLICKEYBYTES),r=t.subarray(y_.crypto_sign_PUBLICKEYBYTES);return e?y_.crypto_sign_seed_keypair(n,r,e):y_.crypto_sign_keypair(n,r),{publicKey:n,secretKey:r}},p_.validateKeyPair=function(e){const t=b_.allocUnsafe(y_.crypto_sign_PUBLICKEYBYTES);return y_.crypto_sign_ed25519_sk_to_pk(t,e.secretKey),b_.equals(t,e.publicKey)},p_.sign=function(e,t){const n=b_.allocUnsafeSlow(y_.crypto_sign_BYTES);return y_.crypto_sign_detached(n,e,t),n},p_.verify=function(e,t,n){return y_.crypto_sign_verify_detached(t,e,n)},p_.data=function(e){const t=b_.allocUnsafe(32);return y_.crypto_generichash_batch(t,[I_,__.encode(__.uint64,e.byteLength),e]),t},p_.parent=function(e,t){if(e.index>t.index){const n=e;e=t,t=n}const n=b_.allocUnsafe(32);return y_.crypto_generichash_batch(n,[E_,__.encode(__.uint64,e.size+t.size),e.hash,t.hash]),n},p_.tree=function(e,t){const n=new Array(3*e.length+1);let r=0;n[r++]=m_;for(let t=0;t<e.length;t++){const i=e[t];n[r++]=i.hash,n[r++]=__.encode(__.uint64,i.index),n[r++]=__.encode(__.uint64,i.size)}return t||(t=b_.allocUnsafe(32)),y_.crypto_generichash_batch(t,n),t},p_.hash=function(e,t){return t||(t=b_.allocUnsafe(32)),Array.isArray(e)||(e=[e]),y_.crypto_generichash_batch(t,e),t},p_.randomBytes=function(e){const t=b_.allocUnsafe(e);return y_.randombytes_buf(t),t},p_.discoveryKey=function(e){const t=b_.allocUnsafeSlow(32);return y_.crypto_generichash(t,w_,e),t},y_.sodium_free?p_.free=function(e){e.secure&&y_.sodium_free(e)}:p_.free=function(){},p_.namespace=function(e,t){const n="number"==typeof t?function(e){const t=new Array(e);for(let n=0;n<e;n++)t[n]=n;return t}(t):t,r=b_.allocUnsafeSlow(32*n.length),i=new Array(n.length),s=b_.allocUnsafe(33);y_.crypto_generichash(s.subarray(0,32),"string"==typeof e?b_.from(e):e);for(let e=0;e<i.length;e++)i[e]=r.subarray(32*e,32*e+32),s[32]=n[e],y_.crypto_generichash(i[e],s);return i};var C_={exports:{}};function S_(e){return e.length}var B_={byteLength:S_,toString:function(e){const t=e.byteLength;let n="";for(let r=0;r<t;r++)n+=String.fromCharCode(e[r]);return n},write:function(e,t,n=0,r=S_(t)){const i=Math.min(r,e.byteLength-n);for(let r=0;r<i;r++)e[n+r]=t.charCodeAt(r);return i}};const Q_="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",v_=new Uint8Array(256);for(let e=0;e<64;e++)v_[Q_.charCodeAt(e)]=e;function x_(e){let t=e.length;return 61===e.charCodeAt(t-1)&&t--,t>1&&61===e.charCodeAt(t-1)&&t--,3*t>>>2}v_[45]=62,v_[95]=63;var L_={byteLength:x_,toString:function(e){const t=e.byteLength;let n="";for(let r=0;r<t;r+=3)n+=Q_[e[r]>>2]+Q_[(3&e[r])<<4|e[r+1]>>4]+Q_[(15&e[r+1])<<2|e[r+2]>>6]+Q_[63&e[r+2]];return t%3==2?n=n.substring(0,n.length-1)+"=":t%3==1&&(n=n.substring(0,n.length-2)+"=="),n},write:function(e,t,n=0,r=x_(t)){const i=Math.min(r,e.byteLength-n);for(let n=0,r=0;r<i;n+=4){const i=v_[t.charCodeAt(n)],s=v_[t.charCodeAt(n+1)],o=v_[t.charCodeAt(n+2)],a=v_[t.charCodeAt(n+3)];e[r++]=i<<2|s>>4,e[r++]=(15&s)<<4|o>>2,e[r++]=(3&o)<<6|63&a}return i}};function k_(e){return e.length>>>1}var D_={byteLength:k_,toString:function(e){const t=e.byteLength;e=new DataView(e.buffer,e.byteOffset,t);let n="",r=0;for(let i=t-t%4;r<i;r+=4)n+=e.getUint32(r).toString(16).padStart(8,"0");for(;r<t;r++)n+=e.getUint8(r).toString(16).padStart(2,"0");return n},write:function(e,t,n=0,r=k_(t)){const i=Math.min(r,e.byteLength-n);for(let r=0;r<i;r++){const i=U_(t.charCodeAt(2*r)),s=U_(t.charCodeAt(2*r+1));if(void 0===i||void 0===s)return e.subarray(0,r);e[n+r]=i<<4|s}return i}};function U_(e){return e>=48&&e<=57?e-48:e>=65&&e<=70?e-65+10:e>=97&&e<=102?e-97+10:void 0}function K_(e){let t=0;for(let n=0,r=e.length;n<r;n++){const i=e.charCodeAt(n);if(i>=55296&&i<=56319&&n+1<r){const r=e.charCodeAt(n+1);if(r>=56320&&r<=57343){t+=4,n++;continue}}t+=i<=127?1:i<=2047?2:3}return t}let M_,T_;if("undefined"!=typeof TextDecoder){const e=new TextDecoder;M_=function(t){return e.decode(t)}}else M_=function(e){const t=e.byteLength;let n="",r=0;for(;r<t;){let i=e[r];if(i<=127){n+=String.fromCharCode(i),r++;continue}let s=0,o=0;if(i<=223?(s=1,o=31&i):i<=239?(s=2,o=15&i):i<=244&&(s=3,o=7&i),t-r-s>0){let t=0;for(;t<s;)i=e[r+t+1],o=o<<6|63&i,t+=1}else o=65533,s=t-r;n+=String.fromCodePoint(o),r+=s+1}return n};if("undefined"!=typeof TextEncoder){const e=new TextEncoder;T_=function(t,n,r=0,i=K_(n)){const s=Math.min(i,t.byteLength-r);return e.encodeInto(n,t.subarray(r,r+s)),s}}else T_=function(e,t,n=0,r=K_(t)){const i=Math.min(r,e.byteLength-n);e=e.subarray(n,n+i);let s=0,o=0;for(;s<t.length;){const n=t.codePointAt(s);if(n<=127){e[o++]=n,s++;continue}let r=0,i=0;for(n<=2047?(r=6,i=192):n<=65535?(r=12,i=224):n<=2097151&&(r=18,i=240),e[o++]=i|n>>r,r-=6;r>=0;)e[o++]=128|n>>r&63,r-=6;s+=n>=65536?2:1}return i};var Y_={byteLength:K_,toString:M_,write:T_};function N_(e){return 2*e.length}var P_={byteLength:N_,toString:function(e){const t=e.byteLength;let n="";for(let r=0;r<t-1;r+=2)n+=String.fromCharCode(e[r]+256*e[r+1]);return n},write:function(e,t,n=0,r=N_(t)){const i=Math.min(r,e.byteLength-n);let s=i;for(let r=0;r<t.length&&!((s-=2)<0);++r){const i=t.charCodeAt(r),s=i>>8,o=i%256;e[n+2*r]=o,e[n+2*r+1]=s}return i}};!function(e,t){const n=B_,r=L_,i=D_,s=Y_,o=P_,a=255===new Uint8Array(Uint16Array.of(255).buffer)[0];function h(e){switch(e){case"ascii":return n;case"base64":return r;case"hex":return i;case"utf8":case"utf-8":case void 0:case null:return s;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return o;default:throw new Error(`Unknown encoding: ${e}`)}}function c(e){return e instanceof Uint8Array}function u(e,t,n){return"string"==typeof e?function(e,t){const n=h(t),r=new Uint8Array(n.byteLength(e));return n.write(r,e,0,r.byteLength),r}(e,t):Array.isArray(e)?function(e){const t=new Uint8Array(e.length);return t.set(e),t}(e):ArrayBuffer.isView(e)?function(e){const t=new Uint8Array(e.byteLength);return t.set(e),t}(e):function(e,t,n){return new Uint8Array(e,t,n)}(e,t,n)}function l(e,t,n,r,i){if(0===e.byteLength)return-1;if("string"==typeof n?(r=n,n=0):void 0===n?n=i?0:e.length-1:n<0&&(n+=e.byteLength),n>=e.byteLength){if(i)return-1;n=e.byteLength-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t)t=u(t,r);else if("number"==typeof t)return t&=255,i?e.indexOf(t,n):e.lastIndexOf(t,n);if(0===t.byteLength)return-1;if(i){let r=-1;for(let i=n;i<e.byteLength;i++)if(e[i]===t[-1===r?0:i-r]){if(-1===r&&(r=i),i-r+1===t.byteLength)return r}else-1!==r&&(i-=i-r),r=-1}else{n+t.byteLength>e.byteLength&&(n=e.byteLength-t.byteLength);for(let r=n;r>=0;r--){let n=!0;for(let i=0;i<t.byteLength;i++)if(e[r+i]!==t[i]){n=!1;break}if(n)return r}}return-1}function d(e,t,n,r){return l(e,t,n,r,!0)}function f(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}e.exports=t={isBuffer:c,isEncoding:function(e){try{return h(e),!0}catch{return!1}},alloc:function(e,n,r){const i=new Uint8Array(e);return void 0!==n&&t.fill(i,n,0,i.byteLength,r),i},allocUnsafe:function(e){return new Uint8Array(e)},allocUnsafeSlow:function(e){return new Uint8Array(e)},byteLength:function(e,t){return h(t).byteLength(e)},compare:function(e,t){if(e===t)return 0;const n=Math.min(e.byteLength,t.byteLength);e=new DataView(e.buffer,e.byteOffset,e.byteLength),t=new DataView(t.buffer,t.byteOffset,t.byteLength);let r=0;for(let i=n-n%4;r<i&&e.getUint32(r,a)===t.getUint32(r,a);r+=4);for(;r<n;r++){const n=e.getUint8(r),i=t.getUint8(r);if(n<i)return-1;if(n>i)return 1}return e.byteLength>t.byteLength?1:e.byteLength<t.byteLength?-1:0},concat:function(e,t){void 0===t&&(t=e.reduce(((e,t)=>e+t.byteLength),0));const n=new Uint8Array(t);let r=0;for(const t of e){if(r+t.byteLength>n.byteLength){const e=t.subarray(0,n.byteLength-r);return n.set(e,r),n}n.set(t,r),r+=t.byteLength}return n},copy:function(e,t,n=0,r=0,i=e.byteLength){if(i>0&&i<r)return 0;if(i===r)return 0;if(0===e.byteLength||0===t.byteLength)return 0;if(n<0)throw new RangeError("targetStart is out of range");if(r<0||r>=e.byteLength)throw new RangeError("sourceStart is out of range");if(i<0)throw new RangeError("sourceEnd is out of range");n>=t.byteLength&&(n=t.byteLength),i>e.byteLength&&(i=e.byteLength),t.byteLength-n<i-r&&(i=t.length-n+r);const s=i-r;return e===t?t.copyWithin(n,r,i):t.set(e.subarray(r,i),n),s},equals:function(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;const n=e.byteLength;e=new DataView(e.buffer,e.byteOffset,e.byteLength),t=new DataView(t.buffer,t.byteOffset,t.byteLength);let r=0;for(let i=n-n%4;r<i;r+=4)if(e.getUint32(r,a)!==t.getUint32(r,a))return!1;for(;r<n;r++)if(e.getUint8(r)!==t.getUint8(r))return!1;return!0},fill:function(e,t,n,r,i){if("string"==typeof t?"string"==typeof n?(i=n,n=0,r=e.byteLength):"string"==typeof r&&(i=r,r=e.byteLength):"number"==typeof t?t&=255:"boolean"==typeof t&&(t=+t),n<0||e.byteLength<n||e.byteLength<r)throw new RangeError("Out of range index");if(void 0===n&&(n=0),void 0===r&&(r=e.byteLength),r<=n)return e;if(t||(t=0),"number"==typeof t)for(let i=n;i<r;++i)e[i]=t;else{const s=(t=c(t)?t:u(t,i)).byteLength;for(let i=0;i<r-n;++i)e[i+n]=t[i%s]}return e},from:u,includes:function(e,t,n,r){return-1!==d(e,t,n,r)},indexOf:d,lastIndexOf:function(e,t,n,r){return l(e,t,n,r,!1)},swap16:function(e){const t=e.byteLength;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let n=0;n<t;n+=2)f(e,n,n+1);return e},swap32:function(e){const t=e.byteLength;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let n=0;n<t;n+=4)f(e,n,n+3),f(e,n+1,n+2);return e},swap64:function(e){const t=e.byteLength;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let n=0;n<t;n+=8)f(e,n,n+7),f(e,n+1,n+6),f(e,n+2,n+5),f(e,n+3,n+4);return e},toBuffer:function(e){return e},toString:function(e,t,n=0,r=e.byteLength){const i=e.byteLength;return n>=i||r<=n?"":(n<0&&(n=0),r>i&&(r=i),(0!==n||r<i)&&(e=e.subarray(n,r)),h(t).toString(e))},write:function(e,t,n,r,i){return void 0===n?i="utf8":void 0===r&&"string"==typeof n?(i=n,n=void 0):void 0===i&&"string"==typeof r&&(i=r,r=void 0),h(i).write(e,t,n,r)},writeDoubleLE:function(e,t,n){return void 0===n&&(n=0),new DataView(e.buffer,e.byteOffset,e.byteLength).setFloat64(n,t,!0),n+8},writeFloatLE:function(e,t,n){return void 0===n&&(n=0),new DataView(e.buffer,e.byteOffset,e.byteLength).setFloat32(n,t,!0),n+4},writeUInt32LE:function(e,t,n){return void 0===n&&(n=0),new DataView(e.buffer,e.byteOffset,e.byteLength).setUint32(n,t,!0),n+4},writeInt32LE:function(e,t,n){return void 0===n&&(n=0),new DataView(e.buffer,e.byteOffset,e.byteLength).setInt32(n,t,!0),n+4},readDoubleLE:function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat64(t,!0)},readFloatLE:function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat32(t,!0)},readUInt32LE:function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getUint32(t,!0)},readInt32LE:function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getInt32(t,!0)},writeDoubleBE:function(e,t,n){return void 0===n&&(n=0),new DataView(e.buffer,e.byteOffset,e.byteLength).setFloat64(n,t,!1),n+8},writeFloatBE:function(e,t,n){return void 0===n&&(n=0),new DataView(e.buffer,e.byteOffset,e.byteLength).setFloat32(n,t,!1),n+4},writeUInt32BE:function(e,t,n){return void 0===n&&(n=0),new DataView(e.buffer,e.byteOffset,e.byteLength).setUint32(n,t,!1),n+4},writeInt32BE:function(e,t,n){return void 0===n&&(n=0),new DataView(e.buffer,e.byteOffset,e.byteLength).setInt32(n,t,!1),n+4},readDoubleBE:function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat64(t,!1)},readFloatBE:function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat32(t,!1)},readUInt32BE:function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getUint32(t,!1)},readInt32BE:function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getInt32(t,!1)}}}(C_,C_.exports);var O_=C_.exports;let F_;function H_(e,t){"string"==typeof e&&p_.hash(O_.from("hyperswarm-webrtc"+e)),F_=e?.secretKey?e:h_.keyPair(e);const n=t();return F_=null,n}function R_(e,t={}){const{hyperswarmConfig:n={},dhtConfig:r={}}=t;F_&&(n.keyPair=F_);const i=new WebSocket(e),s=new h_(new g_(!0,i),r);return"undefined"==typeof RTCPeerConnection?(console.warn("Not connected via webrtc"),new Ba({...n,dht:s})):new G_({...n,dht:s})}class G_ extends Ba{on(e,t){return"connection"!==e?super.on(e,t):super.on("connection",((e,n)=>{const r=Lc.from(e);return t(r,n)}))}}function V_(e){return p_.hash(O_.from(e))}export{p_ as Krypto,O_ as b4a,R_ as connect,V_ as createTopic,H_ as useKeyPair};
